(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    703672,      17730]
NotebookOptionsPosition[    675049,      17273]
NotebookOutlinePosition[    675424,      17289]
CellTagsIndexPosition[    675381,      17286]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"1", "+", "1"}]], "Input",
 CellChangeTimes->{{3.6362729698362236`*^9, 3.636272970066228*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"db3d923a-a50b-4ca2-ac5d-4031c2b69046"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.636272970298233*^9, 3.637669804933504*^9, 
  3.6536474209311266`*^9, 3.653971832424405*^9, 3.733121385262988*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"08e1268d-ba25-4158-b6a2-88e7f6cdb9bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Chapter",
 CellChangeTimes->{{3.732882674275463*^9, 
  3.7328826759316287`*^9}},ExpressionUUID->"3d07e8c0-4533-4f2a-b3f8-\
d00ad46d4f0d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\AD\\\\AD\\\\\
Kernel\\\\AD.m\>\""}]], "Input",
 CellChangeTimes->{{3.732882677905826*^9, 3.7328826906471*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"feed91c2-bb35-47cf-9557-9ac97291f62a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bigPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "0"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1"}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"0", ",", " ", "0"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7377010714019294`*^9, 3.737701090222125*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"e030f6d6-3bb7-4986-a637-49c68b66dac8"],

Cell[BoxData[
 RowBox[{"bigPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.737701090523128*^9},
 CellLabel->"Out[4]=",ExpressionUUID->"f0686794-df4a-4d47-a7a4-fd7898b0b6ab"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalGamma] matrix and related", "Chapter",
 CellChangeTimes->{{3.6362850719466534`*^9, 
  3.636285082867876*^9}},ExpressionUUID->"dc5cddf8-0489-4ffb-a343-\
e58ffc557c7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "a", ",", " ", "b"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "c", ",", "1"}], "}"}]}], "}"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.6362850958021407`*^9, 
  3.636285106286354*^9}},ExpressionUUID->"035b278f-cac0-4f64-9adb-\
5f077b41632c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.636285107763384*^9, 
  3.636285110263435*^9}},ExpressionUUID->"a86535ee-167b-4928-92c5-\
f793adbbbda3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "a", "b"},
     {"a", "1", "c"},
     {"b", "c", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6362851105834413`*^9, 
  3.6362859084452877`*^9},ExpressionUUID->"af2805fe-f00e-4986-aa0d-\
f8ef5698d98e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"g", ",", " ", 
     RowBox[{"Cubics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"es", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Normalize", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"es", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"es", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"es", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"es", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.636285115385539*^9, 3.6362851213246603`*^9}, {
  3.6362854650609465`*^9, 3.636285468575632*^9}, {3.6362858483072877`*^9, 
  3.6362858717162876`*^9}, {3.6362859117472878`*^9, 
  3.6362859238502874`*^9}},ExpressionUUID->"b3a9e571-fb93-4361-a83d-\
86dc50badeb7"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Simplify", "::", "time"}], "MessageName"], ":", 
  " ", "\<\"Time spent on a transformation exceeded \[NoBreak]\\!\\(300.`\\)\
\[NoBreak] seconds, and the transformation was aborted. Increasing the value \
of TimeConstraint option may improve the result of simplification. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Simplify/time\\\", \
ButtonNote -> \\\"Simplify::time\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6362862246071835`*^9},ExpressionUUID->"ba8c336f-05cd-4841-a318-\
eb66e3b945a9"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.6362854714703727`*^9, {3.6362859055432873`*^9, 3.6362859179332876`*^9}, 
   3.6362863540995445`*^9},ExpressionUUID->"0b2c98cc-21b6-4494-9955-\
41d0eefeae93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"es", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"es", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"es", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6362851261277604`*^9, 
  3.6362852081014423`*^9}},ExpressionUUID->"bb001e94-8c85-486e-a94c-\
21616658f875"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.636285155560364*^9, 3.636285195838185*^9}, 
   3.6362852351899943`*^9},ExpressionUUID->"12097ef3-bf6a-4bdf-8b33-\
6e830097a85f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "4"}], ",", " ", 
     RowBox[{"b", "=", "3"}], ",", " ", 
     RowBox[{"c", "=", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"es", "=", " ", 
     RowBox[{"Eigensystem", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "a", ",", " ", "b"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "1", ",", " ", "c"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", " ", "c", ",", "1"}], "}"}]}], "}"}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"es", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"es", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Normalize", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        RowBox[{"es", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"es", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"es", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"es", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", "Simplify"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.636285239958083*^9, 3.63628534405577*^9}, {
  3.6362853967940598`*^9, 3.6362854076860833`*^9}, {3.636285449268362*^9, 
  3.6362854573696365`*^9}, {3.6362855525580006`*^9, 3.6362856550639615`*^9}, {
  3.636285719795676*^9, 3.636285744637182*^9}, {3.6362857794284906`*^9, 
  3.6362858357143707`*^9}},ExpressionUUID->"1a3a2e0d-3560-4f6b-8af8-\
3461d9672c19"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6362852763558273`*^9, 3.6362853153943353`*^9}, 
   3.636285408088047*^9, 3.6362854590174885`*^9, {3.6362855671787095`*^9, 
   3.6362856579999037`*^9}, 3.6362857458831573`*^9, {3.636285779810483*^9, 
   3.6362857932862144`*^9}, {3.6362858247785883`*^9, 
   3.6362858368183484`*^9}},ExpressionUUID->"bd28a4ac-6833-4f9a-b403-\
9f606c7181df"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Checks", "Chapter",
 CellChangeTimes->{{3.636285090218025*^9, 
  3.63628509134405*^9}},ExpressionUUID->"e1f4bb0d-9fd1-4add-9558-\
20da117ce88b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2015", ",", " ", "4", ",", " ", "13", ",", " ", "0", ",", " ", "0", ",", 
     " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2016", ",", "4", ",", " ", "13", ",", " ", "0", ",", " ", "0", ",", " ", 
     "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"settDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2016", ",", "4", ",", " ", "13", ",", " ", "0", ",", " ", "0", ",", " ", 
     "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrierStartDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2015", ",", " ", "6", ",", " ", "1", ",", " ", "0", ",", "0", ",", "0"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrierEndDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2015", ",", " ", "8", ",", " ", "31", ",", " ", "0", ",", "0", ",", 
     "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637898341986329*^9, 3.6378983543866725`*^9}, {
  3.6378983938957624`*^9, 3.6378984076921325`*^9}, {3.637898733616025*^9, 
  3.6378988442024045`*^9}},ExpressionUUID->"d0647dcf-d0dd-4214-a9d2-\
d884a60d2829"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"barrierOption", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"17.0", ",", "0.05", ",", "0.3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"50.0", ",", 
      RowBox[{"0.05", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}], ",", " ", 
      RowBox[{"0.03", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}]}], "}"}], ",", "0.25", ",", "0.1", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"DateDifference", "[", 
         RowBox[{
         "vDate", ",", " ", "barrierStartDate", ",", " ", "\"\<Day\>\""}], 
         "]"}], "]"}], "/", "365.25"}], ",", 
      RowBox[{
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"DateDifference", "[", 
         RowBox[{
         "vDate", ",", " ", "barrierEndDate", ",", " ", "\"\<Day\>\""}], 
         "]"}], "]"}], "/", "365.25"}], ",", 
      RowBox[{"10", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}], ",", "55"}], "}"}], ",", "40", ",", 
    RowBox[{
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"DateDifference", "[", 
       RowBox[{"vDate", ",", " ", "expDate", ",", " ", "\"\<Day\>\""}], "]"}],
       "]"}], "/", "365.25"}], ",", 
    RowBox[{
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"DateDifference", "[", 
       RowBox[{"vDate", ",", " ", "settDate", ",", " ", "\"\<Day\>\""}], 
       "]"}], "]"}], "/", "365.25"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], " ", "/.", " ", 
  RowBox[{"BarrierOption`Private`n", " ", "\[Rule]", " ", "0"}]}]], "Input",
 CellChangeTimes->{{3.637898341986329*^9, 3.6378983543866725`*^9}, {
  3.6378983938957624`*^9, 3.6378984076921325`*^9}, {3.637898733616025*^9, 
  3.6378988442024045`*^9}, {3.637898888235452*^9, 3.6378989691725087`*^9}, {
  3.6388576057357054`*^9, 3.6388576159073195`*^9}, {3.638857660345004*^9, 
  3.6388577201946125`*^9}},ExpressionUUID->"be74b322-555d-4be9-886d-\
8ce7c7e309aa"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "unfl"}], "MessageName"], ":", 
  " ", "\<\"Underflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/unfl\\\", ButtonNote -> \
\\\"General::unfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474306694965`*^9},ExpressionUUID->"e3add398-73fe-4186-8d66-\
1edee70cbc61"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "unfl"}], "MessageName"], ":", 
  " ", "\<\"Underflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/unfl\\\", ButtonNote -> \
\\\"General::unfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474307294984`*^9},ExpressionUUID->"66b5d534-9ffd-47d1-8060-\
f48c1758360a"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "unfl"}], "MessageName"], ":", 
  " ", "\<\"Underflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/unfl\\\", ButtonNote -> \
\\\"General::unfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474307995005`*^9},ExpressionUUID->"def54c7c-da30-46d4-b491-\
3610aacf6403"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(General :: \
unfl\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.653647430918505*^9},ExpressionUUID->"45d00e4a-3db4-4f3a-b196-\
6b87ea042bb4"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "ovfl"}], "MessageName"], ":", 
  " ", "\<\"Overflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/ovfl\\\", ButtonNote -> \
\\\"General::ovfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.65364743102551*^9},ExpressionUUID->"65a07df2-8d69-4580-aa3a-e1ea4a00f178"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "ovfl"}], "MessageName"], ":", 
  " ", "\<\"Overflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/ovfl\\\", ButtonNote -> \
\\\"General::ovfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474312555165`*^9},ExpressionUUID->"df29cba4-9d07-4485-b23a-\
2acdc34f0329"],

Cell[BoxData["0.008076972685936573`"], "Output",
 CellChangeTimes->{{3.638857593702981*^9, 3.6388576177184286`*^9}, {
   3.6388576642012367`*^9, 3.6388577213986855`*^9}, 
   3.653647431345519*^9},ExpressionUUID->"48313630-b35d-462e-9509-\
a2abef0f21f2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cp", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"50.", ",", " ", "0.", ",", " ", "0.35"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"50.", ",", " ", "0.", ",", " ", "0.23"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"corr", "=", 
   RowBox[{"-", "0.98"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intRate", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "365.242"}], ",", " ", "1.", ",", " ", "35.", ",", " ",
      "55."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strike", "=", "50."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "1."}], ";", 
  RowBox[{"ts", "=", "1."}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7328823289109297`*^9, 3.7328824747805157`*^9}, 
   3.7328826024952855`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"07d694bc-5d9f-4aad-bf2c-6ce7533d7c3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
   "intRate", ",", 
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
   "strike", ",", "t", ",", "ts", ",", 
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732882316901729*^9, 3.7328823169067297`*^9}, {
  3.7328824770007377`*^9, 3.7328825084848857`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"b46c9c00-8117-4a72-99c8-d2441b9ae728"],

Cell[BoxData["2.0587062988056033`"], "Output",
 CellChangeTimes->{3.7328825090229397`*^9, 3.732882609751011*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"ccdfa18b-f016-4c59-b35c-89cd3cc18e54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
   "intRate", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "/", "2"}], ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], 
   ",", "strike", ",", "t", ",", "ts", ",", 
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732882631450181*^9, 3.7328826503790736`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"527ceba6-8d7a-49cf-80ad-6cef78b24729"],

Cell[BoxData["2.7648606168718235`"], "Output",
 CellChangeTimes->{{3.7328826391869545`*^9, 3.732882655375573*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"4ad081b0-60b4-4e79-9fc3-03ebb1dc8541"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
   RowBox[{"fd", "[", 
    RowBox[{"intRate", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<intRate\>\"", "\[Rule]", " ", "1"}], "|>"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "/", "2"}], ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], 
   ",", "strike", ",", "t", ",", "ts", ",", 
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7328827048875237`*^9, 3.732882716756711*^9}, {
  3.7328827665006847`*^9, 3.7328827886278973`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"f612a595-4ee6-41b7-a9d6-aef1ef605207"],

Cell[BoxData[
 TemplateBox[{
  "Merge","list1",
   "\"The argument \\!\\(\\*RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Times\\\", \
\\\"]\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\
\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"CDF\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.3728727728361896`\\\"}], \\\" \\\", \
\\\"BarrierOption`Private`n$4657\\\"}]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\
\"1\\\", \\\"\[Rule]\\\", \\\"#1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"&\\\"}], \\\",\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.98`\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\
\"0.7071067811865476`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.6929646455628166`\\\", \\\",\\\", \\\"0.7071067811865476`\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.35`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"2.857142857142857`\\\", \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"2.857142857142857`\\\"}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.34299999999999997`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"4.3478260869565215`\\\", \
\\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\
\"\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"4.3478260869565215`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{\\\"0.8330343813566166`\\\", \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"3.0743773095067284`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\) is not a valid list of Associations or rules or lists of \
rules.\"",2,14,5,25793760559478903617,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.7328833775257807`*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"79fc0761-e57f-4cae-8735-23a431a241d7"],

Cell[BoxData[
 TemplateBox[{
  "Merge","list1",
   "\"The argument \\!\\(\\*RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Times\\\", \
\\\"]\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\
\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"CDF\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.5187145557655952`\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"2\\\", \\\"\[Rule]\\\", \
\\\"#1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.98`\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"19\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.98`\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\
\"0.7071067811865476`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.6929646455628166`\\\", \\\",\\\", \\\"0.7071067811865476`\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.35`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"2.857142857142857`\\\", \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"2.857142857142857`\\\"}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.34299999999999997`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"4.3478260869565215`\\\", \
\\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\
\"\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"4.3478260869565215`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{\\\"0.8330343813566166`\\\", \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"3.0743773095067284`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\) is not a valid list of Associations or rules or lists of \
rules.\"",2,14,6,25793760559478903617,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.7328833775797863`*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"309d0a76-a5da-425c-8a9c-a55532461f7e"],

Cell[BoxData[
 TemplateBox[{
  "Merge","list1",
   "\"The argument \\!\\(\\*RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Plus\\\", \\\"]\
\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", RowBox[{RowBox[{\\\
\"{\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]]}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\",\\\", \
RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"CDF\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"1\\\
\", \\\"\[Rule]\\\", \\\"#1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"&\\\"}], \
\\\",\\\", RowBox[{RowBox[{\\\"-\\\", SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]]}], \\\
\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\",\\\", RowBox[{\\\"Merge\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Times\\\", \
\\\"]\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Rule\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"2.857142857142857`\\\"}], \
\\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\[Rule]\\\", RowBox[{\\\"-\\\", \
\\\"4.3478260869565215`\\\"}]}], \\\"\[RightAssociation]\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.9461112359838753`\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"-\\\", \\\"3.0743773095067284`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\
\\\", RowBox[{\\\"-\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}]}], \
\\\"]\\\"}]}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"11\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"18.90359168241966`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.5187145557655952`\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"20\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"\[VeryThinSpace]\\\"}], \\\"-\\\", \
RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"19\\\", \
\\\"\[RightSkeleton]\\\"}], \\\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"28\\\", \\\"\[RightSkeleton]\\\"}]}]}], \\\")\\\"}]}]], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.19062035960864987`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.9039702474861144`\\\", \\\" \
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"28\\\", \
\\\"\[RightSkeleton]\\\"}]}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\")\
\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
\\\"Total\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]\\) is not a valid list of \
Associations or rules or lists of rules.\"",2,14,7,25793760559478903617,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.732883377882817*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"677cd45c-3278-4561-a9a2-edf787bb7f5b"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Merge\\\", \\\"::\\\", \
\\\"list1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,14,8,25793760559478903617,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.7328833780688353`*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"30993af4-870a-4460-9389-010348675ab0"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7328827453245673`*^9, 3.7328827931113453`*^9, {3.732883372245253*^9, 
   3.732883381994228*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"052b61d9-0115-4d44-b291-22273a84792c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "CDF", "]"}]], "Input",
 CellChangeTimes->{{3.7328831905740876`*^9, 3.732883194505481*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"1d1c5812-3f89-46f9-a55a-e313cd43fc47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Protected", ",", "ReadProtected"}], "}"}]], "Output",
 CellChangeTimes->{3.732883196690699*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"9e78b6ca-9f79-4e7e-a95c-edf842a47d3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "PDF", "]"}]], "Input",
 CellChangeTimes->{{3.732883230614091*^9, 3.7328832372517548`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"3c788f70-e7aa-4073-a499-2d417fe49afd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Protected", ",", "ReadProtected"}], "}"}]], "Output",
 CellChangeTimes->{3.7328832374647765`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"925ceb1d-55c8-4664-9952-0be6f8b5e403"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Port to Python", "Chapter",
 CellChangeTimes->{{3.636285090218025*^9, 3.63628509134405*^9}, {
  3.636354549595379*^9, 3.636354550437396*^9}, {3.6378990856151724`*^9, 
  3.6378990886691723`*^9}},ExpressionUUID->"75b4616d-cb2d-4656-87bd-\
17ed2a8e38bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], ",", 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], ",", "1", ",", 
      SqrtBox[
       FractionBox["t1", "t2"]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}], ",", 
      SqrtBox[
       FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.653650479289018*^9, 
  3.653650493315421*^9}},ExpressionUUID->"516df623-c1b4-4d39-8e19-\
f21438f0427c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}]},
     {
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], "1", 
      SqrtBox[
       FractionBox["t1", "t2"]]},
     {
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}], 
      SqrtBox[
       FractionBox["t1", "t2"]], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6536504936784573`*^9},ExpressionUUID->"0acf2943-b76c-48b1-ad84-\
041d41afed55"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"value", "=", 
   RowBox[{
    RowBox[{"barrierOption", "[", 
     RowBox[{"cp", ",", 
      RowBox[{"{", 
       RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
      "intRate", ",", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
      "strike", ",", "t", ",", " ", "ts", ",", 
      RowBox[{"{", 
       RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"BarrierOption`Private`n", "  ", "\[Rule]", " ", "n"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6378992254986725`*^9, 3.637899289539672*^9}, {
  3.653649824688565*^9, 3.6536498354616423`*^9}, {3.653650241063198*^9, 
  3.653650246359728*^9}},ExpressionUUID->"370b5de4-7fd2-4358-acdf-\
2b8061d3869b"],

Cell[CellGroupData[{

Cell[BoxData["value"], "Input",
 CellChangeTimes->{{3.653650344671558*^9, 
  3.653650345106601*^9}},ExpressionUUID->"267e35c6-d1f1-4dc3-9af0-\
3edefaa40ee3"],

Cell[BoxData[
 RowBox[{"cp", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "sYield"}], " ", "t"}]], " ", "sUnd", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate", "+", 
             RowBox[{"bVol", " ", "corr", " ", "sVol"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "bUnd"], "]"}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate", "+", 
             RowBox[{"bVol", " ", "corr", " ", "sVol"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "intRate"}], " ", "t"}]], " ", "strike", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate"}], ")"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "bUnd"], "]"}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.65365034579467*^9, 3.65381511499807*^9, 
  3.653815184820739*^9},ExpressionUUID->"792cab9b-1c85-43bc-a00c-\
8d99192d75f2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Junk", "Chapter",
 CellChangeTimes->{{3.636285090218025*^9, 3.63628509134405*^9}, {
  3.636354549595379*^9, 
  3.636354550437396*^9}},ExpressionUUID->"26de32d0-bcfd-4552-ad87-\
d75be2af4510"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gammaMat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t2", "t"]]}], ",", 
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t1", "t"]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t2", "t"]]}], ",", "1", ",", 
       SqrtBox[
        FractionBox["t1", "t2"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t1", "t"]]}], ",", 
       SqrtBox[
        FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6538153567792125`*^9, 
  3.653815366336441*^9}},ExpressionUUID->"b93c0c4b-96a2-4cad-bf8b-\
d6baa1268a11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"gammaMat", ",", " ", 
   RowBox[{"t1", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6538153675104604`*^9, 
  3.653815374772585*^9}},ExpressionUUID->"d1c06d8d-dc10-4d20-81cb-\
be657eb033be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "corr"}], " ", "cp", " ", 
      SqrtBox[
       FractionBox["t2", "t"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "corr"}], " ", "cp", " ", 
      SqrtBox[
       FractionBox["t2", "t"]]}], ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6538153756356*^9},ExpressionUUID->"3fe70b11-e2cc-4cea-8f44-9d8ce6febe87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.2", " ", ",", "x"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"x", "\[Rule]", "Infinity"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732881807018746*^9, 3.7328819063146744`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"f0925c1d-18de-419f-aecb-29270505abb0"],

Cell[BoxData["0.3127005161682312`"], "Output",
 CellChangeTimes->{{3.7328818543864822`*^9, 3.732881907518795*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"548681a1-ed54-42d6-813b-fdecd356d865"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "corr"}], " ", "cp", " ", 
            SqrtBox[
             FractionBox["t2", "t"]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "corr"}], " ", "cp", " ", 
            SqrtBox[
             FractionBox["t2", "t"]]}], ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], "==", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"-", "corr"}], " ", "cp", " ", 
             SqrtBox[
              FractionBox["t2", "t"]]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "corr"}], " ", "cp", " ", 
             SqrtBox[
              FractionBox["t2", "t"]]}], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", "1"}], "]"}], ",", " ", "z"}], "]"}]}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.653815502613041*^9, 
  3.6538156026024218`*^9}},ExpressionUUID->"315f94aa-d991-4f93-ae79-\
d4ac1761d557"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.653815523866023*^9, 3.6538155420623274`*^9}, {
  3.6538155848820972`*^9, 
  3.6538156038834624`*^9}},ExpressionUUID->"1dc82ed8-e878-41a7-b541-\
a4873f397e2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"CDF", "[", 
   RowBox[{
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t2", "t"]]}], ",", 
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t1", "t"]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t2", "t"]]}], ",", "1", ",", 
          SqrtBox[
           FractionBox["t1", "t2"]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t1", "t"]]}], ",", 
          SqrtBox[
           FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sVol", " ", 
          SqrtBox["t"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"intRate", "-", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ",
             "t"}], "+", 
           FractionBox[
            RowBox[{
            "2", " ", "corr", " ", "BarrierOption`Private`n", " ", "sVol", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "bUnd"], "]"}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], "-", 
           RowBox[{"Log", "[", 
            FractionBox["strike", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "sVol", " ", 
        SqrtBox["t2"]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
            "intRate"}], ")"}], " ", "t2"}], "+", 
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "bUnd"], "]"}], "-", 
         RowBox[{"2", " ", "BarrierOption`Private`n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "bUnd"], "]"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
        RowBox[{"bVol", " ", 
         SqrtBox["t2"]}]]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "sVol", " ", 
        SqrtBox["t1"]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
            "intRate"}], ")"}], " ", "t1"}], "+", 
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "bUnd"], "]"}]}], 
        RowBox[{"bVol", " ", 
         SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.63790018654408*^9, 3.6379001925242233`*^9}, {
  3.6379002905228586`*^9, 
  3.637900298651046*^9}},ExpressionUUID->"0a0ec0da-77d3-45f2-a9dd-\
729c22bcb592"],

Cell[BoxData[
 RowBox[{"CDF", "[", 
  RowBox[{
   RowBox[{"MultinormalDistribution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t2", "t"]]}], ",", 
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t1", "t"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t2", "t"]]}], ",", "1", ",", 
         SqrtBox[
          FractionBox["t1", "t2"]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t1", "t"]]}], ",", 
         SqrtBox[
          FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sVol", " ", 
         SqrtBox["t"]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"intRate", "-", 
             FractionBox[
              SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
           "t"}], "+", 
          FractionBox[
           RowBox[{
           "2", " ", "corr", " ", "BarrierOption`Private`n", " ", "sVol", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "bUnd"], "]"}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], "-", 
          RowBox[{"Log", "[", 
           FractionBox["strike", "sUnd"], "]"}]}], 
         RowBox[{"sVol", " ", 
          SqrtBox["t"]}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "sVol", " ", 
       SqrtBox["t2"]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
           "intRate"}], ")"}], " ", "t2"}], "+", 
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "bUnd"], "]"}], "-", 
        RowBox[{"2", " ", "BarrierOption`Private`n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "bUnd"], "]"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
       RowBox[{"bVol", " ", 
        SqrtBox["t2"]}]]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "sVol", " ", 
       SqrtBox["t1"]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
           "intRate"}], ")"}], " ", "t1"}], "+", 
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "bUnd"], "]"}]}], 
       RowBox[{"bVol", " ", 
        SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.6379001828500037`*^9, 3.6379001937102475`*^9}, 
   3.637900300328086*^9},ExpressionUUID->"666de570-4dcc-4501-9e59-\
0384f74a22b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"subs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{"mean_", ",", " ", "cov_"}], "]"}], ",", " ", "point_"}], 
     "]"}], "\[Rule]", " ", 
    RowBox[{"mvnscdf", "[", 
     RowBox[{"mean", ",", " ", "cov", ",", " ", "point"}], "]"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.6379003029911427`*^9, 3.6379003535834093`*^9}, {
  3.6536499873808327`*^9, 
  3.6536500627113647`*^9}},ExpressionUUID->"a5cb283f-d249-474f-94a7-\
60bf5e8570bd"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MultinormalDistribution", "::", "arprm"}], "MessageName"], ":", 
  " ", "\<\"-- Message text not found -- (\[NoBreak]\\!\\(mean_\\)\[NoBreak]) \
(\[NoBreak]\\!\\(1\\)\[NoBreak]) (\[NoBreak]\\!\\(MultinormalDistribution[\\(\
\\(mean_, cov_\\)\\)]\\)\[NoBreak]) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/MultinormalDistribution\\\", ButtonNote -> \
\\\"MultinormalDistribution::arprm\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.653650040586152*^9},ExpressionUUID->"1f40051c-695e-4200-a3e9-\
607e22c8c6bb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{"mean_", ",", "cov_"}], "]"}], ",", "point_"}], "]"}], 
   "\[Rule]", 
   RowBox[{"mvnscdf", "[", 
    RowBox[{"mean", ",", "cov", ",", "point"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6536500405891523`*^9},ExpressionUUID->"48350ea4-fbc0-4b46-8cc4-\
d20bf94df952"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"xxx", "=", 
  RowBox[{
   RowBox[{"barrierOption", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "vol"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "vol"}], "}"}], ",", "corr", ",", "intRate",
      ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
     "strike", ",", "t", ",", "ts", ",", 
     RowBox[{"{", 
      RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}], " ", "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7325159006834087`*^9, 3.7325159664469843`*^9}, {
  3.732600954468045*^9, 3.732600987646045*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"90a0b17f-f6d5-4ba1-8d91-577b158db02f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", "1.23", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", "0.45", "}"}], "}"}]}], "]"}], "[", 
  RowBox[{"{", "0.56", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7329649337175026`*^9, 3.7329649604625025`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"fc92d22e-904a-48eb-a256-6097df77540a"],

Cell[BoxData["0.15895135783295036`"], "Output",
 CellChangeTimes->{{3.732964948440503*^9, 3.7329649607315025`*^9}, 
   3.732965021950503*^9, 3.7329650984815025`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"7cf48ea1-8dec-42a4-b1c7-5e8f8d99bca2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", "1.23", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", "0.45", "}"}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"fd", "[", 
    RowBox[{"0.56", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.732965030747503*^9, 3.7329650417785025`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"cc736091-7bd2-45b6-b2e6-ce6319cc7b2f"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.15895135783295036`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"x1\"\>", "\[Rule]", "0.3611497947266298`"}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7329650424655027`*^9, 3.7329651001515026`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"4631502b-c68f-4b87-831f-ea0a96396c0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", "1.23", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"fd", "[", 
       RowBox[{"0.45", ",", " ", 
        RowBox[{"<|", 
         RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
     "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"fd", "[", 
    RowBox[{"0.56", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.732965170315503*^9, 3.7329651815545025`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"3341e86e-58c6-410b-961e-3c19c30d7266"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.15895135783295036`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"vol1\"\>", "\[Rule]", "0.26885595829649106`"}], ",", 
     RowBox[{"\<\"x1\"\>", "\[Rule]", "0.3611497947266298`"}]}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7329651824675026`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"618fb676-84d6-421d-8fe0-d2c5120c9dcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1.23", ",", " ", "0.321"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.45", " ", "0.45"}], ",", " ", 
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}], ",", " ", 
        RowBox[{"0.32", " ", "0.32"}]}], "}"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0.56", ",", " ", 
    RowBox[{"-", "0.12"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.732965213536503*^9, 3.7329652824364915`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"81f14485-0fdb-4534-a522-31e96fd46f6b"],

Cell[BoxData["0.06308407937920026`"], "Output",
 CellChangeTimes->{3.7329652833305807`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"464e8ef5-c18e-4b8a-a591-9a1d304bbe57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1.23", ",", " ", "0.321"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.45", " ", "0.45"}], ",", " ", 
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}], ",", " ", 
        RowBox[{"0.32", " ", "0.32"}]}], "}"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fd", "[", 
     RowBox[{"0.56", ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", " ", 
    RowBox[{"fd", "[", 
     RowBox[{
      RowBox[{"-", "0.12"}], ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<x2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7329652907893267`*^9, 3.732965315158763*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cb2fe641-0ed5-4e03-bc6b-fb334c6b568a"],

Cell[BoxData[
 RowBox[{"CDF", "[", 
  RowBox[{
   RowBox[{"MultinormalDistribution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.`", ",", "0.9799999999999999`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.9799999999999999`", ",", "1.`"}], "}"}]}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "1.4888888888888887`"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"x1\"\>", "\[Rule]", "2.2222222222222223`"}], 
        "\[RightAssociation]"}]}], "]"}], ",", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "1.378125`"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"x2\"\>", "\[Rule]", "3.125`"}], 
        "\[RightAssociation]"}]}], "]"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7329653157968273`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"97c35a00-6bf4-4ad3-bfdb-0f310c082620"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", "0.1", "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"{", "0.45", "}"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"-", "1.032"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7331214144309044`*^9, 3.7331214382232833`*^9}, {
  3.7331216833087893`*^9, 3.733121701796638*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"843df714-47ca-47f3-acd6-1de5ad2bfbd3"],

Cell[BoxData["0.24079617639196618`"], "Output",
 CellChangeTimes->{
  3.7331214388743486`*^9, 3.7331216164731064`*^9, {3.7331216748599443`*^9, 
   3.7331217022796865`*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"4b2db56f-d6fc-4016-b877-9ec9e37572c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fd", "[", 
     RowBox[{"0.1", ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<m1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], ",", 
   " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"fd", "[", 
      RowBox[{"0.45", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
    "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"fd", "[", 
     RowBox[{
      RowBox[{"-", "1.032"}], ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7331217164831066`*^9, 3.7331217307495327`*^9}, {
  3.733121828890346*^9, 3.733121853690826*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"58cb1883-86d6-4796-b721-1ecf5f0ac5e6"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.24079617639196618`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"x1\"\>", "\[Rule]", "0.6057361592793461`"}], ",", 
     RowBox[{"\<\"m1\"\>", "\[Rule]", 
      RowBox[{"-", "0.6057361592793461`"}]}], ",", 
     RowBox[{"\<\"vol1\"\>", "\[Rule]", "0.761881480338022`"}]}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7331217313355913`*^9, 3.733121823221779*^9, 
  3.733121854302887*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"1d7493bd-f5c8-4a61-82aa-08ddacf0aa1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", " ", 
     RowBox[{"-", "0.3"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.45", " ", "0.45"}], ",", " ", 
       RowBox[{"0.98", " ", "0.45", " ", "0.33"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.98", " ", "0.45", " ", "0.33"}], ",", " ", 
       RowBox[{"0.33", " ", "0.33"}]}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"0.032", ",", " ", 
     RowBox[{"-", "0.0547"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7331222485323057`*^9, 3.7331223467511272`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"6df89177-9545-4bea-b477-c55b3b6c233d"],

Cell[BoxData["0.00021817644223337968`"], "Output",
 CellChangeTimes->{{3.733122291214574*^9, 3.73312234757921*^9}, 
   3.733122715750023*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"a3f45e65-84d4-4fb8-b04f-ae4bfd7af2ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"0.1", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<mu1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", " ", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "0.3"}], ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<mu2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}], 
   ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"fd", "[", 
         RowBox[{"0.45", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "2"], 
       ",", " ", 
       RowBox[{
        RowBox[{"fd", "[", 
         RowBox[{"0.98", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<rho12\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], " ", 
        RowBox[{"fd", "[", 
         RowBox[{"0.45", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], 
        RowBox[{"fd", "[", " ", 
         RowBox[{"0.33", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}]}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"fd", "[", 
         RowBox[{"0.98", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<rho12\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], " ", 
        RowBox[{"fd", "[", 
         RowBox[{"0.45", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], " ", 
        RowBox[{"fd", "[", " ", 
         RowBox[{"0.33", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], ",", 
       SuperscriptBox[
        RowBox[{"fd", "[", " ", 
         RowBox[{"0.33", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "2"]}], 
      "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"0.032", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", " ", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "0.0547"}], ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<x2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.733122356623114*^9, 3.733122381744626*^9}, {
  3.733122414145866*^9, 3.7331225230797577`*^9}, {3.7331366085982304`*^9, 
  3.7331366113405046`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7fb5d600-557e-4871-9b94-ac1c805b6d3c"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.00021817644223337968`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"vol2\"\>", "\[Rule]", "0.011062818681972357`"}], ",", 
     RowBox[{"\<\"vol1\"\>", "\[Rule]", "0.0016273119111074933`"}], ",", 
     RowBox[{"\<\"rho12\"\>", "\[Rule]", 
      RowBox[{"-", "0.10368823414264175`"}]}], ",", 
     RowBox[{"\<\"x2\"\>", "\[Rule]", 
      RowBox[{"-", "0.014882715715657881`"}]}], ",", 
     RowBox[{"\<\"mu2\"\>", "\[Rule]", "0.014882715715657881`"}], ",", 
     RowBox[{"\<\"mu1\"\>", "\[Rule]", 
      RowBox[{"-", "0.010768975882328698`"}]}], ",", 
     RowBox[{"\<\"x1\"\>", "\[Rule]", "0.010768975882328698`"}]}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.733122717898238*^9, 3.733123503685809*^9, 
  3.7331239564900846`*^9, 3.7331366118385544`*^9, 3.733138371530506*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"0a7e3a34-292a-4185-a1b1-89179e98f727"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi", "[", 
  RowBox[{
   RowBox[{"{", "0.1", "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"{", "0.45", "}"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"-", "1.032"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.733138406693022*^9, 3.7331384299063425`*^9}, {
  3.7334645726034994`*^9, 3.733464582795519*^9}, {3.733464655036742*^9, 
  3.7334646633175697`*^9}, {3.733464708628101*^9, 3.7334647132005577`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"e1f5569b-5313-4999-9bd7-02f43863c77f"],

Cell[BoxData["0.07693686654295023`"], "Output",
 CellChangeTimes->{
  3.7331384318635387`*^9, 3.7331385027706285`*^9, 3.7334644540576463`*^9, {
   3.733464548725112*^9, 3.7334645831835575`*^9}, {3.7334646496932077`*^9, 
   3.7334646636025987`*^9}, {3.7334647139846363`*^9, 3.733464739052143*^9}, 
   3.7334647747197094`*^9, 3.733465408700101*^9, 3.7334655983390627`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"14cf20d0-ae04-4eea-96a8-71c81969c57d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", " ", 
     RowBox[{"-", "0.2"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.45", " ", "0.45"}], ",", " ", 
       RowBox[{
        RowBox[{"-", "0.98"}], " ", "0.45", " ", "0.3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.98"}], " ", "0.45", " ", "0.3"}], ",", " ", 
       RowBox[{"0.3", " ", "0.3"}]}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.032"}], ",", " ", "0.5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7334656121204405`*^9, 3.7334656593101597`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"ccd78427-fbd1-4aa8-acf2-5e89b5f635bb"],

Cell[BoxData["0.0003471508891822327`"], "Output",
 CellChangeTimes->{{3.733465648149043*^9, 3.7334656598282113`*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"7c30a7fc-cd77-48d7-ba8e-7839782be436"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fd", "[", 
     RowBox[{"0.1", ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<m1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], ",", 
   " ", 
   RowBox[{"{", 
    RowBox[{"{", "0.45", "}"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"-", "1.032"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7334657847657037`*^9, 3.733465798081035*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d6baadc3-8503-42ce-8a90-f3f7854e63d6"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"m1\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"2.2222222222222223`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}]\\) has \
evaluated to non-numerical values for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.032`\\\"}]}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",2,28,6,
   25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.733465799438171*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"466dc360-0f1a-4995-a182-09262e07f54a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"m1\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"2.2222222222222223`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}]\\) has \
evaluated to non-numerical values for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.032`\\\"}]}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",2,28,7,
   25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7334657994451714`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"e6509476-acc6-4a92-bfcd-20fae17e8792"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"m1\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"2.2222222222222223`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}]\\) has \
evaluated to non-numerical values for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.032`\\\"}]}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",2,28,8,
   25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7334657994951763`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"b7ca2181-2f26-44c5-a17e-c2f5eab41286"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,28,9,25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7334657995471816`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"6cc015af-3e9c-48ab-8bb9-946d650a89be"],

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"fd", "[", 
    RowBox[{
     RowBox[{"1.`", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "1.1111111111111112`"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "0.1`"}], "+", "z35"}], ")"}], "2"]}]]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{"\<\"m1\"\>", "\[Rule]", 
       RowBox[{"2.2222222222222223`", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "1.1111111111111112`"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.1`"}], "+", "z35"}], ")"}], "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.1`"}], "+", "z35"}], ")"}]}]}], 
      "\[RightAssociation]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z35", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", 
     RowBox[{"-", "1.032`"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.733465799597187*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"10136733-d257-4d08-817e-f01be0889219"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dt", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"t", ",", "x1", ",", "x2"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x1", ",", " ", "lb1", ",", " ", "ub1"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x2", ",", " ", "lb2", ",", " ", "ub2"}], "}"}]}], "]"}], ",", 
    " ", "t"}], "]"}], " ", "//", " ", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.7334852716021924`*^9, 3.733485353804412*^9}, {
  3.7334857253445625`*^9, 
  3.7334857551995473`*^9}},ExpressionUUID->"0b7e0e37-3741-47fb-9eb6-\
3bb5e8d9e4eb"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ub3", "-", "lb3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", "lb1", "ub1"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
           RowBox[{
            RowBox[{
             SuperscriptBox["f", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "(", 
             RowBox[{"t", ",", "x1", ",", "x2"}], ")"}], 
            RowBox[{"\[DifferentialD]", "x2"}]}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"\[DifferentialD]", "lb2"}], 
            RowBox[{"\[DifferentialD]", "t"}],
            MultilineFunction->None], " ", 
           RowBox[{"f", "(", 
            RowBox[{"t", ",", "x1", ",", "lb2"}], ")"}]}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"\[DifferentialD]", "ub2"}], 
            RowBox[{"\[DifferentialD]", "t"}],
            MultilineFunction->None], " ", 
           RowBox[{"f", "(", 
            RowBox[{"t", ",", "x1", ",", "ub2"}], ")"}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "x1"}]}]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", "lb1"}], 
        RowBox[{"\[DifferentialD]", "t"}],
        MultilineFunction->None], " ", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
        RowBox[{
         RowBox[{"f", "(", 
          RowBox[{"t", ",", "lb1", ",", "x2"}], ")"}], 
         RowBox[{"\[DifferentialD]", "x2"}]}]}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", "ub1"}], 
        RowBox[{"\[DifferentialD]", "t"}],
        MultilineFunction->None], " ", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
        RowBox[{
         RowBox[{"f", "(", 
          RowBox[{"t", ",", "ub1", ",", "x2"}], ")"}], 
         RowBox[{"\[DifferentialD]", "x2"}]}]}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", "ub3"}], 
       RowBox[{"\[DifferentialD]", "t"}],
       MultilineFunction->None], "-", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "lb3"}], 
       RowBox[{"\[DifferentialD]", "t"}],
       MultilineFunction->None]}], ")"}], " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "lb1", "ub1"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
      RowBox[{
       RowBox[{"f", "(", 
        RowBox[{"t", ",", "x1", ",", "x2"}], ")"}], 
       RowBox[{"\[DifferentialD]", "x2"}], 
       RowBox[{"\[DifferentialD]", "x1"}]}]}]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.7334853074847803`*^9, 3.7334853542234535`*^9}, 
   3.733485731336161*^9},
 CellLabel->
  "Out[34]//TraditionalForm=",ExpressionUUID->"f1aedf49-73bb-4eb1-8b7b-\
5cc4ff5149c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"smallPhi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", ",", " ", "m2"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vol1", " ", "vol1"}], ",", " ", 
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"vol2", " ", "vol2"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7334857891879463`*^9, 3.733485856017628*^9}, 
   3.733486102775302*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"b97a893c-ba69-4668-9aa4-5aa18c5fb6df"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["m2", "2"], " ", 
      SuperscriptBox["vol1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["m1", "2"], " ", 
      SuperscriptBox["vol2", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["vol2", "2"], " ", 
      SuperscriptBox["x1", "2"]}], "-", 
     RowBox[{
     "2", " ", "rho12", " ", "vol1", " ", "vol2", " ", "x1", " ", "x2"}], "+", 
     RowBox[{
      SuperscriptBox["vol1", "2"], " ", 
      SuperscriptBox["x2", "2"]}], "-", 
     RowBox[{"2", " ", "m2", " ", "vol1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m1", " ", "rho12", " ", "vol2"}], "-", 
        RowBox[{"rho12", " ", "vol2", " ", "x1"}], "+", 
        RowBox[{"vol1", " ", "x2"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "m1", " ", "vol2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "vol2"}], " ", "x1"}], "+", 
        RowBox[{"rho12", " ", "vol1", " ", "x2"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["rho12", "2"]}], ")"}], " ", 
     SuperscriptBox["vol1", "2"], " ", 
     SuperscriptBox["vol2", "2"]}]]], 
  SqrtBox[
   RowBox[{"1", "-", 
    SuperscriptBox["rho12", "2"]}]]]], "Output",
 CellChangeTimes->{{3.733485830645091*^9, 3.7334858573837647`*^9}, 
   3.733486103520376*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"630ce4f0-9a7e-4c52-975e-7ea3df9b74c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"smallPhi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", ",", " ", "m2"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vol1", " ", "vol1"}], ",", " ", 
        RowBox[{"0", " ", "vol1", " ", "vol2"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"vol2", " ", "vol2"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7334858678508115`*^9, 3.7334858712831545`*^9}, 
   3.7334860971347375`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"d454b804-1c50-43f3-ba2f-3e6a2e4a4407"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m1", "-", "x1"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["vol1", "2"]}]]}], "-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m2", "-", "x2"}], ")"}], "2"], 
    RowBox[{"2", " ", 
     SuperscriptBox["vol2", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.733485872367263*^9, 3.7334860977557993`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"171730ad-8224-47e6-91eb-019b7d034899"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"smallPhi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", ",", " ", "m2", ",", " ", "m3"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vol1", " ", "vol1"}], ",", " ", 
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"rho13", " ", "vol1", " ", "vol3"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"vol2", " ", "vol2"}], ",", " ", 
        RowBox[{"rho23", " ", "vol2", " ", "vol3"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rho13", " ", "vol1", " ", "vol3"}], ",", " ", 
        RowBox[{"rho23", " ", "vol2", " ", "vol3"}], ",", " ", 
        RowBox[{"vol3", " ", "vol3"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2", ",", " ", "x3"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7334858868837147`*^9, 3.7334859316551914`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"fc2083dd-39d4-447d-b642-f66699cbe156"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["m3", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["rho12", "2"]}], ")"}], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["m2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["rho13", "2"]}], ")"}], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol3", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["m1", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["m1", "2"], " ", 
       SuperscriptBox["rho23", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"]}], "+", 
      RowBox[{"2", " ", "m1", " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", "x1"}], "-", 
      RowBox[{"2", " ", "m1", " ", 
       SuperscriptBox["rho23", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", "x1"}], "-", 
      RowBox[{
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["rho23", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x1", "2"]}], "-", 
      RowBox[{"2", " ", "m1", " ", "rho12", " ", "vol1", " ", "vol2", " ", 
       SuperscriptBox["vol3", "2"], " ", "x2"}], "+", 
      RowBox[{
      "2", " ", "m1", " ", "rho13", " ", "rho23", " ", "vol1", " ", "vol2", 
       " ", 
       SuperscriptBox["vol3", "2"], " ", "x2"}], "+", 
      RowBox[{"2", " ", "rho12", " ", "vol1", " ", "vol2", " ", 
       SuperscriptBox["vol3", "2"], " ", "x1", " ", "x2"}], "-", 
      RowBox[{"2", " ", "rho13", " ", "rho23", " ", "vol1", " ", "vol2", " ", 
       SuperscriptBox["vol3", "2"], " ", "x1", " ", "x2"}], "-", 
      RowBox[{
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["rho13", "2"], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x2", "2"]}], "-", 
      RowBox[{"2", " ", "m1", " ", "rho13", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x3"}], "+", 
      RowBox[{"2", " ", "m1", " ", "rho12", " ", "rho23", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x3"}], "+", 
      RowBox[{"2", " ", "rho13", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x1", " ", "x3"}], "-", 
      RowBox[{"2", " ", "rho12", " ", "rho23", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x1", " ", "x3"}], "-", 
      RowBox[{"2", " ", "rho12", " ", "rho13", " ", 
       SuperscriptBox["vol1", "2"], " ", "vol2", " ", "vol3", " ", "x2", " ", 
       "x3"}], "+", 
      RowBox[{"2", " ", "rho23", " ", 
       SuperscriptBox["vol1", "2"], " ", "vol2", " ", "vol3", " ", "x2", " ", 
       "x3"}], "-", 
      RowBox[{
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["x3", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["rho12", "2"], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["x3", "2"]}], "-", 
      RowBox[{"2", " ", "m3", " ", "vol1", " ", "vol2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rho12", " ", "rho13"}], "-", "rho23"}], ")"}], " ", 
          "vol1", " ", "vol3"}], "+", 
         RowBox[{"m1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "rho13"}], "+", 
            RowBox[{"rho12", " ", "rho23"}]}], ")"}], " ", "vol2", " ", 
          "vol3"}], "+", 
         RowBox[{"rho13", " ", "vol2", " ", "vol3", " ", "x1"}], "-", 
         RowBox[{"rho12", " ", "rho23", " ", "vol2", " ", "vol3", " ", "x1"}],
          "-", 
         RowBox[{"rho12", " ", "rho13", " ", "vol1", " ", "vol3", " ", "x2"}],
          "+", 
         RowBox[{"rho23", " ", "vol1", " ", "vol3", " ", "x2"}], "-", 
         RowBox[{"vol1", " ", "vol2", " ", "x3"}], "+", 
         RowBox[{
          SuperscriptBox["rho12", "2"], " ", "vol1", " ", "vol2", " ", 
          "x3"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "m2", " ", "vol1", " ", "vol3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m1", " ", 
          RowBox[{"(", 
           RowBox[{"rho12", "-", 
            RowBox[{"rho13", " ", "rho23"}]}], ")"}], " ", "vol2", " ", 
          "vol3"}], "-", 
         RowBox[{"rho12", " ", "vol2", " ", "vol3", " ", "x1"}], "+", 
         RowBox[{"rho13", " ", "rho23", " ", "vol2", " ", "vol3", " ", "x1"}],
          "+", 
         RowBox[{"vol1", " ", "vol3", " ", "x2"}], "-", 
         RowBox[{
          SuperscriptBox["rho13", "2"], " ", "vol1", " ", "vol3", " ", "x2"}],
          "+", 
         RowBox[{"rho12", " ", "rho13", " ", "vol1", " ", "vol2", " ", "x3"}],
          "-", 
         RowBox[{"rho23", " ", "vol1", " ", "vol2", " ", "x3"}]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["rho12", "2"], "+", 
        SuperscriptBox["rho13", "2"], "-", 
        RowBox[{"2", " ", "rho12", " ", "rho13", " ", "rho23"}], "+", 
        SuperscriptBox["rho23", "2"]}], ")"}], " ", 
      SuperscriptBox["vol1", "2"], " ", 
      SuperscriptBox["vol2", "2"], " ", 
      SuperscriptBox["vol3", "2"]}]]}]], "/", 
  RowBox[{"(", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["rho12", "2"], "-", 
     SuperscriptBox["rho13", "2"], "+", 
     RowBox[{"2", " ", "rho12", " ", "rho13", " ", "rho23"}], "-", 
     SuperscriptBox["rho23", "2"]}]], ")"}]}]], "Output",
 CellChangeTimes->{{3.733485932697295*^9, 3.733485937964822*^9}},
 CellLabel->"Out[40]=",ExpressionUUID->"f12112a5-07a7-4f68-b953-d59ce15891bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"smallPhi", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", " ", "m2", ",", " ", "m3"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vol1", " ", "vol1"}], ",", " ", 
          RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
          RowBox[{"rho13", " ", "vol1", " ", "vol3"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
          RowBox[{"vol2", " ", "vol2"}], ",", " ", 
          RowBox[{"rho23", " ", "vol2", " ", "vol3"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rho13", " ", "vol1", " ", "vol3"}], ",", " ", 
          RowBox[{"rho23", " ", "vol2", " ", "vol3"}], ",", " ", 
          RowBox[{"vol3", " ", "vol3"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x1", ",", " ", "x2", ",", " ", "x3"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"rho13", "\[Rule]", "0"}], "}"}]}], ")"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.733485944207446*^9, 3.733485960471072*^9}, {
  3.733486005290554*^9, 3.733486006112636*^9}, {3.7334860711911435`*^9, 
  3.733486083591383*^9}, {3.7334861188389077`*^9, 3.733486133855409*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"b2c201ad-199e-48f1-8877-7d105bd12927"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.7334860967536993`*^9, 3.7334861254895725`*^9}, 
   3.733486920097342*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"3f00270d-0741-4ca7-b9ad-9a08c52526fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["t", "2"], "+", 
      RowBox[{"\[Pi]", " ", "x"}]}], ")"}], "3"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", 
     RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7334870654122734`*^9, 3.7334870713247113`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"167e1ad0-1a10-4ceb-b8a5-e821fc8d2857"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", "2"], " ", 
   SuperscriptBox["t", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["t", "6"]}]}]], "Output",
 CellChangeTimes->{3.733487071745914*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"59178369-5ae0-4424-8c82-9a2c0a85c4d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["t", "2"], "+", 
      RowBox[{"\[Pi]", " ", "x"}]}], ")"}], "3"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", 
     RowBox[{"-", "1"}], ",", " ", 
     RowBox[{"fd", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<ub\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7334869227649593`*^9, 3.733486991764201*^9}, {
  3.7334870227928004`*^9, 3.733487048486165*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"cb0b97d7-150a-4ec7-8d5d-00c032fa5793"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{
   RowBox[{"2", " ", 
    SuperscriptBox["t", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Pi]", "2"], "+", 
      SuperscriptBox["t", "4"]}], ")"}]}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"ub\"\>", "\[Rule]", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Pi]", "+", 
        SuperscriptBox["t", "2"]}], ")"}], "3"]}], "\[RightAssociation]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.733486961016404*^9, 3.7334869939482155`*^9}, {
  3.7334870262716227`*^9, 3.73348704926617*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"a2a9d0ca-38fb-419c-b62c-b39fb745a9ff"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Collapse to BS", "Chapter",
 CellChangeTimes->{{3.736845959257096*^9, 
  3.736845962881132*^9}},ExpressionUUID->"4bf7ef27-65b1-4d42-ba7b-\
aa3cb4c72ab5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"gmat", ",", " ", "wsn", ",", " ", "wkn"}], "}"}], "=", 
   RowBox[{"outCoeff", "[", 
    RowBox[{"cp", ",", 
     RowBox[{"{", 
      RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", "1", ",", 
     "intRate", ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "t", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
     "strike", ",", "t", ",", "ts", ",", "n"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7368462271454754`*^9, 3.7368462841266446`*^9}, {
  3.736846467154355*^9, 3.7368464874357696`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"4649bec9-d8d7-4f3f-9a65-a678aa614722"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"gmat", ",", " ", 
   RowBox[{"t1", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7368462912297883`*^9, 3.7368462917908*^9}, 
   3.7368463510930014`*^9, {3.736846506238152*^9, 3.736846511724264*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"f82b6fca-60de-41a8-a6f5-98381ba1b94e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7368462922908096`*^9, {3.7368463455278893`*^9, 3.736846351734014*^9}, {
   3.736846455833125*^9, 3.736846512795285*^9}, 3.7368466217485447`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"582e5f66-44fc-453e-a559-5daa5296cc3f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["S term", "Subchapter",
 CellChangeTimes->{{3.737103613077257*^9, 
  3.7371036210854464`*^9}},ExpressionUUID->"50dc4739-da8f-4b35-b106-\
5b39a52e0d1c"],

Cell[CellGroupData[{

Cell[BoxData["wsn"], "Input",
 CellChangeTimes->{{3.7368463618422194`*^9, 3.736846362282228*^9}, {
  3.7368465154393387`*^9, 3.736846520699445*^9}, {3.736846622869567*^9, 
  3.736846671557556*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"0c7792cf-999b-4a41-bb0b-76bcabaf4439"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"intRate", "+", 
         FractionBox[
          SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
         RowBox[{"2", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], "-", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
      SuperscriptBox["sVol", "2"]]]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "-", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "-", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "+", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"intRate", "+", 
        FractionBox[
         SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "sUnd"], "]"}], "-", 
        RowBox[{"Log", "[", 
         FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
     SuperscriptBox["sVol", "2"]]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "+", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ")"}]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t"}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]]}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "sVol"}], " ", 
           SqrtBox["t1"]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "intRate"}], "+", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
             " ", "t1"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7368463632332473`*^9, {3.736846456976149*^9, 3.7368464916318555`*^9}, 
   3.736846627466663*^9, 3.736846672187569*^9},
 CellLabel->"Out[7]=",ExpressionUUID->"22e12425-8fe8-405f-91b4-9abba948d580"]
}, Open  ]],

Cell["Remove the easy t1\[Rule]0 bits", "Text",
 CellChangeTimes->{{3.7368473567801085`*^9, 
  3.736847370916419*^9}},ExpressionUUID->"654e5c7e-041a-4554-93e7-\
c1ce66083531"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wsnIter1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"intRate", "+", 
           FractionBox[
            SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"intRate", "+", 
          FractionBox[
           SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}], "-", 
          RowBox[{"Log", "[", 
           FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}], "+", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "sVol"}], " ", 
             SqrtBox["t"]}], "+", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}]}]}], ";"}]], \
"Input",
 CellChangeTimes->{{3.7368467946970596`*^9, 
  3.7368470876910233`*^9}},ExpressionUUID->"e39126a8-deef-405f-a92a-\
49ed2c0b8b10"],

Cell["Simplify the 3x3 covariance into 2x2 + 1x1", "Text",
 CellChangeTimes->{{3.7368473843707128`*^9, 
  3.736847401213068*^9}},ExpressionUUID->"dcffafac-3f90-4f1b-9556-\
ccc5fb65807c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wsnIter2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"intRate", "+", 
           FractionBox[
            SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"intRate", "+", 
          FractionBox[
           SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}], "-", 
          RowBox[{"Log", "[", 
           FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                   " ", "t"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["strike", "sUnd"], "]"}]}], 
                RowBox[{"sVol", " ", 
                 SqrtBox["t"]}]]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "sVol"}], " ", 
              SqrtBox["t"]}], "+", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "intRate"}], "+", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
                " ", "t"}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], 
              RowBox[{"sVol", " ", 
               SqrtBox["t"]}]]}]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7368472448396487`*^9, 3.7368472616070447`*^9}, 
   3.7368474232575502`*^9, 3.7368477680861506`*^9, 3.73684788081557*^9, 
   3.7368479385468187`*^9, 3.7368479908499465`*^9, 3.736848069871664*^9, 
   3.736848114154617*^9, 3.736848172553899*^9, 3.7368482230039687`*^9, 
   3.736848264654848*^9, 3.736848311656866*^9, 3.736848394388647*^9, 
   3.7368484324334607`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"1603b1fc-e2a5-4074-9588-7b773b2a4ecf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wsnIter2", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.736848321930114*^9, 3.736848326820216*^9}, {
  3.7368484520768776`*^9, 3.736848452800893*^9}, {3.736848489934677*^9, 
  3.736848490435687*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"42a1b2b4-d573-4e92-bf99-13b96c2223df"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "intRate"}], "+", 
        SuperscriptBox["sVol", "2"], "-", 
        RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
        RowBox[{"n", " ", 
         RowBox[{"Log", "[", 
          FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
     SuperscriptBox["sVol", "2"]]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "-", 
               RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "-", 
               RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "cp"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
            RowBox[{
             SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
            RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "-", 
              RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "cp"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
            RowBox[{
             SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
            RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "-", 
              RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"4", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"4", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bHigh", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}], "-", 
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bLow", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7368483272112246`*^9, 3.7368484398516226`*^9, {3.7368484850975723`*^9, 
   3.7368484908886967`*^9}},
 CellLabel->"Out[9]=",ExpressionUUID->"39c907ea-88cf-4d38-b281-f3ca9023aff4"]
}, Open  ]],

Cell[TextData[{
 "Simplify ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "96b29312-18eb-4eb1-8c99-5d4432d0788e"],
 " ",
 Cell[BoxData[
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bHigh", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}], "-", 
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bLow", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}]}], ")"}]],
  CellChangeTimes->{
   3.7368483272112246`*^9, 3.7368484398516226`*^9, {3.7368484850975723`*^9, 
    3.7368484908886967`*^9}},ExpressionUUID->
  "c0638385-acc7-4457-be24-a29e7b7e3988"],
 " \[Rule] 1 using Erfc[z]=2 ",
 Cell[BoxData[
  FormBox[
   RowBox[{"CDF", "[", 
    RowBox[{"-", 
     SqrtBox["2"]}]}], TraditionalForm]],ExpressionUUID->
  "b4ec6942-7bee-41dc-977e-b77091201767"],
 "z]"
}], "Text",
 CellChangeTimes->{{3.736848785659531*^9, 3.736848826313361*^9}, {
  3.73709800816436*^9, 
  3.73709800923236*^9}},ExpressionUUID->"9d922d88-9640-47cc-8526-\
9ce465c464dd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wsnIter3", "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate"}], "+", 
            SuperscriptBox["sVol", "2"], "-", 
            RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
         SuperscriptBox["sVol", "2"]]], " ", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
               RowBox[{
                SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
               RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
               RowBox[{"4", " ", "n", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
               RowBox[{"4", " ", "n", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "-", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"4", " ", "n"}]}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate"}], "+", 
            SuperscriptBox["sVol", "2"], "-", 
            RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
         SuperscriptBox["sVol", "2"]]], " ", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
               RowBox[{
                SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
               RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
               RowBox[{"4", " ", "n", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
               RowBox[{"4", " ", "n", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "-", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "+", 
                RowBox[{"4", " ", "n"}]}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "-", 
                RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "-", 
                RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}]}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.736848781306444*^9, {3.7368488299784365`*^9, 3.736848851381874*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"839db110-6e9a-4d5e-b1fb-087f6f7d15bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wsnIter3", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.7370971405806847`*^9, 3.7370971429967394`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"f4cf7818-7ae7-4c1e-8dc4-c715ce667260"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "intRate"}], "+", 
        SuperscriptBox["sVol", "2"], "-", 
        RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
        RowBox[{"n", " ", 
         RowBox[{"Log", "[", 
          FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
     SuperscriptBox["sVol", "2"]]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "-", 
               RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "-", 
               RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "cp"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
            RowBox[{
             SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
            RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "-", 
              RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "cp"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
            RowBox[{
             SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
            RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "-", 
              RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"4", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"4", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.737097144199765*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"e609da86-db6f-4378-ae0d-ddff6d971b8a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["K term", "Subchapter",
 CellChangeTimes->{{3.737103613077257*^9, 
  3.7371036384198627`*^9}},ExpressionUUID->"3a51e324-af16-4064-9dcf-\
b63b9d2a22a8"],

Cell[CellGroupData[{

Cell[BoxData["wkn"], "Input",
 CellChangeTimes->{{3.7368464750755167`*^9, 3.736846475636528*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"3ee679ec-0756-4e94-b141-aebd057e1cad"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"intRate", "-", 
         FractionBox[
          SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
         RowBox[{"2", " ", "n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], "-", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
      SuperscriptBox["sVol", "2"]]]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "-", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}], "+", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "-", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}], "+", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "-", 
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "n", " ", 
      RowBox[{"(", 
       RowBox[{"intRate", "-", 
        FractionBox[
         SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "sUnd"], "]"}], "-", 
        RowBox[{"Log", "[", 
         FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
     SuperscriptBox["sVol", "2"]]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}], ",", 
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1", ",", 
             SqrtBox[
              FractionBox["t1", "t"]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "cp"}], " ", 
              SqrtBox[
               FractionBox["t1", "t"]]}], ",", 
             SqrtBox[
              FractionBox["t1", "t"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t"}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "intRate"}], "+", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], " ",
             "t1"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.736846476066537*^9, 3.736846500561038*^9}},
 CellLabel->"Out[18]=",ExpressionUUID->"4ebfcfd9-26c0-4ce9-a112-ac374670b11e"]
}, Open  ]],

Cell["Remove the easy t1\[Rule]0 bits", "Text",
 CellChangeTimes->{{3.7368473567801085`*^9, 
  3.736847370916419*^9}},ExpressionUUID->"1768ff78-0f00-4b0e-b59f-\
d3dc7afaf504"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wknIter1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"intRate", "-", 
           FractionBox[
            SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"intRate", "-", 
          FractionBox[
           SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}], "-", 
          RowBox[{"Log", "[", 
           FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}], ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1", ",", "0"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"intRate", "-", 
                  FractionBox[
                   SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
                " ", "t"}], "+", 
               RowBox[{"2", " ", "n", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "sUnd"], "]"}], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "intRate"}], "+", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7370972904154463`*^9, 3.737097475746686*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"f74562e0-d2a0-486e-ba60-84b2d649c942"],

Cell["Simplify the 3x3 covariance into 2x2 + 1x1", "Text",
 CellChangeTimes->{{3.7368473843707128`*^9, 
  3.736847401213068*^9}},ExpressionUUID->"d944b962-feae-4fc3-bd8d-\
074286741745"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wknIter2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"intRate", "-", 
           FractionBox[
            SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "n", " ", 
        RowBox[{"(", 
         RowBox[{"intRate", "-", 
          FractionBox[
           SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}], "-", 
          RowBox[{"Log", "[", 
           FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                RowBox[{"-", "cp"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            FractionBox[
             RowBox[{"cp", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"intRate", "-", 
                   FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                  " ", "t"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "sUnd"], "]"}], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], ",", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "intRate"}], "+", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "+", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]]}], "}"}]}], "]"}], 
        RowBox[{"CDF", "[", 
         RowBox[{
          RowBox[{"MultinormalDistribution", "[", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"{", "1", "}"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           FractionBox[
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t1"]}]], "}"}]}], "]"}]}]}], ")"}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.737097529385652*^9, 3.7370975523802094`*^9}, 
   3.7370976065661664`*^9, 3.7370976498103294`*^9, 3.7370976937934837`*^9, 
   3.737097736738653*^9, 3.73709778286736*^9, 3.7370978212503605`*^9, 
   3.7370978575783606`*^9, 3.73709789305836*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"1b47edeb-d96a-44d9-9b3f-99800bce2bf8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"wknIter2", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.73709790965036*^9, 3.7370979117053604`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"279a4d7e-b651-41e2-9ddb-fdaa295822ef"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"n", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "intRate"}], "+", 
        SuperscriptBox["sVol", "2"], "+", 
        RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "sUnd"], "]"}], "-", 
        RowBox[{"Log", "[", 
         FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
     SuperscriptBox["sVol", "2"]]}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "+", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "+", 
              RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "+", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]], " ", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "+", 
              RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "cp"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"intRate", "-", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
             " ", "t"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
            RowBox[{"Log", "[", 
             FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
         RowBox[{"sVol", " ", 
          SqrtBox["t"]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "intRate"}], "+", 
             SuperscriptBox["sVol", "2"], "+", 
             RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
          RowBox[{"4", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"-", "cp"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"cp", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"intRate", "-", 
               FractionBox[
                SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
             " ", "t"}], "+", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}], "-", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
            RowBox[{"Log", "[", 
             FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
         RowBox[{"sVol", " ", 
          SqrtBox["t"]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "intRate"}], "+", 
             SuperscriptBox["sVol", "2"], "+", 
             RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
          RowBox[{"4", " ", "n", " ", 
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "+", 
             RowBox[{"4", " ", "n"}]}], ")"}], " ", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "sUnd"], "]"}]}]}], 
         RowBox[{"2", " ", "sVol", " ", 
          SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bHigh", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}], "-", 
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bLow", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7370979128653603`*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"08f486ce-894b-4227-bc2f-b553b588fea4"]
}, Open  ]],

Cell[TextData[{
 "Simplify ",
 Cell[BoxData[
  FormBox[
   FractionBox["1", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "57fe20fc-0e8f-448f-9aa6-315d6aa4b976"],
 " ",
 Cell[BoxData[
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bHigh", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}], "-", 
    RowBox[{"Erfc", "[", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"Log", "[", 
        FractionBox["bLow", "sUnd"], "]"}], 
       RowBox[{
        SqrtBox["2"], " ", "sVol", " ", 
        SqrtBox["t1"]}]]}], "]"}]}], ")"}]],
  CellChangeTimes->{
   3.7368483272112246`*^9, 3.7368484398516226`*^9, {3.7368484850975723`*^9, 
    3.7368484908886967`*^9}},ExpressionUUID->
  "40199535-5287-4605-9caf-a86176bf1b28"],
 " \[Rule] 1 using Erfc[z]=2 ",
 Cell[BoxData[
  FormBox[
   RowBox[{"CDF", "[", 
    RowBox[{"-", 
     SqrtBox["2"]}]}], TraditionalForm]],ExpressionUUID->
  "b6d1b896-e7d6-4d6e-ba4a-9f1ad457d785"],
 "z]"
}], "Text",
 CellChangeTimes->{{3.736848785659531*^9, 3.736848826313361*^9}, {
  3.73709799077036*^9, 
  3.73709799161736*^9}},ExpressionUUID->"315983bf-bfb6-4358-9d13-\
390bb66b136d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"wknIter3", "=", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"n", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "+", 
          RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}], "-", 
          RowBox[{"Log", "[", 
           FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
       SuperscriptBox["sVol", "2"]]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "intRate"}], "+", 
            SuperscriptBox["sVol", "2"], "+", 
            RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
         SuperscriptBox["sVol", "2"]]], " ", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
               RowBox[{
                SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
               RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
               RowBox[{"4", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
               RowBox[{"4", " ", "n", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "+", 
                RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"4", " ", "n"}]}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "intRate"}], "+", 
            SuperscriptBox["sVol", "2"], "+", 
            RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
            RowBox[{"2", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
         SuperscriptBox["sVol", "2"]]], " ", 
       RowBox[{"CDF", "[", 
        RowBox[{
         RowBox[{"MultinormalDistribution", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{"-", "cp"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           FractionBox[
            RowBox[{"cp", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
               RowBox[{
                SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
               RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
               RowBox[{"4", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
               RowBox[{"4", " ", "n", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], "-", 
               RowBox[{"2", " ", 
                RowBox[{"Log", "[", 
                 FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "+", 
                RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"4", " ", "n"}]}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "+", 
               RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "+", 
              RowBox[{"2", " ", "n", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "sUnd"], "]"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
           RowBox[{"sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "+", 
               RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}]}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.7370979370033603`*^9, 3.73709793826536*^9}, 
   3.7370980217603602`*^9},
 CellLabel->"In[23]:=",ExpressionUUID->"9627b817-762c-478b-8f84-6fc5c819e1c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["value", "Subchapter",
 CellChangeTimes->{{3.737103613077257*^9, 3.7371036210854464`*^9}, {
  3.737103651864194*^9, 
  3.7371036525862107`*^9}},ExpressionUUID->"3cce6c3c-a1ba-4e62-85e8-\
1d9e0b090694"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"lCDF", "[", 
   RowBox[{
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"HeavisideTheta", "[", 
    RowBox[{"a", "+", "b"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", "a"}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"NormalDistribution", "[", 
        RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", 
       RowBox[{"-", "b"}]}], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lCDF", "[", 
   RowBox[{
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"a_", ",", "b_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"CDF", "[", 
   RowBox[{
    RowBox[{"NormalDistribution", "[", 
     RowBox[{"0", ",", " ", "1"}], "]"}], ",", " ", 
    RowBox[{"Min", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}], "Input",ExpressionUUID->\
"fcaa1aa6-4bbb-415b-bef3-46e61b03ff4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"sUnd", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "sYield"}], " ", "t"}], "]"}], " ", "wsnIter3"}], "-", 
     RowBox[{"strike", " ", 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "intRate"}], " ", "t"}], "]"}], " ", "wknIter3"}]}], " ",
     "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7370984534807196`*^9, 3.7370985313279085`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"bc9f2b79-311e-4382-8ac7-c714d8212683"],

Cell[CellGroupData[{

Cell[BoxData["v"], "Input",
 CellChangeTimes->{3.7370985409949083`*^9},
 CellLabel->"In[25]:=",ExpressionUUID->"f9d795be-d657-4d5a-8f7a-ac0e8acd5f6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sYield"}], " ", "t"}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "intRate"}], "+", 
         SuperscriptBox["sVol", "2"], "-", 
         RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
         RowBox[{"n", " ", 
          RowBox[{"Log", "[", 
           FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
      SuperscriptBox["sVol", "2"]]}]], " ", "sUnd", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "intRate"}], "+", 
           SuperscriptBox["sVol", "2"], "-", 
           RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]], " ", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "-", 
                RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "intRate"}], "+", 
           SuperscriptBox["sVol", "2"], "-", 
           RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]], " ", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "-", 
                RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "-", 
               RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
           RowBox[{"4", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"4", " ", "n", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "-", 
               RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "intRate"}], " ", "t"}], "-", 
     FractionBox[
      RowBox[{"n", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "intRate"}], "+", 
         SuperscriptBox["sVol", "2"], "+", 
         RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "sUnd"], "]"}], "-", 
         RowBox[{"Log", "[", 
          FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], 
      SuperscriptBox["sVol", "2"]]}]], " ", "strike", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "intRate"}], "+", 
           SuperscriptBox["sVol", "2"], "+", 
           RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]], " ", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "+", 
               RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
            RowBox[{"4", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "-", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "intRate"}], "+", 
           SuperscriptBox["sVol", "2"], "+", 
           RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
           RowBox[{"2", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], ")"}]}], 
        SuperscriptBox["sVol", "2"]]], " ", 
      RowBox[{"CDF", "[", 
       RowBox[{
        RowBox[{"MultinormalDistribution", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{"-", "cp"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"cp", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"4", " ", "n", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], ")"}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]], ",", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "intRate"}], "+", 
               SuperscriptBox["sVol", "2"], "+", 
               RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"4", " ", "n"}]}], ")"}], " ", 
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
            RowBox[{"4", " ", "n", " ", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "sUnd"], "]"}]}]}], 
           RowBox[{"2", " ", "sVol", " ", 
            SqrtBox["t"]}]]}], "}"}]}], "]"}]}], "+", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "+", 
              RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "-", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}], "-", 
     RowBox[{"CDF", "[", 
      RowBox[{
       RowBox[{"MultinormalDistribution", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", 
             RowBox[{"-", "cp"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "cp"}], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         FractionBox[
          RowBox[{"cp", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "+", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "sUnd"], "]"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "sUnd"], "]"}]}], ")"}]}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]], ",", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "intRate"}], "+", 
              SuperscriptBox["sVol", "2"], "+", 
              RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
           RowBox[{"4", " ", "n", " ", 
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{"4", " ", "n"}]}], ")"}], " ", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "sUnd"], "]"}]}]}], 
          RowBox[{"2", " ", "sVol", " ", 
           SqrtBox["t"]}]]}], "}"}]}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7370985413249083`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"e203af36-f004-40f6-829c-ca3366dad687"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"call", "=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nu", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"v", " ", "/.", " ", 
        RowBox[{
         RowBox[{"CDF", "[", "z___", "]"}], "\[Rule]", 
         RowBox[{"lCDF", "[", "z", "]"}]}]}], " ", ")"}], "/.", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cp", "\[Rule]", "nu"}], ",", " ", 
        RowBox[{"n", "\[Rule]", "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737103690590124*^9, 3.737103701699402*^9}, {
  3.7371044443413286`*^9, 3.7371044490514402`*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"bf81b906-547c-4b39-a4fd-8a0f1669fac3"],

Cell[CellGroupData[{

Cell[BoxData["call"], "Input",
 CellChangeTimes->{{3.737103704017459*^9, 3.7371037044624696`*^9}, {
  3.737104482158242*^9, 3.7371044843592987`*^9}, {3.7371045165870695`*^9, 
  3.7371045569040594`*^9}},
 CellLabel->"In[50]:=",ExpressionUUID->"652aceeb-f953-448e-8de4-4f039d8daf89"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "sYield"}], " ", "t"}], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "intRate"}], "+", 
         SuperscriptBox["sVol", "2"], "-", 
         RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        FractionBox["bHigh", "sUnd"], "]"}]}], 
      SuperscriptBox["sVol", "2"]]}]], " ", "sUnd", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "-", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["bHigh", "sUnd"], ")"}], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], 
         SuperscriptBox["sVol", "2"]]}]], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "-", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["bHigh", "sUnd"], ")"}], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "-", 
          RowBox[{"2", " ", "sYield"}]}], 
         SuperscriptBox["sVol", "2"]]}]], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "-", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"2", " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "-", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}]}], ")"}]}], "-", 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "intRate"}], " ", "t"}]], " ", "strike", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["bHigh", "sUnd"], ")"}], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "+", 
          RowBox[{"2", " ", "sYield"}]}], 
         SuperscriptBox["sVol", "2"]]}]], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "+", 
                RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "+", 
                RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}], "-", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "+", 
                RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"intRate", "-", 
                FractionBox[
                 SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
              " ", "t"}], "-", 
             RowBox[{"Log", "[", 
              FractionBox["strike", "sUnd"], "]"}]}], 
            RowBox[{"sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox["bHigh", "sUnd"], ")"}], 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "intRate"}], "+", 
          SuperscriptBox["sVol", "2"], "+", 
          RowBox[{"2", " ", "sYield"}]}], 
         SuperscriptBox["sVol", "2"]]}]], " ", 
      RowBox[{"Erfc", "[", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{"Min", "[", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                SuperscriptBox["sVol", "2"], "+", 
                RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
             RowBox[{"4", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]], ",", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate", " ", "t"}], "-", 
             RowBox[{
              SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
             RowBox[{"2", " ", "sYield", " ", "t"}], "+", 
             RowBox[{"4", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "sUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}]}], 
            RowBox[{"2", " ", "sVol", " ", 
             SqrtBox["t"]}]]}], "]"}], 
         SqrtBox["2"]]}], "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7371037047894773`*^9, 3.7371044510424895`*^9, 3.7371045131649885`*^9, {
   3.737104550578907*^9, 3.7371045573080683`*^9}},
 CellLabel->"Out[50]=",ExpressionUUID->"0ded9d72-5187-4157-8605-9a96bc80af0e"]
}, Open  ]],

Cell["Easy bits: lim bHigh\[Rule]\[Infinity], bLow\[Rule]-\[Infinity] ", \
"Text",
 CellChangeTimes->{{3.7371048969357443`*^9, 
  3.7371049495065746`*^9}},ExpressionUUID->"7ba32886-e769-45e3-9172-\
c07150e64d8c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"callIter1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "sYield"}], " ", "t"}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "intRate"}], "+", 
            SuperscriptBox["sVol", "2"], "-", 
            RowBox[{"2", " ", "sYield"}]}], ")"}], " ", 
          RowBox[{"Log", "[", 
           FractionBox["bHigh", "sUnd"], "]"}]}], 
         SuperscriptBox["sVol", "2"]]}]], " ", "sUnd", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "intRate"}], "+", 
                  SuperscriptBox["sVol", "2"], "-", 
                  RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["bHigh", "sUnd"], ")"}], 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate"}], "+", 
             SuperscriptBox["sVol", "2"], "-", 
             RowBox[{"2", " ", "sYield"}]}], 
            SuperscriptBox["sVol", "2"]]}]], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{"2", " ", "intRate", " ", "t"}], "+", 
              RowBox[{
               SuperscriptBox["sVol", "2"], " ", "t"}], "-", 
              RowBox[{"2", " ", "sYield", " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["strike", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["bHigh", "sUnd"], ")"}], 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"2", " ", "intRate"}], "+", 
             SuperscriptBox["sVol", "2"], "-", 
             RowBox[{"2", " ", "sYield"}]}], 
            SuperscriptBox["sVol", "2"]]}]], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "intRate"}], "+", 
                  SuperscriptBox["sVol", "2"], "-", 
                  RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "intRate"}], "+", 
                  SuperscriptBox["sVol", "2"], "-", 
                  RowBox[{"2", " ", "sYield"}]}], ")"}]}], " ", "t"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "intRate"}], " ", "t"}]], " ", "strike", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          FractionBox["1", "2"]}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["bHigh", "sUnd"], ")"}], 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "intRate"}], "+", 
             SuperscriptBox["sVol", "2"], "+", 
             RowBox[{"2", " ", "sYield"}]}], 
            SuperscriptBox["sVol", "2"]]}]], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "+", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"intRate", "-", 
                 FractionBox[
                  SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], 
               " ", "t"}], "-", 
              RowBox[{"Log", "[", 
               FractionBox["strike", "sUnd"], "]"}]}], 
             RowBox[{"sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "+", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}], "+", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["bHigh", "sUnd"], ")"}], 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "intRate"}], "+", 
             SuperscriptBox["sVol", "2"], "+", 
             RowBox[{"2", " ", "sYield"}]}], 
            SuperscriptBox["sVol", "2"]]}]], " ", 
         RowBox[{"Erfc", "[", 
          RowBox[{"-", 
           FractionBox[
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", "intRate"}], "+", 
                 SuperscriptBox["sVol", "2"], "+", 
                 RowBox[{"2", " ", "sYield"}]}], ")"}], " ", "t"}], "-", 
              RowBox[{"4", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "sUnd"], "]"}]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "sUnd"], "]"}]}]}], 
             RowBox[{"2", " ", "sVol", " ", 
              SqrtBox["t"]}]], 
            SqrtBox["2"]]}], "]"}]}]}], ")"}]}]}], " ", "//", "Simplify"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.737104951246575*^9, 3.7371049685115747`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"44f307d8-288f-4142-bb84-01c6dd2dee64"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Haug", "Chapter",
 CellChangeTimes->{{3.737116603530443*^9, 
  3.737116605963687*^9}},ExpressionUUID->"ae2c5ecb-5077-469c-bcc8-\
a7808b0a5256"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<BarrierDownOut\>\"", ",", "\"\<European\>\"", ",", "\"\<Call\>\""}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<Barrier\>\"", "\[Rule]", "95"}], ",", " ", 
     RowBox[{"\"\<Rebate\>\"", "\[Rule]", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.04"}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.737116949306018*^9, 3.7371170083429203`*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"708fa8f3-50c6-49ad-adfd-6161501c1a03"],

Cell[BoxData["9.02456769496686`"], "Output",
 CellChangeTimes->{{3.737116996199706*^9, 3.7371170091600027`*^9}},
 CellLabel->"Out[4]=",ExpressionUUID->"31a7a9e0-5a91-43bb-a920-103bf45aaa92"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<DoubleBarrierKnockOut\>\"", ",", "\"\<European\>\"", ",", 
     "\"\<Call\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.25"}], ",", 
     RowBox[{"\"\<Barriers\>\"", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"50", ",", "150"}], "}"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.0"}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.15"}], ",", 
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.1"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.737116744085498*^9, 3.737116812876376*^9}, 
   3.7371171066017456`*^9, {3.737117157229808*^9, 3.7371171648375683`*^9}, {
   3.7371754015403805`*^9, 3.7371754019203844`*^9}, {3.737176578277853*^9, 
   3.7371766042216387`*^9}, 3.737176682874408*^9, 3.737177950200905*^9, {
   3.7371784409603195`*^9, 3.737178484106896*^9}, 3.7371787938234434`*^9},
 CellLabel->"In[27]:=",ExpressionUUID->"1a76356c-eacc-411d-906b-f9f8bcad9a58"],

Cell[BoxData["4.354015543446484`"], "Output",
 CellChangeTimes->{
  3.7371167410781965`*^9, {3.7371167890009885`*^9, 3.7371168141034985`*^9}, 
   3.7371170739884844`*^9, 3.737117107886874*^9, {3.7371171593780227`*^9, 
   3.7371171652416086`*^9}, 3.7371754179965987`*^9, {3.737176579358972*^9, 
   3.7371766046286592`*^9}, 3.737176683839458*^9, 3.7371779541839848`*^9, {
   3.737178441561328*^9, 3.7371784849449067`*^9}, 3.7371787943444486`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"0ad4f549-0f44-42bf-b8a0-740fcddec9a1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.0", ",", "0.15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.0", ",", "0.15"}], "}"}], ",", "0.999", ",", "0.1",
    ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]], ",", "0.25", ",", "50", ",", "150"}], "}"}], ",", 
   "100", ",", "0.25", ",", "0.25", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7371758130759907`*^9, 3.7371759425206738`*^9}, {
  3.7371787659531593`*^9, 3.7371787690141897`*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"7c680ba6-93b6-47e1-8644-560067213f4a"],

Cell[BoxData["4.351472448954723`"], "Output",
 CellChangeTimes->{{3.7371758888139706`*^9, 3.73717594673973*^9}, 
   3.7371787734172344`*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"26603558-6a98-480c-87cf-ec4a9f0b0aac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Single", "Subchapter",
 CellChangeTimes->{{3.737180409019968*^9, 
  3.7371804108849897`*^9}},ExpressionUUID->"a483211a-9576-429f-af69-\
99df8911fda8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\BarrierOption\\\
\\TestData\\\\test_haug_single.csv\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7371185761886897`*^9, 3.7371186483469048`*^9}, {
   3.7371796625719304`*^9, 3.7371796902282143`*^9}, {3.7371804153500347`*^9, 
   3.7371804170400515`*^9}, 3.7372611717101192`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"c8e4f34d-d364-4a69-b700-bfa7b4241147"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "\"\<uo\>\""}], " ", 
       "&"}]}], "]"}], ",", " ", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"None", ",", " ", 
       RowBox[{"data", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.7531700305390615`*^9, 3.753170103526595*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"68f46aa2-de8c-4033-a787-b4695ad95583"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"call_put\"\>",
       HoldForm], 
      TagBox["\<\"type\"\>",
       HoldForm], 
      TagBox["\<\"S\"\>",
       HoldForm], 
      TagBox["\<\"X\"\>",
       HoldForm], 
      TagBox["\<\"B\"\>",
       HoldForm], 
      TagBox["\<\"sigma\"\>",
       HoldForm], 
      TagBox["\<\"T\"\>",
       HoldForm], 
      TagBox["\<\"r\"\>",
       HoldForm], 
      TagBox["\<\"b\"\>",
       HoldForm], 
      TagBox["\<\"rebate\"\>",
       HoldForm], 
      TagBox["\<\"value\"\>",
       HoldForm]},
     {"\<\"call\"\>", "\<\"uo\"\>", "100", "90", "105", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "2.6789`"},
     {"\<\"call\"\>", "\<\"uo\"\>", "100", "100", "105", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "2.358`"},
     {"\<\"call\"\>", "\<\"uo\"\>", "100", "110", "105", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "2.3453`"},
     {"\<\"call\"\>", "\<\"uo\"\>", "100", "90", "105", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "2.6341`"},
     {"\<\"call\"\>", "\<\"uo\"\>", "100", "100", "105", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "2.4389`"},
     {"\<\"call\"\>", "\<\"uo\"\>", "100", "110", "105", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "2.4315`"},
     {"\<\"put\"\>", "\<\"uo\"\>", "100", "90", "105", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "3.776`"},
     {"\<\"put\"\>", "\<\"uo\"\>", "100", "100", "105", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "5.4932`"},
     {"\<\"put\"\>", "\<\"uo\"\>", "100", "110", "105", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "7.5187`"},
     {"\<\"put\"\>", "\<\"uo\"\>", "100", "90", "105", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "4.2293`"},
     {"\<\"put\"\>", "\<\"uo\"\>", "100", "100", "105", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "5.8032`"},
     {"\<\"put\"\>", "\<\"uo\"\>", "100", "110", "105", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "7.5649`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {
     None, {"call_put", "type", "S", "X", "B", "sigma", "T", "r", "b", 
       "rebate", "value"}}]]]], "Output",
 CellChangeTimes->{{3.753170052842536*^9, 3.75317010416061*^9}},
 CellLabel->
  "Out[17]//TableForm=",ExpressionUUID->"e9956020-272e-409b-b13b-\
e45f7d848f2d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<BarrierUpOut\>\"", ",", "\"\<European\>\"", ",", "\"\<Call\>\""}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<Barrier\>\"", "\[Rule]", "105"}], ",", " ", 
     RowBox[{"\"\<Rebate\>\"", "\[Rule]", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
      RowBox[{"0.08", "-", "0.04"}]}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7531701600907774`*^9, 3.75317019871457*^9}, {
   3.753170274220154*^9, 3.753170275545181*^9}, 3.753170485744507*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"7104f533-16dd-4455-9a40-020f15223ba2"],

Cell[BoxData["2.6789125048400995`"], "Output",
 CellChangeTimes->{3.753170200303602*^9, 3.7531702783182364`*^9, 
  3.753170486981544*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"9fd88826-20a1-4b91-854c-ee47fb9f36d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<BarrierUpOut\>\"", ",", "\"\<European\>\"", ",", "\"\<Call\>\""}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<Barrier\>\"", "\[Rule]", "105"}], ",", " ", 
     RowBox[{"\"\<Rebate\>\"", "\[Rule]", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0."}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.7531705078219833`*^9},
 CellLabel->"In[21]:=",ExpressionUUID->"4a600c88-c9da-4782-ab20-4ac597b795bd"],

Cell[BoxData["2.7408492772962045`"], "Output",
 CellChangeTimes->{3.753170508194991*^9},
 CellLabel->"Out[21]=",ExpressionUUID->"039e59c7-3034-42dd-b9c1-45e97d1f6401"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7371186699520645`*^9, 3.737118672563326*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"da7c7218-d8a4-40a9-9d80-0812ed67ceb2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"call_put\"\>", ",", "\<\"type\"\>", ",", "\<\"S\"\>", 
     ",", "\<\"X\"\>", ",", "\<\"B\"\>", ",", "\<\"sigma\"\>", 
     ",", "\<\"T\"\>", ",", "\<\"r\"\>", ",", "\<\"b\"\>", 
     ",", "\<\"rebate\"\>", ",", "\<\"value\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "9.0246`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.737118674576527*^9, 3.7371188209351616`*^9, 
  3.737119103719437*^9, 3.737180459360482*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"8306e0d9-7e74-45cd-bb8a-ff66304ae5fc"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Remove", "[", "checkSingle", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkSingle", "[", 
   RowBox[{
   "cp_", ",", " ", "type_", ",", " ", "s_", ",", " ", "x_", ",", " ", "b_", 
    ",", " ", "sigma_", ",", " ", "bigT_", ",", " ", "r_", ",", " ", "q_", 
    ",", " ", "rebate_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"callput", ",", "btype"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"callput", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"cp", "\[Equal]", "\"\<call\>\""}], ",", " ", "\"\<Call\>\"", 
        ",", " ", 
        RowBox[{"cp", "\[Equal]", "\"\<put\>\""}], ",", " ", "\"\<Put\>\"", 
        ",", " ", "True", ",", " ", "\"\<Error call_put\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"btype", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<do\>\""}], ",", " ", 
        "\"\<BarrierDownOut\>\"", ",", " ", 
        RowBox[{"type", "\[Equal]", "\"\<uo\>\""}], ",", " ", 
        "\"\<BarrierUpOut\>\"", ",", " ", 
        RowBox[{"type", "\[Equal]", "\"\<di\>\""}], ",", " ", 
        "\"\<BarrierDownIn\>\"", ",", " ", 
        RowBox[{"type", "\[Equal]", "\"\<ui\>\""}], ",", " ", 
        "\"\<BarrierUpIn\>\"", ",", " ", "True", ",", " ", 
        "\"\<Error type\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FinancialDerivative", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"btype", ",", "\"\<European\>\"", ",", "callput"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "x"}], ",", 
         RowBox[{"\"\<Expiration\>\"", "\[Rule]", "bigT"}], ",", 
         RowBox[{"\"\<Barrier\>\"", "\[Rule]", "b"}], ",", " ", 
         RowBox[{"\"\<Rebate\>\"", "\[Rule]", "rebate"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
         RowBox[{"\"\<Dividend\>\"", "\[Rule]", "q"}], ",", 
         RowBox[{"\"\<Volatility\>\"", "\[Rule]", "sigma"}], ",", 
         RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "r"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7371183359656696`*^9, 3.7371185708091516`*^9}, {
   3.737118660251095*^9, 3.7371188173558035`*^9}, {3.737118961194186*^9, 
   3.737118967254792*^9}, {3.737119012645331*^9, 3.7371190164037066`*^9}, 
   3.7371191385229173`*^9, {3.737119281813245*^9, 3.7371193454266057`*^9}, {
   3.737180425684141*^9, 3.737180430576191*^9}},
 CellLabel->"In[35]:=",ExpressionUUID->"fa85c89b-fc48-4ed8-a3d2-a9b0e579772e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "#"}], ",", " ", 
      RowBox[{
       RowBox[{"checkSingle", "[", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"1", ";;", "8"}], "]"}], "]"}], ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "8", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "9", "]"}], "]"}]}], "}"}], ",", " ", 
           RowBox[{"#", "[", 
            RowBox[{"[", 
             RowBox[{"10", ";;", "10"}], "]"}], "]"}]}], "]"}]}], "]"}], "-", 
       RowBox[{"#", "[", 
        RowBox[{"[", "11", "]"}], "]"}]}]}], "}"}], " ", "&"}], " ", "/@", 
   " ", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"2", ";;"}], "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", " ", 
       RowBox[{"#", "[", 
        RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}]}], " ", "//", 
  "TableForm"}]], "Input",
 CellChangeTimes->{{3.7371188319232607`*^9, 3.737118869904058*^9}, 
   3.7371189763347*^9, {3.7371193523863015`*^9, 3.737119363292392*^9}, {
   3.7371195355626173`*^9, 3.737119570059067*^9}, {3.737119711026162*^9, 
   3.737119713648424*^9}, {3.737174390942609*^9, 3.737174447447363*^9}, {
   3.737175298880949*^9, 3.737175301102976*^9}, {3.7371804735456324`*^9, 
   3.7371806205251317`*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"dd72d362-d078-48d6-bed7-1139aa12be8f"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"call\"\>", "\<\"do\"\>", "100", "90", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "9.0246`", 
     RowBox[{"-", "0.00003230503313922384`"}]},
    {"\<\"call\"\>", "\<\"do\"\>", "100", "100", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "6.7924`", "0.000036575025212037815`"},
    {"\<\"call\"\>", "\<\"do\"\>", "100", "110", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "4.8759`", 
     RowBox[{"-", "0.000042259852396142605`"}]},
    {"\<\"call\"\>", "\<\"uo\"\>", "100", "90", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "2.6789`", "0.000012504840099403225`"},
    {"\<\"call\"\>", "\<\"uo\"\>", "100", "100", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "2.358`", "0.00001979084405068221`"},
    {"\<\"call\"\>", "\<\"uo\"\>", "100", "110", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "2.3453`", "0.000048946386963510946`"},
    {"\<\"call\"\>", "\<\"do\"\>", "100", "90", "95", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "8.8334`", 
     RowBox[{"-", "0.00004207133171263422`"}]},
    {"\<\"call\"\>", "\<\"do\"\>", "100", "100", "95", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "7.0285`", "0.00004022167642769858`"},
    {"\<\"call\"\>", "\<\"do\"\>", "100", "110", "95", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "5.4137`", 
     RowBox[{"-", "2.0367046715819015`*^-8"}]},
    {"\<\"call\"\>", "\<\"uo\"\>", "100", "90", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "2.6341`", 
     RowBox[{"-", "0.00005804866539138587`"}]},
    {"\<\"call\"\>", "\<\"uo\"\>", "100", "100", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "2.4389`", "0.0000418850581400676`"},
    {"\<\"call\"\>", "\<\"uo\"\>", "100", "110", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "2.4315`", "0.000032678555585086144`"},
    {"\<\"put\"\>", "\<\"do\"\>", "100", "90", "95", "0.25`", "0.5`", "0.08`",
      "0.04`", "3", "2.2798`", "0.00003796720153559363`"},
    {"\<\"put\"\>", "\<\"do\"\>", "100", "100", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "2.2947`", "0.00004963334309637801`"},
    {"\<\"put\"\>", "\<\"do\"\>", "100", "110", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "2.6252`", "0.000013584548687273212`"},
    {"\<\"put\"\>", "\<\"uo\"\>", "100", "90", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "3.776`", 
     RowBox[{"-", "0.00004486783024360008`"}]},
    {"\<\"put\"\>", "\<\"uo\"\>", "100", "100", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "5.4932`", "0.00002767237194056804`"},
    {"\<\"put\"\>", "\<\"uo\"\>", "100", "110", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "7.5187`", "0.000022082113086518973`"},
    {"\<\"put\"\>", "\<\"do\"\>", "100", "90", "95", "0.3`", "0.5`", "0.08`", 
     "0.04`", "3", "2.417`", 
     RowBox[{"-", "9.663499017875665`*^-6"}]},
    {"\<\"put\"\>", "\<\"do\"\>", "100", "100", "95", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "2.4258`", "9.855777272083088`*^-6"},
    {"\<\"put\"\>", "\<\"do\"\>", "100", "110", "95", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "2.6246`", "6.8400019328507256`*^-6"},
    {"\<\"put\"\>", "\<\"uo\"\>", "100", "90", "105", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "4.2293`", 
     RowBox[{"-", "0.00006253475981132794`"}]},
    {"\<\"put\"\>", "\<\"uo\"\>", "100", "100", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "5.8032`", "0.00005200629670731871`"},
    {"\<\"put\"\>", "\<\"uo\"\>", "100", "110", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "7.5649`", "0.00005740712712665186`"},
    {"\<\"call\"\>", "\<\"di\"\>", "100", "90", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "7.7627`", 
     RowBox[{"-", "0.00002979014364878907`"}]},
    {"\<\"call\"\>", "\<\"di\"\>", "100", "100", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "4.0109`", "0.000041850449069791296`"},
    {"\<\"call\"\>", "\<\"di\"\>", "100", "110", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "2.0576`", "0.00001275272826228857`"},
    {"\<\"call\"\>", "\<\"ui\"\>", "100", "90", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "14.1112`", 
     RowBox[{"-", "0.000026880396950090812`"}]},
    {"\<\"call\"\>", "\<\"ui\"\>", "100", "100", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "8.4482`", "6.354250169593456`*^-6"},
    {"\<\"call\"\>", "\<\"ui\"\>", "100", "110", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "4.591`", 
     RowBox[{"-", "0.00003073389115915148`"}]},
    {"\<\"call\"\>", "\<\"di\"\>", "100", "90", "95", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "9.0093`", "0.00004438068190637523`"},
    {"\<\"call\"\>", "\<\"di\"\>", "100", "100", "95", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "5.137`", "0.00003858287795655002`"},
    {"\<\"call\"\>", "\<\"di\"\>", "100", "110", "95", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "2.8517`", 
     RowBox[{"-", "0.000017215073472520714`"}]},
    {"\<\"call\"\>", "\<\"ui\"\>", "100", "90", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "15.2098`", "0.00004591438963963412`"},
    {"\<\"call\"\>", "\<\"ui\"\>", "100", "100", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "9.7278`", "0.00002247587029913234`"},
    {"\<\"call\"\>", "\<\"ui\"\>", "100", "110", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "5.835`", "0.000035642377952171955`"},
    {"\<\"put\"\>", "\<\"di\"\>", "100", "90", "95", "0.25`", "0.5`", "0.08`",
      "0.04`", "3", "2.9586`", 
     RowBox[{"-", "0.000017869344757670547`"}]},
    {"\<\"put\"\>", "\<\"di\"\>", "100", "100", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "6.5677`", "5.376687983726924`*^-6"},
    {"\<\"put\"\>", "\<\"di\"\>", "100", "110", "95", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "11.9752`", "0.00002788440720280505`"},
    {"\<\"put\"\>", "\<\"ui\"\>", "100", "90", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "1.4653`", "0.000012685306960191767`"},
    {"\<\"put\"\>", "\<\"ui\"\>", "100", "100", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "3.3721`", 
     RowBox[{"-", "0.000024942720922016548`"}]},
    {"\<\"put\"\>", "\<\"ui\"\>", "100", "110", "105", "0.25`", "0.5`", 
     "0.08`", "0.04`", "3", "7.0846`", 
     RowBox[{"-", "0.00003289353725932642`"}]},
    {"\<\"put\"\>", "\<\"di\"\>", "100", "90", "95", "0.3`", "0.5`", "0.08`", 
     "0.04`", "3", "3.8769`", 
     RowBox[{"-", "5.834117236425129`*^-6"}]},
    {"\<\"put\"\>", "\<\"di\"\>", "100", "100", "95", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "7.7989`", 
     RowBox[{"-", "0.0000544666660893256`"}]},
    {"\<\"put\"\>", "\<\"di\"\>", "100", "110", "95", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "13.3078`", 
     RowBox[{"-", "0.000053099362421704654`"}]},
    {"\<\"put\"\>", "\<\"ui\"\>", "100", "90", "105", "0.3`", "0.5`", "0.08`",
      "0.04`", "3", "2.0658`", "0.00003259351761331075`"},
    {"\<\"put\"\>", "\<\"ui\"\>", "100", "100", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "4.4226`", 
     RowBox[{"-", "0.000011060811468510678`"}]},
    {"\<\"put\"\>", "\<\"ui\"\>", "100", "110", "105", "0.3`", "0.5`", 
     "0.08`", "0.04`", "3", "8.3686`", 
     RowBox[{"-", "0.000018110113559899332`"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.737118875039572*^9, {3.737118972182285*^9, 3.737118984445511*^9}, {
   3.737119355127576*^9, 3.7371193641584787`*^9}, {3.737119563013362*^9, 
   3.7371195712491856`*^9}, 3.737119714282488*^9, 3.737174315497595*^9, {
   3.737174373427373*^9, 3.737174395624671*^9}, {3.737174430074129*^9, 
   3.7371744487453814`*^9}, 3.7371753023119917`*^9, {3.7371806105190315`*^9, 
   3.737180621135138*^9}},
 CellLabel->
  "Out[38]//TableForm=",ExpressionUUID->"88f00d60-04f8-44f0-99d9-\
4ad4bb5db2be"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Double", "Subchapter",
 CellChangeTimes->{{3.737180409019968*^9, 3.7371804108849897`*^9}, {
  3.737180657452507*^9, 
  3.7371806584835176`*^9}},ExpressionUUID->"a7776c9e-cd50-4f13-a282-\
d14f74c2a80c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\BarrierOption\\\
\\TestData\\\\test_haug_double.csv\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7371185761886897`*^9, 3.7371186483469048`*^9}, {
   3.7371796625719304`*^9, 3.7371796902282143`*^9}, {3.7371804153500347`*^9, 
   3.7371804170400515`*^9}, {3.737180662495558*^9, 3.7371806636165695`*^9}, 
   3.7372611784372015`*^9},ExpressionUUID->"c095c85d-ec8d-4d5a-a336-\
1c72c6530838"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7371186699520645`*^9, 3.737118672563326*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"505fd470-72e3-42cb-b7b2-c2f473a8dbd4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"call_put\"\>", ",", "\<\"type\"\>", ",", "\<\"S\"\>", 
     ",", "\<\"X\"\>", ",", "\<\"L\"\>", ",", "\<\"H\"\>", 
     ",", "\<\"sigma\"\>", ",", "\<\"T\"\>", ",", "\<\"r\"\>", 
     ",", "\<\"b\"\>", ",", "\<\"rebate\"\>", ",", "\<\"value\"\>"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uodo\"\>", ",", "100", ",", "100", ",", 
     "50", ",", "150", ",", "0.15`", ",", "0.25`", ",", "0.1`", ",", "0.1`", 
     ",", "0", ",", "4.3515`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.737118674576527*^9, 3.7371188209351616`*^9, 
  3.737119103719437*^9, 3.737180459360482*^9, 3.737180666988604*^9},
 CellLabel->"Out[40]=",ExpressionUUID->"1777beec-95e8-4754-8e88-61527aad2edf"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Remove", "[", "checkDouble", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkDouble", "[", 
   RowBox[{
   "cp_", ",", " ", "type_", ",", " ", "s_", ",", " ", "x_", ",", " ", "low_",
     ",", " ", "high_", ",", " ", "sigma_", ",", " ", "bigT_", ",", " ", "r_",
     ",", " ", "q_", ",", " ", "rebate_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"callput", ",", "btype"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"callput", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"cp", "\[Equal]", "\"\<call\>\""}], ",", " ", "\"\<Call\>\"", 
        ",", " ", 
        RowBox[{"cp", "\[Equal]", "\"\<put\>\""}], ",", " ", "\"\<Put\>\"", 
        ",", " ", "True", ",", " ", "\"\<Error call_put\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"btype", "=", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"type", "\[Equal]", "\"\<uodo\>\""}], ",", " ", 
        "\"\<DoubleBarrierKnockOut\>\"", ",", "True", ",", " ", 
        "\"\<Error type\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"FinancialDerivative", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"btype", ",", "\"\<European\>\"", ",", "callput"}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "x"}], ",", 
         RowBox[{"\"\<Expiration\>\"", "\[Rule]", "bigT"}], ",", 
         RowBox[{"\"\<Barriers\>\"", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"low", ",", " ", "high"}], "}"}]}], ",", " ", 
         RowBox[{"\"\<Rebate\>\"", "\[Rule]", "rebate"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
         RowBox[{"\"\<Dividend\>\"", "\[Rule]", "q"}], ",", 
         RowBox[{"\"\<Volatility\>\"", "\[Rule]", "sigma"}], ",", 
         RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "r"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.7371183359656696`*^9, 3.7371185708091516`*^9}, {
   3.737118660251095*^9, 3.7371188173558035`*^9}, {3.737118961194186*^9, 
   3.737118967254792*^9}, {3.737119012645331*^9, 3.7371190164037066`*^9}, 
   3.7371191385229173`*^9, {3.737119281813245*^9, 3.7371193454266057`*^9}, {
   3.737180425684141*^9, 3.737180430576191*^9}, {3.7371806706246405`*^9, 
   3.7371807668066196`*^9}, {3.737180874736725*^9, 3.737180893946921*^9}, {
   3.737180952273525*^9, 3.7371809756627655`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"30a9c667-93b9-4c58-bfb8-0d1787883572"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "#"}], ",", 
      RowBox[{"1", "-", " ", 
       RowBox[{
        RowBox[{"checkDouble", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "9"}], "]"}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "9", "]"}], "]"}], "-", 
              RowBox[{"#", "[", 
               RowBox[{"[", "10", "]"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"11", ";;", "11"}], "]"}], "]"}]}], "]"}]}], "]"}], "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "12", "]"}], "]"}]}]}]}], "}"}], " ", "&"}], " ", "/@", 
   " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;"}], "]"}], "]"}]}], " ", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.7371188319232607`*^9, 3.737118869904058*^9}, 
   3.7371189763347*^9, {3.7371193523863015`*^9, 3.737119363292392*^9}, {
   3.7371195355626173`*^9, 3.737119570059067*^9}, {3.737119711026162*^9, 
   3.737119713648424*^9}, {3.737174390942609*^9, 3.737174447447363*^9}, {
   3.737175298880949*^9, 3.737175301102976*^9}, {3.7371804735456324`*^9, 
   3.7371806205251317`*^9}, {3.7371807706506596`*^9, 
   3.7371807836107917`*^9}, {3.7371808142961054`*^9, 3.737180835375326*^9}, {
   3.7371809113220987`*^9, 3.7371809150991373`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"b202a751-1fad-426b-8ec0-c92d9c97b678"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "4.3515`", 
     RowBox[{"-", "0.0005780865095907917`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "4.3505`", 
     RowBox[{"-", "0.00018713771217759856`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "4.3139`", "0.000368993986433086`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "3.7516`", "0.00011951456753567236`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "1.2055`", 
     RowBox[{"-", "0.0006505319491085793`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "6.1644`", 
     RowBox[{"-", "0.00014835450046746246`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "5.85`", "0.00009708149581055814`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "4.8293`", "0.0003904194943286088`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "2.6387`", "0.0001408513611146356`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "0.3098`", 
     RowBox[{"-", "0.032438332682708015`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "7.0373`", "0.00012326571301446432`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "5.7726`", "0.00021304611711336907`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "3.7765`", "0.0003040180583155916`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "1.4903`", 
     RowBox[{"-", "0.0006318927351671721`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "0.0477`", 
     RowBox[{"-", "0.4577756885962809`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "6.9853`", 
     RowBox[{"-", "0.000161284202012002`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "6.8082`", "0.00009865559662536327`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "5.9697`", "0.00041687362942677275`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "3.5805`", "0.00024673509253470005`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "0.5537`", 
     RowBox[{"-", "0.009567720398127033`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "7.9336`", "0.00020844322796376158`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "6.3383`", "0.0002651347820026295`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "4.0004`", "0.0003149437723308779`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "1.5098`", 
     RowBox[{"-", "0.0006223036576009644`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "0.0441`", 
     RowBox[{"-", "0.4823007435754274`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "6.5088`", "0.00027883942974959997`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "4.3841`", "0.0002557456603275998`"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "2.2563`", 
     RowBox[{"-", "0.001981393966460132`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "0.5635`", 
     RowBox[{"-", "0.011108881834988704`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "0.0011`", 
     RowBox[{"-", "34.13500765714668`"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.737118875039572*^9, {3.737118972182285*^9, 3.737118984445511*^9}, {
   3.737119355127576*^9, 3.7371193641584787`*^9}, {3.737119563013362*^9, 
   3.7371195712491856`*^9}, 3.737119714282488*^9, 3.737174315497595*^9, {
   3.737174373427373*^9, 3.737174395624671*^9}, {3.737174430074129*^9, 
   3.7371744487453814`*^9}, 3.7371753023119917`*^9, {3.7371806105190315`*^9, 
   3.737180621135138*^9}, {3.73718082237819*^9, 3.7371808490784655`*^9}, {
   3.7371808862158422`*^9, 3.737180918452171*^9}, {3.7371809710087185`*^9, 
   3.7371809771437807`*^9}},
 CellLabel->
  "Out[60]//TableForm=",ExpressionUUID->"4940d2ed-3d59-4bbb-80e1-\
6f8ce5b52c6d"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Atom", "Subchapter",
 CellChangeTimes->{{3.737180409019968*^9, 3.7371804108849897`*^9}, {
  3.737180657452507*^9, 3.7371806584835176`*^9}, {3.7371821077222347`*^9, 
  3.7371821084892435`*^9}},ExpressionUUID->"3f24a35c-9c79-482e-8a2e-\
13c9861584b1"],

Cell[CellGroupData[{

Cell["Double", "Section",
 CellChangeTimes->{{3.737182122591421*^9, 
  3.7371821236414347`*^9}},ExpressionUUID->"986906c2-8110-4a5a-9851-\
2663824f0ce5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\BarrierOption\\\
\\TestData\\\\test_haug_double.csv\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{
  3.737261162783992*^9},ExpressionUUID->"e8b4f73b-f52d-470a-96cc-\
31584928e26a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"data", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.737181421674285*^9, 3.7371814240253143`*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"97ba69df-d7fb-4d12-8ff0-dfe363f7b8ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"call_put\"\>", ",", "\<\"type\"\>", ",", "\<\"S\"\>", 
     ",", "\<\"X\"\>", ",", "\<\"L\"\>", ",", "\<\"H\"\>", 
     ",", "\<\"sigma\"\>", ",", "\<\"T\"\>", ",", "\<\"r\"\>", 
     ",", "\<\"b\"\>", ",", "\<\"rebate\"\>", ",", "\<\"value\"\>"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uodo\"\>", ",", "100", ",", "100", ",", 
     "50", ",", "150", ",", "0.15`", ",", "0.25`", ",", "0.1`", ",", "0.1`", 
     ",", "0", ",", "4.3515`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7371814243823204`*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"cf557779-becf-4c67-b0d7-ab634f490b74"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp_", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd_", ",", "sYield_", ",", "sVol_"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd_", ",", "bYield_", ",", "bVol_"}], "}"}], ",", "corr_", ",",
    "intRate_", ",", 
   RowBox[{"{", 
    RowBox[{"t1_", ",", "t2_", ",", "bLow_", ",", "bHigh_"}], "}"}], ",", 
   "strike_", ",", "t_", ",", "ts_", ",", 
   RowBox[{"{", 
    RowBox[{"nMin_", ",", "nMax_"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.737181409333108*^9, 
  3.737181409333108*^9}},ExpressionUUID->"bfab99e1-ff2f-41f3-85f7-\
aeb29263d1d7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Sequence", "@@", "#"}], ",", " ", 
      RowBox[{"1", "-", 
       RowBox[{
        RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<call\>\""}], 
            ",", " ", "1", ",", " ", 
            RowBox[{"-", "1"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "9", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "10", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "9", "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", "10", "]"}], "]"}]}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], "}"}], ",", "0.999", ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "9", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "3"}]], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "8", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "5", "]"}], "]"}], ",", 
            RowBox[{"#", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], "}"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "8", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "5"}], ",", "5"}], "}"}]}], "]"}], "/", 
        RowBox[{"#", "[", 
         RowBox[{"[", "12", "]"}], "]"}]}]}]}], "}"}], " ", "&"}], " ", "/@", 
   " ", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;"}], "]"}], "]"}]}], " ", "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.7371814560687304`*^9, 3.737181635383154*^9}, {
  3.737181796220351*^9, 3.737181825503746*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"103d220c-9960-4c1e-bbf2-269cf08bba39"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"2.767355128233234`*^-212\\\", \\\" \\\", \
\\\"7.809261160236338`*^-110\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,64,20,
   25821889691293306475,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7371816183079257`*^9, 3.7371816536544113`*^9, 
  3.737181843774977*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"41d62634-022e-4051-b204-1cd22dd5b73c"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"2.8379258133410552`*^-211\\\", \\\" \\\", \
\\\"8.678751521613502`*^-110\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,64,21,
   25821889691293306475,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7371816183079257`*^9, 3.7371816536544113`*^9, 
  3.7371818479600296`*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"f6253755-6e62-4f2f-8bf4-bfaddc09cb04"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{RowBox[{\\\"-\\\", \
\\\"1.6904789991171146`*^-297\\\"}], \\\"+\\\", \\\"1.6904789991019537`*^-297\
\\\"}]\\) is too small to represent as a normalized machine number; precision \
may be lost.\"",2,64,22,25821889691293306475,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7371816183079257`*^9, 3.7371816536544113`*^9, 
  3.737181856355139*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"0c00921a-ee5c-4ac9-ae8f-df28ceaffa0e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,64,23,25821889691293306475,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7371816183079257`*^9, 3.7371816536544113`*^9, 
  3.73718185640514*^9},
 CellLabel->
  "During evaluation of \
In[64]:=",ExpressionUUID->"1aaa8c96-87b2-4d15-8ed8-214c2c3c8626"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "4.3515`", "6.3313903887474154`*^-6"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "4.3505`", "9.830394065768466`*^-6"},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "4.3139`", 
     RowBox[{"-", "3.982033624838621`*^-6"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "3.7516`", 
     RowBox[{"-", "0.00014991260060037703`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.15`", 
     "0.25`", "0.1`", "0.1`", "0", "1.2055`", 
     RowBox[{"-", "0.0018943059207292556`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "6.1644`", 
     RowBox[{"-", "0.000025146271751541605`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "5.85`", 
     RowBox[{"-", "0.00007766178529755585`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "4.8293`", 
     RowBox[{"-", "0.00030115483259218756`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "2.6387`", 
     RowBox[{"-", "0.0012462660208401033`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.25`", 
     "0.25`", "0.1`", "0.1`", "0", "0.3098`", 
     RowBox[{"-", "0.0071043862752500075`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "7.0373`", 
     RowBox[{"-", "0.00017909088577394705`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "5.7726`", 
     RowBox[{"-", "0.00044250373622234385`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "3.7765`", 
     RowBox[{"-", "0.0011328651192745731`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "1.4903`", 
     RowBox[{"-", "0.003421724303877216`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.35`", 
     "0.25`", "0.1`", "0.1`", "0", "0.0477`", 
     RowBox[{"-", "0.015503104490514952`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "6.9853`", 
     RowBox[{"-", "1.920643038388903`*^-6"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "6.8082`", 
     RowBox[{"-", "0.000039689806755616175`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "5.9697`", 
     RowBox[{"-", "0.0001692341798991137`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "3.5805`", 
     RowBox[{"-", "0.0007520052415408429`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.15`", 
     "0.5`", "0.1`", "0.1`", "0", "0.5537`", 
     RowBox[{"-", "0.0048623766118316425`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "7.9336`", 
     RowBox[{"-", "0.0002135595964842807`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "6.3383`", 
     RowBox[{"-", "0.0005044126297817364`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "4.0004`", 
     RowBox[{"-", "0.0012378518687861106`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "1.5098`", 
     RowBox[{"-", "0.0036054653016317495`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.25`", 
     "0.5`", "0.1`", "0.1`", "0", "0.0441`", 
     RowBox[{"-", "0.014630818711907745`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "50", "150", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "6.5088`", 
     RowBox[{"-", "0.0008930140692036126`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "60", "140", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "4.3841`", 
     RowBox[{"-", "0.0016589904357935392`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "70", "130", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "2.2563`", 
     RowBox[{"-", "0.0034600058289226965`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "80", "120", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "0.5635`", 
     RowBox[{"-", "0.008136941514812035`"}]},
    {"\<\"call\"\>", "\<\"uodo\"\>", "100", "100", "90", "110", "0.35`", 
     "0.5`", "0.1`", "0.1`", "0", "0.0011`", 
     RowBox[{"-", "0.02088496385981098`"}]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.737181788242241*^9, 3.737181981560892*^9},
 CellLabel->
  "Out[64]//TableForm=",ExpressionUUID->"6cd242e6-ef67-4780-86e8-\
0d488adcd3ba"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CompiledFunctionTools`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7371825951406317`*^9, 3.7371826034767437`*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"6443548f-2471-4ec6-b829-5e664d27ba10"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<CCodeGenerator`\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.737183104634714*^9, 3.7371831119447885`*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"66338571-49e5-4471-a981-00f9f36b3028"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FilePrint", "@", 
  RowBox[{"CCodeGenerate", "[", 
   RowBox[{
    RowBox[{"Compile", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"x", ",", " ", "_Real"}], "}"}], "}"}], ",", 
      RowBox[{
       RowBox[{"1", "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", "Pi"}], "]"}]}], " ", 
       RowBox[{"Exp", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "/", "2"}], 
         RowBox[{"x", "^", "2"}]}], "]"}]}], ",", " ", 
      RowBox[{"CompilationTarget", "\[Rule]", "\"\<C\>\""}], ",", " ", 
      RowBox[{"CompilationOptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\"\<InlineExternalDefinitions\>\"", "\[Rule]", "True"}], 
         ",", " ", 
         RowBox[{"\"\<ExpressionOptimization\>\"", " ", "\[Rule]", "True"}]}],
         "}"}]}]}], "]"}], ",", " ", "\"\<fun\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7371826084388056`*^9, 3.737182790350654*^9}, {
  3.7371828994960423`*^9, 3.7371829737097974`*^9}, {3.7371831532115893`*^9, 
  3.7371831699537616`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"9c879f77-4726-4269-8128-7e1542081e6d"],

Cell["\<\
#include \"math.h\"

#include \"WolframRTL.h\"

static WolframCompileLibrary_Functions funStructCompile;

static mint I0_0;

static mreal R0_1;

static mbool initialize = 1;

#include \"fun.h\"

DLLEXPORT int Initialize_fun(WolframLibraryData libData)
{
if( initialize)
{
funStructCompile = libData->compileLibraryFunctions;
R0_1 = (mreal) 3.141592653589793;
I0_0 = (mint) 2;
initialize = 0;
}
return 0;
}

DLLEXPORT void Uninitialize_fun(WolframLibraryData libData)
{
if( !initialize)
{
initialize = 1;
}
}

DLLEXPORT int fun(WolframLibraryData libData, mreal A1, mreal *Res)
{
mreal R0_0;
mreal R0_2;
mreal R0_3;
mreal R0_4;
R0_0 = A1;
R0_2 = (mreal) I0_0;
R0_2 = R0_2 * R0_1;
R0_3 = sqrt(R0_2);
R0_2 = 1 / R0_3;
R0_3 = (mreal) I0_0;
R0_4 = 1 / R0_3;
R0_3 = -R0_4;
R0_4 = R0_0 * R0_0;
R0_3 = R0_3 * R0_4;
R0_4 = exp(R0_3);
R0_2 = R0_2 * R0_4;
*Res = R0_2;
funStructCompile->WolframLibraryData_cleanUp(libData, 1);
return 0;
}
\
\>", "Print",
 CellChangeTimes->{3.7371831726357884`*^9},
 CellLabel->
  "During evaluation of \
In[78]:=",ExpressionUUID->"78506cf7-6370-4cf5-ad79-eadda2d044a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"QuantityMagnitude", "[", 
   RowBox[{"UnitConvert", "[", 
    RowBox[{
     RowBox[{"Quantity", "[", 
      RowBox[{"1", ",", " ", "\"\<Hours\>\""}], "]"}], ",", " ", 
     "\"\<Years\>\""}], "]"}], "]"}], "//", "N"}]], "Input",
 CellChangeTimes->{{3.73718388453845*^9, 3.737183934206106*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"e01d3fda-b18f-49b3-8abf-2e7c0943cca7"],

Cell[BoxData["0.00011415525114155251`"], "Output",
 CellChangeTimes->{{3.7371838952546005`*^9, 3.7371839348611145`*^9}},
 CellLabel->"Out[85]=",ExpressionUUID->"8cdba84b-e021-4efa-b199-a21112e32237"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Vanilla", "Section",
 CellChangeTimes->{{3.737182122591421*^9, 3.7371821236414347`*^9}, {
  3.7371843043083935`*^9, 
  3.7371843056184096`*^9}},ExpressionUUID->"9fcd4607-00b2-4728-946c-\
92b7d28c143f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\"\<European\>\"", ",", "\"\<Call\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "50.00"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.1"}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "50"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.05"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7371843526849265`*^9, 3.7371843526849265`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"9e938fa6-baac-4977-bb08-c718388a2b45"],

Cell[BoxData["10.364883181888587`"], "Output",
 CellChangeTimes->{3.737184354906949*^9},
 CellLabel->"Out[88]=",ExpressionUUID->"e6a79c55-ed15-481a-925a-b1646a4d9387"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"data", "=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"n", "=", "100"}], ",", " ", "s", ",", " ", "header"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"s", "=", 
        RowBox[{"RandomReal", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"50", ",", " ", "150"}], "}"}], ",", " ", "n"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"header", "=", 
        RowBox[{"{", 
         RowBox[{
         "\"\<call_put\>\"", ",", "\"\<type\>\"", ",", "\"\<S\>\"", ",", 
          "\"\<X\>\"", ",", "\"\<sigma\>\"", ",", "\"\<T\>\"", ",", 
          "\"\<intRate\>\"", ",", "\"\<yield\>\""}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"{", "header", "}"}], ",", 
         RowBox[{"Transpose", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"\"\<call\>\"", ",", " ", "\"\<put\>\""}], "}"}], ",", 
              " ", "n"}], "]"}], ",", " ", 
            RowBox[{"RandomChoice", "[", 
             RowBox[{
              RowBox[{"{", "\"\<vanilla\>\"", "}"}], ",", " ", "n"}], "]"}], 
            ",", " ", "s", ",", " ", 
            RowBox[{"s", "+", 
             RowBox[{"RandomReal", "[", 
              RowBox[{
               RowBox[{"UniformDistribution", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "4"}], ",", " ", "4"}], "}"}], "]"}], ",", " ",
                "n"}], "]"}]}], ",", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"-", "2"}]], ",", " ", "1"}], "}"}], "]"}], ",", 
              " ", "n"}], "]"}], ",", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"5", " ", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "3"}]]}], ",", " ", "1"}], "}"}], "]"}], ",", 
              " ", "n"}], "]"}], ",", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"-", "3"}]], ",", 
                 RowBox[{"5", " ", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "2"}]]}]}], "}"}], "]"}], ",", " ", "n"}], 
             "]"}], ",", " ", 
            RowBox[{"RandomReal", "[", 
             RowBox[{
              RowBox[{"UniformDistribution", "[", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["10", 
                  RowBox[{"-", "3"}]], ",", 
                 RowBox[{"5", " ", 
                  SuperscriptBox["10", 
                   RowBox[{"-", "2"}]]}]}], "}"}], "]"}], ",", " ", "n"}], 
             "]"}]}], "}"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.737184525851872*^9, 3.737184525931875*^9}, {
   3.737188643964188*^9, 3.737189043483533*^9}, 3.737189168551295*^9, {
   3.7371906823091545`*^9, 3.737190711602083*^9}, 3.7371907947543974`*^9, {
   3.7371990839936237`*^9, 
   3.737199185444605*^9}},ExpressionUUID->"0048650a-0e82-4f3d-830c-\
743cce357a8b"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"data", "[", 
     RowBox[{"[", 
      RowBox[{"2", ";;"}], "]"}], "]"}], ",", " ", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}], "]"}], "]"}], ",", " ", 
       RowBox[{"data", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.737190743689292*^9, 
  3.737190798269749*^9}},ExpressionUUID->"d1461f44-4d73-4275-bb4c-\
108a85373166"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\BarrierOption\\\
\\TestData\\\\test_vanilla.csv\>\"", ",", " ", "data"}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.737189045073551*^9, 3.737189065521838*^9}, {
   3.737189172034339*^9, 3.737189176714409*^9}, {3.7371907165365767`*^9, 
   3.7371907187037935`*^9}, 3.737190801836106*^9, {3.7371991769274282`*^9, 
   3.73719918936469*^9}},ExpressionUUID->"4f147626-d11b-420b-bb97-\
4055d24e2cbf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\BarrierOption\\\
\\TestData\\\\test_vanilla.csv\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737189155444129*^9, 3.7371891883895607`*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"0054ef68-d15c-481a-9b8b-b264287bf99c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", " ", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", " ", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", 
        RowBox[{"data", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.737189189710577*^9, 3.73718921362189*^9}, {
  3.7371892755976887`*^9, 3.7371893139751825`*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"127b1650-8ef0-4e16-a22b-8cbe1d53333d"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["1",
       HoldForm], 
      TagBox["2",
       HoldForm], 
      TagBox["3",
       HoldForm], 
      TagBox["4",
       HoldForm], 
      TagBox["5",
       HoldForm], 
      TagBox["6",
       HoldForm], 
      TagBox["7",
       HoldForm], 
      TagBox["8",
       HoldForm]},
     {"\<\"call_put\"\>", "\<\"type\"\>", "\<\"S\"\>", "\<\"X\"\>", \
"\<\"sigma\"\>", "\<\"T\"\>", "\<\"intRate\"\>", "\<\"yield\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, TableHeadings -> {None, {1, 2, 3, 4, 5, 6, 7, 8}}]]]], "Output",
 CellChangeTimes->{{3.737189194895643*^9, 3.737189213980895*^9}, {
   3.737189308278113*^9, 3.737189314265186*^9}, 3.7371936092555695`*^9, 
   3.73719802063389*^9},
 CellLabel->
  "Out[115]//TableForm=",ExpressionUUID->"34e90b2e-6f98-4078-bfcb-\
f5517fee3bfa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
       "\"\<call_put\>\"", ",", "\"\<type\>\"", ",", "\"\<S\>\"", ",", 
        "\"\<X\>\"", ",", "\"\<sigma\>\"", ",", "\"\<T\>\"", ",", 
        "\"\<intRate\>\"", ",", "\"\<yield\>\"", ",", " ", "\"\<uodo\>\"", 
        ",", " ", "\"\<bs\>\""}], "}"}], "}"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sequence", "@@", "#"}], ",", " ", 
         RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<call\>\""}], 
             ",", " ", "1", ",", " ", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "8", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "8", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "5", "]"}], "]"}]}], "}"}], ",", "0.999", ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "7", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "6", "]"}], "]"}], ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "4"}]], ",", 
             SuperscriptBox["10", "4"]}], "}"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "4", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}], ",", 
           RowBox[{"#", "[", 
            RowBox[{"[", "6", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"FinancialDerivative", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<European\>\"", ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "\"\<call\>\""}],
                ",", " ", "\"\<Call\>\"", ",", " ", "\"\<Put\>\""}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<Expiration\>\"", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "6", "]"}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<InterestRate\>\"", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "7", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<Volatility\>\"", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "5", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
              RowBox[{"#", "[", 
               RowBox[{"[", "8", "]"}], "]"}]}]}], "}"}]}], "]"}]}], "}"}], 
       " ", "&"}], " ", "/@", " ", 
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737189391464185*^9, 3.7371895084607286`*^9}, {
   3.73718966574284*^9, 3.7371898045327344`*^9}, {3.73719009090702*^9, 
   3.737190141842113*^9}, 3.7371902492968574`*^9, 3.737191285815591*^9, {
   3.7371924456097045`*^9, 3.7371924473087263`*^9}, {3.737193172376511*^9, 
   3.737193195774763*^9}, 3.7371951650541105`*^9, 3.737195207369543*^9, 
   3.7371970993784275`*^9, 3.7371997299116955`*^9, {3.7372003627218122`*^9, 
   3.7372003699909534`*^9}},
 CellLabel->
  "In[150]:=",ExpressionUUID->"185cb675-2727-458e-8a37-d9e1859def7f"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"1.0311980148186916`*^-304\\\", \\\" \\\", \
\\\"2.390793418646238`*^-50\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,150,124,
   25821985937876971461,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73719321512498*^9, 3.737198040270153*^9, 
  3.737198625296007*^9, 3.7371988582959776`*^9, 3.737199229820775*^9, 
  3.7371997723195*^9, 3.7372003750010433`*^9},
 CellLabel->
  "During evaluation of \
In[150]:=",ExpressionUUID->"6a282664-97b3-42ff-8caa-1ba272466bad"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"9.378704290007473`*^-295\\\", \\\" \\\", \
\\\"2.0887619213289924`*^-46\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,150,125,
   25821985937876971461,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73719321512498*^9, 3.737198040270153*^9, 
  3.737198625296007*^9, 3.7371988582959776`*^9, 3.737199229820775*^9, 
  3.7371997723195*^9, 3.7372003760150623`*^9},
 CellLabel->
  "During evaluation of \
In[150]:=",ExpressionUUID->"1f13b36e-8fe9-44a9-b3f3-def87777c477"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"1.987667878484569`*^-280\\\", \\\" \\\", \
\\\"4.977013602912388`*^-73\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,150,126,
   25821985937876971461,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73719321512498*^9, 3.737198040270153*^9, 
  3.737198625296007*^9, 3.7371988582959776`*^9, 3.737199229820775*^9, 
  3.7371997723195*^9, 3.7372003994336643`*^9},
 CellLabel->
  "During evaluation of \
In[150]:=",ExpressionUUID->"466f2a53-5c85-4950-bc4d-002085217b4c"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"General\\\", \
\\\"::\\\", \\\"munfl\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,150,127,25821985937876971461,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.73719321512498*^9, 3.737198040270153*^9, 
  3.737198625296007*^9, 3.7371988582959776`*^9, 3.737199229820775*^9, 
  3.7371997723195*^9, 3.7372003995006714`*^9},
 CellLabel->
  "During evaluation of \
In[150]:=",ExpressionUUID->"4502d45e-f727-474c-a725-2f8ac07a9420"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{"out", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;"}], "]"}], "]"}], ",", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "out", "]"}], "]"}], ",", " ", 
      RowBox[{"out", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.737189391464185*^9, 3.7371895084607286`*^9}, {
  3.73718966574284*^9, 3.7371898045327344`*^9}, {3.73719009090702*^9, 
  3.7371901390408325`*^9}, {3.737190213172245*^9, 3.737190241893117*^9}, {
  3.737194370751994*^9, 3.737194371683004*^9}},
 CellLabel->
  "In[156]:=",ExpressionUUID->"56018d72-de8c-45e1-92e0-c0a07a910233"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"call_put\"\>",
       HoldForm], 
      TagBox["\<\"type\"\>",
       HoldForm], 
      TagBox["\<\"S\"\>",
       HoldForm], 
      TagBox["\<\"X\"\>",
       HoldForm], 
      TagBox["\<\"sigma\"\>",
       HoldForm], 
      TagBox["\<\"T\"\>",
       HoldForm], 
      TagBox["\<\"intRate\"\>",
       HoldForm], 
      TagBox["\<\"yield\"\>",
       HoldForm], 
      TagBox["\<\"uodo\"\>",
       HoldForm], 
      TagBox["\<\"bs\"\>",
       HoldForm]},
     {
      TagBox["1",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "140.650229121872`", 
      "140.73094755005116`", "0.6826083229671067`", "0.927980662310788`", 
      "0.0011280315324247447`", "0.035242482912442655`", "37.92206023377135`",
       "37.922060233771376`"},
     {
      TagBox["2",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "112.69297562213475`", 
      "113.86882886544488`", "0.7226574324306492`", "0.4858819541225281`", 
      "0.006966260799626589`", "0.021788631403781428`", "21.394596705907375`",
       "21.39459670590739`"},
     {
      TagBox["3",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "109.3685579521713`", 
      "108.30202166547531`", "0.7613554610943967`", "0.6635532003596745`", 
      "0.013244244592387447`", "0.011602007253679422`", "25.701375902026804`",
       "25.701375902026804`"},
     {
      TagBox["4",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "85.09560771677678`", 
      "87.08207675608224`", "0.5140827794851142`", "0.2366354730056588`", 
      "0.04221017303192057`", "0.044479774971650884`", "9.522583189541166`", 
      "9.522583189541166`"},
     {
      TagBox["5",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "123.68031246513746`", 
      "120.26758241401924`", "0.44594032992310906`", "0.27447635718783125`", 
      "0.04432374962453044`", "0.010669582885662894`", "9.147558724483382`", 
      "9.147558724483382`"},
     {
      TagBox["6",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "83.33700629260824`", 
      "84.78892882755166`", "0.8393381621460134`", "0.7032368069071113`", 
      "0.010050898039964055`", "0.003004005398305268`", "23.538918150201226`",
       "23.538918150201233`"},
     {
      TagBox["7",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "149.1939236998431`", 
      "150.41759823500155`", "0.560167808789799`", "0.3778591997698817`", 
      "0.01719541029596708`", "0.030170465116331105`", "19.339625066396877`", 
      "19.339625066396877`"},
     {
      TagBox["8",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "58.00674903046644`", 
      "61.84627956101164`", "0.263959036729154`", "0.10672903133744116`", 
      "0.04375612714545875`", "0.008071558932928505`", "0.7367054192327984`", 
      "0.7367054192327984`"},
     {
      TagBox["9",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "91.53885304415189`", 
      "91.11963217943583`", "0.4489337621314362`", "0.8596168584316293`", 
      "0.03431666396535407`", "0.022317973453886017`", "14.039984026813123`", 
      "14.039984026813123`"},
     {
      TagBox["10",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "114.4410395940017`", 
      "110.47564091093554`", "0.1601130192743161`", "0.36061440672194967`", 
      "0.008020186353867594`", "0.04725547069254178`", "3.195905949370328`", 
      "3.195905949370321`"},
     {
      TagBox["11",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "107.88130991108682`", 
      "109.84749818995378`", "0.04685439504577937`", "0.8464222467931601`", 
      "0.01660419403839629`", "0.028531890650605712`", "0.7114201091026153`", 
      "0.7114201091026224`"},
     {
      TagBox["12",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "95.87383402307111`", 
      "99.76730850749573`", "0.15510766344973104`", "0.22348393205393413`", 
      "0.017017380613650185`", "0.004604844371678803`", "1.403438075511378`", 
      "1.4034380755113744`"},
     {
      TagBox["13",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "74.79154101530897`", 
      "74.02708986446676`", "0.6388612440044958`", "0.43675629672245164`", 
      "0.015580029007970397`", "0.03815123281424343`", "12.310773832349362`", 
      "12.310773832349366`"},
     {
      TagBox["14",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "102.9769083782156`", 
      "106.00736195894686`", "0.9446973130476797`", "0.1531604427387505`", 
      "0.021391058364051294`", "0.03896841406634195`", "16.95796257565383`", 
      "16.957962575653823`"},
     {
      TagBox["15",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "77.26353708543937`", 
      "79.5522061014151`", "0.7887611538596744`", "0.9604386327230066`", 
      "0.022498591457505532`", "0.0471273263233563`", "24.875043719853196`", 
      "24.8750437198532`"},
     {
      TagBox["16",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "67.85442306950404`", 
      "70.29960814259547`", "0.40080590055735765`", "0.48490667383090447`", 
      "0.02994068506209492`", "0.025070540700721927`", "8.743312039161829`", 
      "8.743312039161829`"},
     {
      TagBox["17",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "138.27556214704558`", 
      "138.24788667068373`", "0.2852543098054272`", "0.08091955441367182`", 
      "0.012022751893586918`", "0.019153151751919853`", "4.442966173584352`", 
      "4.442966173584352`"},
     {
      TagBox["18",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "127.60922733100827`", 
      "130.2496581022883`", "0.0526995352956372`", "0.5263093210157392`", 
      "0.014919642709676342`", "0.019770483823268598`", "3.7630621202970786`",
       "3.7630621202970644`"},
     {
      TagBox["19",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "124.66979905554831`", 
      "125.93768887583599`", "0.7476132486535085`", "0.5492171059778344`", 
      "0.04135016582809295`", "0.01929472628005839`", "26.77147589152716`", 
      "26.771475891527153`"},
     {
      TagBox["20",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "114.4280984028793`", 
      "111.07860297067847`", "0.8730187535903056`", "0.7009748010809949`", 
      "0.00509811946481506`", "0.005717439953253058`", "33.70801622928148`", 
      "33.70801717037951`"},
     {
      TagBox["21",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "141.9166329367981`", 
      "142.17780616071957`", "0.7925774299295307`", "0.9458683562441246`", 
      "0.006592633775113377`", "0.012925734266609104`", "42.785628514884806`",
       "42.785628514884806`"},
     {
      TagBox["22",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "122.38816367149397`", 
      "118.65111633172656`", "0.17778486947789185`", "0.9080079016300129`", 
      "0.007514635253109261`", "0.021795158183851207`", "9.145583871264016`", 
      "9.145583871263995`"},
     {
      TagBox["23",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "129.89920997340977`", 
      "125.90522006771742`", "0.6184830324924795`", "0.7269423970079512`", 
      "0.01723694516304937`", "0.02435359175180042`", "27.870874533380665`", 
      "27.870874533380757`"},
     {
      TagBox["24",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "82.13681765579426`", 
      "82.43645851361879`", "0.6034072360112146`", "0.06331653976855756`", 
      "0.03839966867127499`", "0.040098185880551515`", "4.814855775864153`", 
      "4.81485577586416`"},
     {
      TagBox["25",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "104.3319123658708`", 
      "100.84496320803605`", "0.962429756252406`", "0.568003331100317`", 
      "0.04212781673774184`", "0.04326024756172012`", "30.050017750487434`", 
      "30.05001804092425`"},
     {
      TagBox["26",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "66.1241265197516`", 
      "62.253418935001726`", "0.09779455945861737`", "0.09860868227312225`", 
      "0.02578544477378472`", "0.03674130162351498`", "3.809788066750251`", 
      "3.809788066750251`"},
     {
      TagBox["27",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "68.25924727592971`", 
      "64.62768515399775`", "0.7858221662579938`", "0.9743313058257943`", 
      "0.026243461338924745`", "0.02946053762440802`", "17.894111747740897`", 
      "17.894111747740894`"},
     {
      TagBox["28",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "60.551427398469144`", 
      "63.665556996405634`", "0.9797582533737088`", "0.801180385815683`", 
      "0.028908145879464442`", "0.011216387937998784`", "21.82920280399705`", 
      "21.82920280399705`"},
     {
      TagBox["29",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "80.36889243249135`", 
      "82.66587470971444`", "0.4818287338657523`", "0.9226615900794735`", 
      "0.023778685326154472`", "0.048659281929172654`", "16.53320538398573`", 
      "16.53320538398573`"},
     {
      TagBox["30",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "114.85557339567276`", 
      "113.72301730297886`", "0.8188002688723854`", "0.28208944018581783`", 
      "0.045816666354111135`", "0.028061171416235667`", "18.63720771961799`", 
      "18.637207719617997`"},
     {
      TagBox["31",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "148.90159209186947`", 
      "145.5188528599203`", "0.4634455668648543`", "0.9722332858767382`", 
      "0.002911680043925155`", "0.00648732926182171`", "27.936074353218793`", 
      "27.936074353218793`"},
     {
      TagBox["32",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "83.06005745603525`", 
      "86.80134992331678`", "0.621307993971878`", "0.7006349474489344`", 
      "0.03402815880220035`", "0.030883731470630255`", "18.823176276841053`", 
      "18.82317627684106`"},
     {
      TagBox["33",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "76.03799866070528`", 
      "75.17876103863435`", "0.39762790224557176`", "0.34369869827472654`", 
      "0.01797378337403535`", "0.023557834788935236`", "7.325863875401296`", 
      "7.3258638754013035`"},
     {
      TagBox["34",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "86.39193863792428`", 
      "85.41535241216128`", "0.7949623736797593`", "0.749771240920984`", 
      "0.01707659550476638`", "0.001106112933035662`", "23.98522591208879`", 
      "23.98522591704384`"},
     {
      TagBox["35",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "117.6398681678111`", 
      "117.46326124744415`", "0.10169380118549132`", "0.7425349105818`", 
      "0.005444534499087252`", "0.016049871309636643`", "3.7147692136452264`",
       "3.7147692136452335`"},
     {
      TagBox["36",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "110.8718403083329`", 
      "109.18472624589741`", "0.20577216132730647`", "0.1630514700227097`", 
      "0.04714055178649344`", "0.02657928772018485`", "4.737436714439191`", 
      "4.737436714439191`"},
     {
      TagBox["37",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "142.62012508980632`", 
      "146.0526637974312`", "0.24709907316017454`", "0.4792641081621618`", 
      "0.02769603864315788`", "0.0221346112369203`", "11.300884555309665`", 
      "11.300884555309608`"},
     {
      TagBox["38",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "50.28987696403398`", 
      "52.04252413379663`", "0.9688738964702066`", "0.08306364454382109`", 
      "0.049115603927852886`", "0.032034542188002876`", "4.863887721266604`", 
      "4.863887721266611`"},
     {
      TagBox["39",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "132.48270307150878`", 
      "130.70415599768313`", "0.18153914170931196`", "0.4182894457233661`", 
      "0.005392932935004646`", "0.033699827832356075`", "6.219969491554416`", 
      "6.219969491554409`"},
     {
      TagBox["40",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "128.28027965322318`", 
      "129.54559332951024`", "0.7349561605966575`", "0.9673132580578683`", 
      "0.018787215316859784`", "0.03670643897476707`", "37.1481971530404`", 
      "37.148197153040385`"},
     {
      TagBox["41",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "123.6272501387499`", 
      "127.2721012615608`", "0.2536369559444944`", "0.8103076854703926`", 
      "0.015894103695028583`", "0.023624068137489435`", "13.534836347060825`",
       "13.534836347060839`"},
     {
      TagBox["42",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "146.16994216490176`", 
      "148.38393606192304`", "0.9728690318579809`", "0.13781190525499198`", 
      "0.02824849022530121`", "0.005520227007819956`", "20.192822273872054`", 
      "20.192822273872054`"},
     {
      TagBox["43",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "149.11471320232863`", 
      "149.11501760135587`", "0.9524301770911667`", "0.028144809739821364`", 
      "0.007447423889573125`", "0.00888303440664543`", "9.49612556856529`", 
      "9.49612556856529`"},
     {
      TagBox["44",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "120.43734207148432`", 
      "118.48674357422269`", "0.359405120941342`", "0.9647911772357729`", 
      "0.0031825242169773935`", "0.04090231322730384`", "17.584924741755138`",
       "17.584924741755138`"},
     {
      TagBox["45",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "52.25657670659464`", 
      "49.70745923614988`", "0.03733914378064407`", "0.6448281723802987`", 
      "0.04594506590335351`", "0.03210444381422617`", "0.013867062487743498`",
       "0.013867062487745718`"},
     {
      TagBox["46",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "136.2744242424949`", 
      "137.1857864658857`", "0.9770980526539894`", "0.7112466335436938`", 
      "0.016266866465306104`", "0.027325502885226602`", "42.06575907607821`", 
      "42.06594343083807`"},
     {
      TagBox["47",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "69.00608574975324`", 
      "69.38561296676846`", "0.1875490764149974`", "0.6798803858619542`", 
      "0.009709394149558064`", "0.014922637009349565`", "3.9265734513260426`",
       "3.9265734513260497`"},
     {
      TagBox["48",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "67.84440701668306`", 
      "67.96935253605616`", "0.2651949963426763`", "0.8717950921242659`", 
      "0.042658915672791384`", "0.01517435479631081`", "7.283069210020699`", 
      "7.283069210020692`"},
     {
      TagBox["49",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "145.42338746663074`", 
      "141.8537335721373`", "0.7936120162525981`", "0.525659804986373`", 
      "0.024322627326204244`", "0.046811095143642206`", "32.84479296961878`", 
      "32.84479296980521`"},
     {
      TagBox["50",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "84.79763419608449`", 
      "83.8036892222804`", "0.6103723071673754`", "0.14969364547582753`", 
      "0.011915908435500479`", "0.008229256064755205`", "8.44200153694237`", 
      "8.442001536942364`"},
     {
      TagBox["51",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "61.784166519683325`", 
      "63.17492315175304`", "0.33343303742432173`", "0.6217634022134524`", 
      "0.03289822787954072`", "0.03177625851118282`", "7.086091668028953`", 
      "7.086091668028949`"},
     {
      TagBox["52",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "111.46658748652925`", 
      "110.96588621029399`", "0.2827006208826963`", "0.21614144108411937`", 
      "0.04878272938737782`", "0.007526411254918`", "5.080408032624227`", 
      "5.080408032624227`"},
     {
      TagBox["53",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "109.61283609449308`", 
      "108.40290652373422`", "0.7559068392719772`", "0.4859792757614303`", 
      "0.04940293169478806`", "0.034792651632799765`", "23.180546155444368`", 
      "23.180546155444375`"},
     {
      TagBox["54",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "129.3244700199518`", 
      "130.71207075387946`", "0.9838166525948422`", "0.45636307916238383`", 
      "0.04156862686885164`", "0.03112333661244382`", "32.915796072939145`", 
      "32.91579613920012`"},
     {
      TagBox["55",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "66.54923444300937`", 
      "70.27097508504372`", "0.13119126415432603`", "0.7597509666912574`", 
      "0.033548660943134787`", "0.012395248195284578`", "4.5236106727416185`",
       "4.523610672741626`"},
     {
      TagBox["56",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "121.9460306239734`", 
      "121.73710249338552`", "0.8519807895402127`", "0.4238994849539899`", 
      "0.006841575910763585`", "0.043551996348967253`", "27.181575499509982`",
       "27.181575499509997`"},
     {
      TagBox["57",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "70.54428753337774`", 
      "66.98635113659445`", "0.8629351053754022`", "0.4208471697235836`", 
      "0.024591361243428186`", "0.018121246835745827`", "13.237565196723903`",
       "13.237565196723896`"},
     {
      TagBox["58",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "91.06227046039584`", 
      "92.45067543000269`", "0.1512984731881153`", "0.5126308757255116`", 
      "0.04784490404313464`", "0.04989598669236994`", "4.632469834161704`", 
      "4.6324698341616966`"},
     {
      TagBox["59",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "88.30274908448726`", 
      "90.25718226668239`", "0.10677417483039031`", "0.6126726855644122`", 
      "0.03866108531794461`", "0.0463035578700339`", "1.8890192797559777`", 
      "1.8890192797559777`"},
     {
      TagBox["60",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "138.16158968861396`", 
      "135.21291842090642`", "0.4577722827121795`", "0.4527009247095102`", 
      "0.03380479572733182`", "0.026756575810993305`", "18.224150064129653`", 
      "18.224150064129667`"},
     {
      TagBox["61",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "145.16754194244237`", 
      "146.61126863562583`", "0.5647591636835994`", "0.2739279777703081`", 
      "0.04285693741854234`", "0.011200822539682562`", "17.103183632644402`", 
      "17.103183632644416`"},
     {
      TagBox["62",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "91.65287872570957`", 
      "94.80326935422157`", "0.2774747825087014`", "0.9587625554040151`", 
      "0.028327708513562436`", "0.004897857128814215`", "10.441926956543327`",
       "10.441926956543327`"},
     {
      TagBox["63",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "90.59391558009179`", 
      "91.63852791360401`", "0.4521574513079132`", "0.6919034575494107`", 
      "0.0380207314888901`", "0.04014946082690399`", "13.810255803276569`", 
      "13.81025580327659`"},
     {
      TagBox["64",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "110.97505201435723`", 
      "107.2900648861602`", "0.219354834976911`", "0.8798781913299123`", 
      "0.011855435157496132`", "0.021820335456614617`", "10.21913512655373`", 
      "10.219135126553759`"},
     {
      TagBox["65",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "62.77007163920523`", 
      "61.364150225866965`", "0.3344094746548505`", "0.7721609288846301`", 
      "0.017275256667632022`", "0.015173827900368517`", "7.92808087411532`", 
      "7.928080874115313`"},
     {
      TagBox["66",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "124.39169470960707`", 
      "121.61791027308422`", "0.8807761101800082`", "0.3090166304993014`", 
      "0.032376197740055485`", "0.018822671520730583`", "22.00467785147864`", 
      "22.004677851478647`"},
     {
      TagBox["67",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "121.13878527071307`", 
      "117.26972786597723`", "0.37102113469775366`", "0.5428407356939307`", 
      "0.03142697484257434`", "0.012826316312667105`", "10.453720550166523`", 
      "10.453720550166544`"},
     {
      TagBox["68",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "76.8346696590761`", 
      "74.16623287077101`", "0.8563079465628078`", "0.09064061743987306`", 
      "0.02764334670248736`", "0.011140984452964083`", "6.420339513457069`", 
      "6.420339513457073`"},
     {
      TagBox["69",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "100.14320882624591`", 
      "97.6643223407511`", "0.9535634343693624`", "0.48348277590724886`", 
      "0.01679312385744189`", "0.015825336414308222`", "26.759280181179918`", 
      "26.75928018475171`"},
     {
      TagBox["70",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "111.62430919877158`", 
      "114.51566129833674`", "0.24455166081374236`", "0.007302918720283547`", 
      "0.039192829235205104`", "0.014981357886540952`", 
      "0.12845168372266258`", "0.12845168372267501`"},
     {
      TagBox["71",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "117.17842536403293`", 
      "118.8818355449777`", "0.17660075277586906`", "0.6723132506495442`", 
      "0.02966752161560403`", "0.011588269596757052`", "6.851805246085156`", 
      "6.851805246085142`"},
     {
      TagBox["72",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "125.68977528572387`", 
      "126.11300622520572`", "0.1453856144341994`", "0.25340522086872785`", 
      "0.02893582443033789`", "0.026090903209024366`", "3.486891732785409`", 
      "3.4868917327854163`"},
     {
      TagBox["73",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "140.77910655111083`", 
      "141.65583763635033`", "0.765158340238731`", "0.1611070661997438`", 
      "0.042031171754843735`", "0.02443680655539518`", "16.906657831260425`", 
      "16.906657831260418`"},
     {
      TagBox["74",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "137.8376202654396`", 
      "140.50166962045816`", "0.6318845347121818`", "0.4803814455094402`", 
      "0.008790922084679943`", "0.03405068860347571`", "21.7833132026935`", 
      "21.783313202693506`"},
     {
      TagBox["75",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "148.01896690096308`", 
      "147.22145790329918`", "0.6117076388157778`", "0.4535603051763868`", 
      "0.015862442604014607`", "0.04479337354525437`", "23.204099531865886`", 
      "23.204099531865886`"},
     {
      TagBox["76",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "70.14448112645954`", 
      "71.09329077486146`", "0.6321887108450694`", "0.220927359606653`", 
      "0.0059357185886598635`", "0.03892664831801583`", "7.5916944918350175`",
       "7.591694491835014`"},
     {
      TagBox["77",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "74.26403657618863`", 
      "74.72602877528205`", "0.11891118381768817`", "0.5620793369147525`", 
      "0.018894855106263805`", "0.016066812806945482`", "2.4560880678806`", 
      "2.456088067880607`"},
     {
      TagBox["78",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "124.65929457504791`", 
      "125.74682661669222`", "0.09188658777247705`", "0.5954047874990205`", 
      "0.03642992227706027`", "0.02814333980027718`", "3.7085718399604133`", 
      "3.7085718399604204`"},
     {
      TagBox["79",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "62.12898879852227`", 
      "64.37318577587595`", "0.3345284717129917`", "0.9701721993441323`", 
      "0.039126228778365066`", "0.04921624177469351`", "6.633016602345776`", 
      "6.633016602345776`"},
     {
      TagBox["80",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "81.30234811847782`", 
      "85.04637194884347`", "0.7020878448650434`", "0.32031527519797476`", 
      "0.03243003827068533`", "0.03513063389954117`", "11.155621812255138`", 
      "11.155621812255141`"},
     {
      TagBox["81",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "122.65176771804926`", 
      "122.29119677871186`", "0.069625404980453`", "0.213370027011605`", 
      "0.031277495393235`", "0.019477836193380768`", "1.2526528512489108`", 
      "1.2526528512489108`"},
     {
      TagBox["82",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "100.05544614738483`", 
      "100.07011909325719`", "0.1964988292056371`", "0.599566901222927`", 
      "0.023673440249339664`", "0.04322162802886015`", "6.547577122259447`", 
      "6.54757712225944`"},
     {
      TagBox["83",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "84.99721158241474`", 
      "82.87595368176521`", "0.1266616343580742`", "0.8932021633771534`", 
      "0.010990130214500453`", "0.03938217241486022`", "3.9202171226897917`", 
      "3.920217122689799`"},
     {
      TagBox["84",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "76.61727993436807`", 
      "78.73994083451022`", "0.7721458516657278`", "0.6806314352563156`", 
      "0.003133903685850592`", "0.002825506728100849`", "20.440780986140286`",
       "20.440780986140282`"},
     {
      TagBox["85",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "95.6279641803767`", 
      "98.02912416243463`", "0.8414943587167525`", "0.15869353925681584`", 
      "0.007346634127146749`", "0.016707341386011945`", "14.173637202147525`",
       "14.173637202147525`"},
     {
      TagBox["86",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "81.44710006138368`", 
      "84.63455844911078`", "0.3200768269004528`", "0.5958321887865954`", 
      "0.013066530075992115`", "0.0164284793591144`", "6.538065386357999`", 
      "6.538065386357999`"},
     {
      TagBox["87",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "114.31417223289924`", 
      "117.83319276618171`", "0.9121223249357979`", "0.9117678517635335`", 
      "0.009872421009851931`", "0.017639063493324503`", "40.78366119977297`", 
      "40.783661199772986`"},
     {
      TagBox["88",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "109.70754471093272`", 
      "106.35720687108969`", "0.5167859830902255`", "0.124130588414471`", 
      "0.03637283265463424`", "0.02498458775151237`", "9.674674911856606`", 
      "9.674674911856606`"},
     {
      TagBox["89",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "53.38771687300937`", 
      "54.42222668420242`", "0.78229082793094`", "0.8418439097979249`", 
      "0.010045016550037318`", "0.019128190036198367`", "14.222244323494234`",
       "14.222244323685779`"},
     {
      TagBox["90",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "101.93955338848616`", 
      "105.8280563350562`", "0.23124072589472067`", "0.36113150791150583`", 
      "0.014683154346963753`", "0.017576344835766394`", "3.951768415777373`", 
      "3.951768415777373`"},
     {
      TagBox["91",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "55.412388604093806`", 
      "57.03912928851172`", "0.8871899216302321`", "0.045545457115852006`", 
      "0.04361059582209717`", "0.03726006127556156`", "3.477319936670849`", 
      "3.4773199366708454`"},
     {
      TagBox["92",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "106.24021019859583`", 
      "109.48370364992377`", "0.2758234147498331`", "0.3935040119237312`", 
      "0.04133679206305946`", "0.009322490955254115`", "6.466157455950658`", 
      "6.466157455950658`"},
     {
      TagBox["93",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "87.12135030592509`", 
      "88.1128822645744`", "0.9407947896581961`", "0.4460425828152188`", 
      "0.018805759761168467`", "0.013729189431205817`", "21.058648154755495`",
       "21.058648154794867`"},
     {
      TagBox["94",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "96.65827153820652`", 
      "94.67534469485116`", "0.5481401331029361`", "0.7351604020006932`", 
      "0.0073223300436356595`", "0.03404768416130065`", "17.45340899928872`", 
      "17.45340899928872`"},
     {
      TagBox["95",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "55.808890805679525`", 
      "59.33950125566888`", "0.8091920096121907`", "0.019494160478476408`", 
      "0.019202721314393087`", "0.015181462512859761`", "4.72680173951521`", 
      "4.72680173951521`"},
     {
      TagBox["96",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "143.57829950855822`", 
      "140.5739446644765`", "0.20342632097952107`", "0.5857013704739413`", 
      "0.0028446390140286007`", "0.026050835869271816`", "9.283020366125669`",
       "9.283020366125683`"},
     {
      TagBox["97",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "132.6789247652606`", 
      "132.44374725997326`", "0.5600301626969943`", "0.06804162951869697`", 
      "0.023355037234863735`", "0.04907667287859459`", "7.698036499478512`", 
      "7.698036499478512`"},
     {
      TagBox["98",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "70.70965727244483`", 
      "73.08533515204581`", "0.6623869125086639`", "0.4278597731913769`", 
      "0.020493837971771636`", "0.01840434206616652`", "11.115773205725944`", 
      "11.11577320572594`"},
     {
      TagBox["99",
       HoldForm], "\<\"put\"\>", "\<\"vanilla\"\>", "95.0931776536271`", 
      "91.20165339785018`", "0.5337172365169975`", "0.2788673230592924`", 
      "0.023021299115064994`", "0.016615622177399578`", "8.486765138947028`", 
      "8.486765138947028`"},
     {
      TagBox["100",
       HoldForm], "\<\"call\"\>", "\<\"vanilla\"\>", "89.3859309245519`", 
      "92.04983532044085`", "0.9347013089594967`", "0.7642883768621496`", 
      "0.013655317505664934`", "0.009404413433005479`", "27.35752255983131`", 
      "27.357529367432825`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 
      17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
      35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 
      53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 
      71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 
      89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101}, {
      "call_put", "type", "S", "X", "sigma", "T", "intRate", "yield", "uodo", 
       "bs"}}]]]], "Output",
 CellChangeTimes->{3.737199381937123*^9, 3.7371999229553394`*^9, 
  3.7372015066627274`*^9},
 CellLabel->
  "Out[156]//TableForm=",ExpressionUUID->"dbf73dbb-5798-4d7f-a8ca-\
848356a08624"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"out", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;"}], ",", " ", 
          RowBox[{"-", "2"}]}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}]}], "]"}], ",", " ", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"out", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"2", ";;"}], ",", " ", 
          RowBox[{"-", "1"}]}], "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{"NumericQ", "[", "#", "]"}], " ", "&"}]}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"Filling", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", "\[Rule]", 
      RowBox[{"{", "2", "}"}]}], "}"}]}], ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<uodo\>\"", ",", " ", "\"\<bs\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Right", ",", " ", "Top"}], "}"}]}], "]"}]}], ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.737191026313956*^9, 3.737191032307034*^9}, {
  3.737191068199547*^9, 3.737191164921883*^9}, {3.7371915681895084`*^9, 
  3.737191572329563*^9}, {3.737193231696154*^9, 3.7371933121130304`*^9}, {
  3.7371934078873954`*^9, 3.7371934299746313`*^9}, {3.7371934656070194`*^9, 
  3.7371934701500683`*^9}},
 CellLabel->
  "In[151]:=",ExpressionUUID->"549f9b37-8876-4a2d-a1be-93f8898d59f9"],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, GraphicsComplexBox[CompressedData["
1:eJztmHtMU1cYwMtjprxEFMNDQURExArlIRSB9hNbQEQoIFCcy+oimxLYQNGI
XeQ6maLDrYwYJ0FkdbIHE1+L+Nijoi5aHwE3FJ1szAmSuA2M2iAwN8b9boCT
wkkDc//0/gH59Tvfvb3nnt7f+b6Zr72VnGnO4/Gg/8+//9mjS3Jmyx2HCfoo
wA9A2usbZ5m5AJkPK9aYvbr7RBjyJFBbuUxQ28xCdoQSnX9jyVJPZGe4lBqy
S78zFHk6qKe41DxKC0L2AO3WeLFT2QMJy57wpW3i5U2OAox7gdIlZ1ZoqRWy
N7T+fdn1yfl2HO8D8ncvqFT5emRfkF7O/s7tgA+OF4AmzM4q8qkQ2Q+epBW2
mLeKkIXwSbMss+ztmcgBoHU78ftHFx2QA0HZNU2udZ2IHATd9TV5hRcXIgfD
++3l0VV3AHkBuLsfKvhgtQw5BO5en9a9M46bj1Cw1s3RPPo5HFkEsYK83Wuj
piCHgae6XH/NVoy8EIQOKt91m7nrh0Nk0cOt9+8HIEeA6GGJJvpH7vlEgqOs
fTZTzN2vGCqKSmw8DgYiS0B/fH+pppO7PoBza1Dt2RsYZwAY/8KoI8vcML4I
bu3tPB/ah8+PWQStGe0Pm+vsMB4Fse/Nr/B8PBnjUaC8k7HLrtwb44tBMGFf
b2U+3h+zGETKY7WSX50xLoWKphszuj+MwrgUIg7fdLjpMA/jMigWdV1dGRCM
cRnwMz+dZ/mcm89oqN7wddU3e3A+mGhg9OYHUl8vwfUQA+17pl/J4uPzYGJA
GL8x/cBae8yPBUbg3nZ3Jt4vEwuaoEnzPbO557kEeO3bJiTc88D4Erhbap3l
o5iO8Tg49cNpVVqyI8bjIM3utkzkx633peC8a/F10QY8H9PPtjmZ851xvnjx
sNFbeVblh8+DiYfqgMjZmgJfjC+DNaenCqp3cPO7DFptzsVkhz3H+0uAuCbr
9lVh3PNLgKNHncRZrtz6SARnbwuQ3vPCeCJ4dcLt25Xc/Mqh78GJzYG5GAc5
RBTMbVpxcgaOl8P3bimlgWYhLGvlwO9R2Cd04HheEljai1U5tS6YnwTCmnJ/
ZT3+PpgkYCJW3HDN07LfV5sEHX1rNZI10zA/GRhbny1z2mwwPxnM/5Cdce3A
9cskg97pasiOS7i+tcngt+XPFkkwN78pkF/pN7ftFXfMT4FWr0jGodoC8/u5
W3VyTg2uV20KaPdN2bqg2BXzl0PgyqLPDyfieoXlwDuSWtdi/YT9vsxyKC6t
mnhKiOO1/XFlwZXyldz6SYXGeQ0v3crF9QmpsNr/2LN2Bb6/mFSocrhZ0ePN
5afCwakV5omrpZifBoKT6/96MwPfn5AG4ihrc10el58GcquMetF+vJ42DUS3
ctx2N+J88dKhQylfpWjh5j8dog/Vqy3scb6YdFj4WV3F5HxcD9p0EJY51Yk7
uPWnAGHYxzYdak/MV8Cp4+846nQ4n4wCfI75VEWH4/xoFVAkOhcT9gx/D7wM
uDAxZN/2l7n3SZfkW8IfsWP0h26M/pAT/vDg6Yb5Awh/RBP+qCL88dRIfwDh
Dz3hj5r7hQmj+aOB8IcX4Q854Q9dT0HvaP6IMNIflRR/uBL+KCb80fOL5YWh
/uii+AMIfwQT/hAS/ign/CEdqz96h/vjcdbeptwh/gDCH5sIf3iUD/dHX9tw
fzRT/KEg/LG+qXGYPzwIf2wm/KEh/KGk+COB8MdXFH8ICX/Ydgz3RzDhj0uE
PxwJf/AJf2SZfzHMHyAe7o9mwh9qwh88wh/dFH/kEv7oIvzRRfFHMMUfDOGP
SYQ/Goz0xyGKP/If2IzqDyHFH+oG4/whovjDm+IPnSrbZsco/vh/6w8aD/GL
GctK+xF44BisX7TIfnydQWbHk36iMVn/0Jj0G42NrZ9oPLIfu8tmDHD9te3r
DDE7nlZ/0Zj0awj8NiqPtX6jsbF+pvELrv9oPNTvfJaltiPwwDFYP/KRt43A
7Pkp+wMav8D6E5D3ZxhmNn9wf2GBbOlvmNnzD6lfY80GuKizS2CQBw4j9yc0
Hmv9S2Nj9zc0Hsf62RpZNgIPILk/ovF41t9mLP9U+4ZhHjj/4P7KDPnoCMxe
f0j9bslyeL2fYR74fsT+jMa0+p/G5P6OxuPdP6DxkP2hB7KkxDCz1yf6DzQ2
dn9J47H2L2hM25/SeLz7HzSm7W9pbKB/Yuq/m/rvpv67qf/Ojjf13039d1P/
3dR/N/Xf2bip/27qv5v67/9F//0fiX0Q9g==
      "], {{{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
        {RGBColor[0.368417, 0.506779, 0.709798], Opacity[0.3], 
         LineBox[{1, 201}], LineBox[{102, 202}], LineBox[{103, 203}], 
         LineBox[{104, 204}], LineBox[{105, 205}], LineBox[{106, 206}], 
         LineBox[{107, 207}], LineBox[{108, 208}], LineBox[{109, 209}], 
         LineBox[{111, 215}], LineBox[{113, 221}], LineBox[{115, 227}], 
         LineBox[{116, 228}], LineBox[{117, 229}], LineBox[{120, 236}], 
         LineBox[{121, 237}], LineBox[{123, 243}], LineBox[{124, 244}], 
         LineBox[{125, 245}], LineBox[{126, 246}], LineBox[{130, 254}], 
         LineBox[{131, 255}], LineBox[{132, 256}], LineBox[{133, 257}], 
         LineBox[{134, 258}], LineBox[{135, 259}], LineBox[{136, 260}], 
         LineBox[{138, 266}], LineBox[{141, 273}], LineBox[{142, 274}], 
         LineBox[{143, 275}], LineBox[{144, 276}], LineBox[{145, 277}], 
         LineBox[{146, 278}], LineBox[{147, 279}], LineBox[{149, 285}], 
         LineBox[{153, 293}], LineBox[{154, 294}], LineBox[{155, 295}], 
         LineBox[{156, 296}], LineBox[{160, 304}], LineBox[{161, 305}], 
         LineBox[{162, 306}], LineBox[{163, 307}], LineBox[{164, 308}], 
         LineBox[{166, 314}], LineBox[{167, 315}], LineBox[{168, 316}], 
         LineBox[{169, 317}], LineBox[{170, 318}], LineBox[{172, 324}], 
         LineBox[{174, 330}], LineBox[{175, 331}], LineBox[{177, 337}], 
         LineBox[{178, 338}], LineBox[{179, 339}], LineBox[{180, 340}], 
         LineBox[{181, 341}], LineBox[{183, 347}], LineBox[{187, 355}], 
         LineBox[{188, 356}], LineBox[{189, 357}], LineBox[{190, 358}], 
         LineBox[{193, 365}], LineBox[{194, 366}], LineBox[{195, 367}], 
         LineBox[{196, 368}], LineBox[{197, 369}], LineBox[{200, 376}]}, 
        {RGBColor[0.368417, 0.506779, 0.709798], Opacity[0.3], 
         LineBox[{10, 212}], LineBox[{12, 218}], LineBox[{14, 224}], 
         LineBox[{18, 232}], LineBox[{19, 233}], LineBox[{22, 240}], 
         LineBox[{27, 249}], LineBox[{28, 250}], LineBox[{29, 251}], 
         LineBox[{37, 263}], LineBox[{39, 269}], LineBox[{40, 270}], 
         LineBox[{48, 282}], LineBox[{50, 288}], LineBox[{51, 289}], 
         LineBox[{52, 290}], LineBox[{57, 299}], LineBox[{58, 300}], 
         LineBox[{59, 301}], LineBox[{65, 311}], LineBox[{71, 321}], 
         LineBox[{73, 327}], LineBox[{76, 334}], LineBox[{82, 344}], 
         LineBox[{84, 350}], LineBox[{85, 351}], LineBox[{86, 352}], 
         LineBox[{91, 361}], LineBox[{92, 362}], LineBox[{98, 372}], 
         LineBox[{99, 373}]}}, {{}, 
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.009166666666666668], AbsoluteThickness[1.6], 
         PointBox[CompressedData["
1:eJwNxkVWQgEAAMDvUbySR/C51rWJ2IWA2FjY2IWd2C0qJodhFvPelJZXlVWW
BEFQQbXUUEsd9TQQopEwTTTTQitttNNBJ11000OEXqLEiNNHgn4GGGSIYUYY
JckY40wwyRQppplhljnmWWCRNEsss8Iqa6yzwSZbbLNDhl322OeAQ4445oRT
zjjngiyXXHHNDbfccc8DjzzxzAuvvJHjnQ8+yfPFNz/88sc/BYoiUkUW
          "]]}, 
        {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
         0.009166666666666668], AbsoluteThickness[1.6], 
         PointBox[CompressedData["
1:eJwVzsVSAlAAQNEHBtgotiIi2N0tfoOf4LDWL7a7uxU9Ls7MXd7M5vbGViSE
UGBH7LLHPgcccsQxJ5xyxjkXXHLFNTfccsc9DzzyxDMvvPLGOx988sU3PxT5
/R+KhhAhSgmllFFOjDgVVFJFNTXUUkeCehpI0kgTzbTQShvtdNBJii7SdJOh
hyw5eumjnwEGGWKYEUYZY5wJJplimhlmmWOeBRZZYpkVVlkjzzp/kggrZw==

          "]]}, {}}}], {}, {}, {}, {}}, InsetBox[
     TemplateBox[{"\"uodo\"","\"bs\""},
      "PointLegend",
      DisplayFunction->(FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.33000000000000007`], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.33000000000000007`], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.33000000000000007`], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.33000000000000007`], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.009166666666666668`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& )], 
     Scaled[{0.99, 0.99}], ImageScaled[{1, 1}],
     BaseStyle->{FontSize -> Larger},
     FormatType->StandardForm]},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   ImageSize->Large,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{0, 100.}, {0, 42.785628514884806`}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.02], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}],
  InterpretTemplate[Legended[
    Graphics[{{}, 
      GraphicsComplex[CompressedData["
1:eJztmHtMU1cYwMtjprxEFMNDQURExArlIRSB9hNbQEQoIFCcy+oimxLYQNGI
XeQ6maLDrYwYJ0FkdbIHE1+L+Nijoi5aHwE3FJ1szAmSuA2M2iAwN8b9boCT
wkkDc//0/gH59Tvfvb3nnt7f+b6Zr72VnGnO4/Gg/8+//9mjS3Jmyx2HCfoo
wA9A2usbZ5m5AJkPK9aYvbr7RBjyJFBbuUxQ28xCdoQSnX9jyVJPZGe4lBqy
S78zFHk6qKe41DxKC0L2AO3WeLFT2QMJy57wpW3i5U2OAox7gdIlZ1ZoqRWy
N7T+fdn1yfl2HO8D8ncvqFT5emRfkF7O/s7tgA+OF4AmzM4q8qkQ2Q+epBW2
mLeKkIXwSbMss+ztmcgBoHU78ftHFx2QA0HZNU2udZ2IHATd9TV5hRcXIgfD
++3l0VV3AHkBuLsfKvhgtQw5BO5en9a9M46bj1Cw1s3RPPo5HFkEsYK83Wuj
piCHgae6XH/NVoy8EIQOKt91m7nrh0Nk0cOt9+8HIEeA6GGJJvpH7vlEgqOs
fTZTzN2vGCqKSmw8DgYiS0B/fH+pppO7PoBza1Dt2RsYZwAY/8KoI8vcML4I
bu3tPB/ah8+PWQStGe0Pm+vsMB4Fse/Nr/B8PBnjUaC8k7HLrtwb44tBMGFf
b2U+3h+zGETKY7WSX50xLoWKphszuj+MwrgUIg7fdLjpMA/jMigWdV1dGRCM
cRnwMz+dZ/mcm89oqN7wddU3e3A+mGhg9OYHUl8vwfUQA+17pl/J4uPzYGJA
GL8x/cBae8yPBUbg3nZ3Jt4vEwuaoEnzPbO557kEeO3bJiTc88D4Erhbap3l
o5iO8Tg49cNpVVqyI8bjIM3utkzkx633peC8a/F10QY8H9PPtjmZ851xvnjx
sNFbeVblh8+DiYfqgMjZmgJfjC+DNaenCqp3cPO7DFptzsVkhz3H+0uAuCbr
9lVh3PNLgKNHncRZrtz6SARnbwuQ3vPCeCJ4dcLt25Xc/Mqh78GJzYG5GAc5
RBTMbVpxcgaOl8P3bimlgWYhLGvlwO9R2Cd04HheEljai1U5tS6YnwTCmnJ/
ZT3+PpgkYCJW3HDN07LfV5sEHX1rNZI10zA/GRhbny1z2mwwPxnM/5Cdce3A
9cskg97pasiOS7i+tcngt+XPFkkwN78pkF/pN7ftFXfMT4FWr0jGodoC8/u5
W3VyTg2uV20KaPdN2bqg2BXzl0PgyqLPDyfieoXlwDuSWtdi/YT9vsxyKC6t
mnhKiOO1/XFlwZXyldz6SYXGeQ0v3crF9QmpsNr/2LN2Bb6/mFSocrhZ0ePN
5afCwakV5omrpZifBoKT6/96MwPfn5AG4ihrc10el58GcquMetF+vJ42DUS3
ctx2N+J88dKhQylfpWjh5j8dog/Vqy3scb6YdFj4WV3F5HxcD9p0EJY51Yk7
uPWnAGHYxzYdak/MV8Cp4+846nQ4n4wCfI75VEWH4/xoFVAkOhcT9gx/D7wM
uDAxZN/2l7n3SZfkW8IfsWP0h26M/pAT/vDg6Yb5Awh/RBP+qCL88dRIfwDh
Dz3hj5r7hQmj+aOB8IcX4Q854Q9dT0HvaP6IMNIflRR/uBL+KCb80fOL5YWh
/uii+AMIfwQT/hAS/ign/CEdqz96h/vjcdbeptwh/gDCH5sIf3iUD/dHX9tw
fzRT/KEg/LG+qXGYPzwIf2wm/KEh/KGk+COB8MdXFH8ICX/Ydgz3RzDhj0uE
PxwJf/AJf2SZfzHMHyAe7o9mwh9qwh88wh/dFH/kEv7oIvzRRfFHMMUfDOGP
SYQ/Goz0xyGKP/If2IzqDyHFH+oG4/whovjDm+IPnSrbZsco/vh/6w8aD/GL
GctK+xF44BisX7TIfnydQWbHk36iMVn/0Jj0G42NrZ9oPLIfu8tmDHD9te3r
DDE7nlZ/0Zj0awj8NiqPtX6jsbF+pvELrv9oPNTvfJaltiPwwDFYP/KRt43A
7Pkp+wMav8D6E5D3ZxhmNn9wf2GBbOlvmNnzD6lfY80GuKizS2CQBw4j9yc0
Hmv9S2Nj9zc0Hsf62RpZNgIPILk/ovF41t9mLP9U+4ZhHjj/4P7KDPnoCMxe
f0j9bslyeL2fYR74fsT+jMa0+p/G5P6OxuPdP6DxkP2hB7KkxDCz1yf6DzQ2
dn9J47H2L2hM25/SeLz7HzSm7W9pbKB/Yuq/m/rvpv67qf/Ojjf13039d1P/
3dR/N/Xf2bip/27qv5v67/9F//0fiX0Q9g==
       "], {{{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
          Directive[
           RGBColor[0.368417, 0.506779, 0.709798], 
           Opacity[0.3]], 
          Line[{1, 201}], 
          Line[{102, 202}], 
          Line[{103, 203}], 
          Line[{104, 204}], 
          Line[{105, 205}], 
          Line[{106, 206}], 
          Line[{107, 207}], 
          Line[{108, 208}], 
          Line[{109, 209}], 
          Line[{111, 215}], 
          Line[{113, 221}], 
          Line[{115, 227}], 
          Line[{116, 228}], 
          Line[{117, 229}], 
          Line[{120, 236}], 
          Line[{121, 237}], 
          Line[{123, 243}], 
          Line[{124, 244}], 
          Line[{125, 245}], 
          Line[{126, 246}], 
          Line[{130, 254}], 
          Line[{131, 255}], 
          Line[{132, 256}], 
          Line[{133, 257}], 
          Line[{134, 258}], 
          Line[{135, 259}], 
          Line[{136, 260}], 
          Line[{138, 266}], 
          Line[{141, 273}], 
          Line[{142, 274}], 
          Line[{143, 275}], 
          Line[{144, 276}], 
          Line[{145, 277}], 
          Line[{146, 278}], 
          Line[{147, 279}], 
          Line[{149, 285}], 
          Line[{153, 293}], 
          Line[{154, 294}], 
          Line[{155, 295}], 
          Line[{156, 296}], 
          Line[{160, 304}], 
          Line[{161, 305}], 
          Line[{162, 306}], 
          Line[{163, 307}], 
          Line[{164, 308}], 
          Line[{166, 314}], 
          Line[{167, 315}], 
          Line[{168, 316}], 
          Line[{169, 317}], 
          Line[{170, 318}], 
          Line[{172, 324}], 
          Line[{174, 330}], 
          Line[{175, 331}], 
          Line[{177, 337}], 
          Line[{178, 338}], 
          Line[{179, 339}], 
          Line[{180, 340}], 
          Line[{181, 341}], 
          Line[{183, 347}], 
          Line[{187, 355}], 
          Line[{188, 356}], 
          Line[{189, 357}], 
          Line[{190, 358}], 
          Line[{193, 365}], 
          Line[{194, 366}], 
          Line[{195, 367}], 
          Line[{196, 368}], 
          Line[{197, 369}], 
          Line[{200, 376}]}, {
          Directive[
           RGBColor[0.368417, 0.506779, 0.709798], 
           Opacity[0.3]], 
          Line[{10, 212}], 
          Line[{12, 218}], 
          Line[{14, 224}], 
          Line[{18, 232}], 
          Line[{19, 233}], 
          Line[{22, 240}], 
          Line[{27, 249}], 
          Line[{28, 250}], 
          Line[{29, 251}], 
          Line[{37, 263}], 
          Line[{39, 269}], 
          Line[{40, 270}], 
          Line[{48, 282}], 
          Line[{50, 288}], 
          Line[{51, 289}], 
          Line[{52, 290}], 
          Line[{57, 299}], 
          Line[{58, 300}], 
          Line[{59, 301}], 
          Line[{65, 311}], 
          Line[{71, 321}], 
          Line[{73, 327}], 
          Line[{76, 334}], 
          Line[{82, 344}], 
          Line[{84, 350}], 
          Line[{85, 351}], 
          Line[{86, 352}], 
          Line[{91, 361}], 
          Line[{92, 362}], 
          Line[{98, 372}], 
          Line[{99, 373}]}}, {{}, {
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], 
          Point[CompressedData["
1:eJwNxkVWQgEAAMDvUbySR/C51rWJ2IWA2FjY2IWd2C0qJodhFvPelJZXlVWW
BEFQQbXUUEsd9TQQopEwTTTTQitttNNBJ11000OEXqLEiNNHgn4GGGSIYUYY
JckY40wwyRQppplhljnmWWCRNEsss8Iqa6yzwSZbbLNDhl322OeAQ4445oRT
zjjngiyXXHHNDbfccc8DjzzxzAuvvJHjnQ8+yfPFNz/88sc/BYoiUkUW
           "]]}, {
          Hue[0.9060679774997897, 0.6, 0.6], 
          Directive[
           PointSize[0.009166666666666668], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], 
          Point[CompressedData["
1:eJwVzsVSAlAAQNEHBtgotiIi2N0tfoOf4LDWL7a7uxU9Ls7MXd7M5vbGViSE
UGBH7LLHPgcccsQxJ5xyxjkXXHLFNTfccsc9DzzyxDMvvPLGOx988sU3PxT5
/R+KhhAhSgmllFFOjDgVVFJFNTXUUkeCehpI0kgTzbTQShvtdNBJii7SdJOh
hyw5eumjnwEGGWKYEUYZY5wJJplimhlmmWOeBRZZYpkVVlkjzzp/kggrZw==

           "]]}, {}}}], {}, {}, {}, {}}, {
     DisplayFunction -> Identity, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}}, AxesOrigin -> {0, 0}, 
      PlotRange -> {{0, 100.}, {0, 42.785628514884806`}}, PlotRangeClipping -> 
      True, ImagePadding -> All, DisplayFunction -> Identity, AspectRatio -> 
      GoldenRatio^(-1), Axes -> {True, True}, AxesLabel -> {None, None}, 
      AxesOrigin -> {0, 0}, DisplayFunction :> Identity, 
      Frame -> {{False, False}, {False, False}}, 
      FrameLabel -> {{None, None}, {None, None}}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, GridLinesStyle -> Directive[
        GrayLevel[0.5, 0.4]], ImageSize -> Large, 
      Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}}, 
      PlotRange -> {{0, 100.}, {0, 42.785628514884806`}}, PlotRangeClipping -> 
      True, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.02], 
         Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
    Placed[
     Unevaluated[
      PointLegend[{
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        Directive[
         PointSize[0.009166666666666668], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]]}, {"uodo", "bs"}, 
       LegendMarkers -> {{False, Automatic}, {False, Automatic}}, 
       Joined -> {False, False}, LabelStyle -> {}, LegendLayout -> 
       "Column"]], {Right, Top}, Identity]]& ],
  AutoDelete->True,
  Editable->True,
  SelectWithContents->False,
  Selectable->True]], "Output",
 CellChangeTimes->{3.737200566779147*^9},
 CellLabel->
  "Out[151]=",ExpressionUUID->"a92bbb25-fb67-4185-94f3-ca1247fe44f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Reverse", "[", 
      RowBox[{"SortBy", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Sequence", "@@", "#"}], ",", " ", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "2"}], "]"}], "]"}], "-", 
             RowBox[{"#", "[", 
              RowBox[{"[", 
               RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], " ", "&"}], " ", "/@",
          " ", 
         RowBox[{"out", "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ",", " ", 
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"#", "[", 
           RowBox[{"[", 
            RowBox[{"-", "1"}], "]"}], "]"}], "]"}], " ", "&"}]}], "]"}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "5"}], "]"}], "]"}], ",", " ", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"None", ",", " ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<call_put\>\"", ",", "\"\<type\>\"", ",", "\"\<S\>\"", ",", 
         "\"\<X\>\"", ",", "\"\<sigma\>\"", ",", "\"\<T\>\"", ",", 
         "\"\<intRate\>\"", ",", "\"\<yield\>\"", ",", " ", "\"\<uodo\>\"", 
         ",", " ", "\"\<bs\>\"", ",", " ", "\"\<uodo-bs\>\""}], "}"}]}], 
      "}"}]}]}], "]"}], " "}]], "Input",
 CellChangeTimes->{{3.737199514987777*^9, 3.7371995636946507`*^9}, {
  3.7371995975752707`*^9, 3.7371996448611345`*^9}, {3.7372006201714334`*^9, 
  3.7372007386471567`*^9}},
 CellLabel->
  "In[155]:=",ExpressionUUID->"27730b4b-3687-49d2-940b-9bc4b3165e02"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"call_put\"\>",
       HoldForm], 
      TagBox["\<\"type\"\>",
       HoldForm], 
      TagBox["\<\"S\"\>",
       HoldForm], 
      TagBox["\<\"X\"\>",
       HoldForm], 
      TagBox["\<\"sigma\"\>",
       HoldForm], 
      TagBox["\<\"T\"\>",
       HoldForm], 
      TagBox["\<\"intRate\"\>",
       HoldForm], 
      TagBox["\<\"yield\"\>",
       HoldForm], 
      TagBox["\<\"uodo\"\>",
       HoldForm], 
      TagBox["\<\"bs\"\>",
       HoldForm], 
      TagBox["\<\"uodo-bs\"\>",
       HoldForm]},
     {"\<\"call\"\>", "\<\"vanilla\"\>", "136.2744242424949`", 
      "137.1857864658857`", "0.9770980526539894`", "0.7112466335436938`", 
      "0.016266866465306104`", "0.027325502885226602`", "42.06575907607821`", 
      "42.06594343083807`", 
      RowBox[{"-", "0.00018435475985967287`"}]},
     {"\<\"call\"\>", "\<\"vanilla\"\>", "89.3859309245519`", 
      "92.04983532044085`", "0.9347013089594967`", "0.7642883768621496`", 
      "0.013655317505664934`", "0.009404413433005479`", "27.35752255983131`", 
      "27.357529367432825`", 
      RowBox[{"-", "6.8076015153906155`*^-6"}]},
     {"\<\"call\"\>", "\<\"vanilla\"\>", "114.4280984028793`", 
      "111.07860297067847`", "0.8730187535903056`", "0.7009748010809949`", 
      "0.00509811946481506`", "0.005717439953253058`", "33.70801622928148`", 
      "33.70801717037951`", 
      RowBox[{"-", "9.410980297275273`*^-7"}]},
     {"\<\"call\"\>", "\<\"vanilla\"\>", "104.3319123658708`", 
      "100.84496320803605`", "0.962429756252406`", "0.568003331100317`", 
      "0.04212781673774184`", "0.04326024756172012`", "30.050017750487434`", 
      "30.05001804092425`", 
      RowBox[{"-", "2.904368159306614`*^-7"}]},
     {"\<\"call\"\>", "\<\"vanilla\"\>", "129.3244700199518`", 
      "130.71207075387946`", "0.9838166525948422`", "0.45636307916238383`", 
      "0.04156862686885164`", "0.03112333661244382`", "32.915796072939145`", 
      "32.91579613920012`", 
      RowBox[{"-", "6.626097359685446`*^-8"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {
     None, {"call_put", "type", "S", "X", "sigma", "T", "intRate", "yield", 
       "uodo", "bs", "uodo-bs"}}]]]], "Output",
 CellChangeTimes->{{3.737199530826067*^9, 3.7371995644516625`*^9}, {
   3.7371995986872916`*^9, 3.737199615670603*^9}, 3.737200588411302*^9, {
   3.7372006531126933`*^9, 3.7372006607774544`*^9}, 3.737200739769269*^9},
 CellLabel->
  "Out[155]//TableForm=",ExpressionUUID->"5c4d5675-e111-4afa-b476-\
4527c422848e"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Single", "Section",
 CellChangeTimes->{{3.737182122591421*^9, 3.7371821236414347`*^9}, {
  3.7371843043083935`*^9, 3.7371843056184096`*^9}, {3.737201584485077*^9, 
  3.737201585455106*^9}},ExpressionUUID->"5b17ee1f-5f28-4dc9-be40-\
d3f3a616949c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
   "Import", "[", 
    "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\BarrierOption\\\
\\TestData\\\\test_haug_single.csv\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.737260650900281*^9, 3.7372606548203297`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"d7975db7-81c2-496f-bc8c-0e3dd98292bd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<BarrierDownOut\>\"", ",", "\"\<European\>\"", ",", " ", 
     "\"\<Call\>\""}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<Barrier\>\"", "\[Rule]", "95"}], ",", " ", 
     RowBox[{"\"\<Rebate\>\"", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
      RowBox[{"0.08", "-", "0.04"}]}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"\"\<Value\>\"", ",", " ", "\"\<Greeks\>\""}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.73770061111977*^9, 3.7377006901705837`*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"f0f9004c-a65d-4ddd-b641-c7ea5fdfcffc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6.744729727765325`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\<\"Delta\"\>", "\[Rule]", "1.3055516763149795`"}], ",", 
     RowBox[{"\<\"Gamma\"\>", "\[Rule]", 
      RowBox[{"-", "0.016646149743438105`"}]}], ",", 
     RowBox[{"\<\"Rho\"\>", "\[Rule]", "21.31049717514417`"}], ",", 
     RowBox[{"\<\"Theta\"\>", "\[Rule]", "0.5193130366706625`"}], ",", 
     RowBox[{"\<\"Vega\"\>", "\[Rule]", 
      RowBox[{"-", "7.817174404890303`"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7377006433630996`*^9, 3.7377006905705876`*^9}, 
   3.737706128326991*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"ec4f7f7a-f365-4ed1-8a59-bfa4ddf7ba1f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"singleDownAndOutOutsideBarrierOptionValue", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.04", ",", "0.25"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"100", ",", "0.04", ",", "0.25"}], "}"}], ",", "0.9999", ",", 
   "0.08", ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]], ",", "0.5", ",", "95"}], "}"}], ",", "90", ",", 
   "0.5", ",", "0.5", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7377061521559143`*^9, 3.7377061644240456`*^9}, {
  3.737708571716867*^9, 3.737708589099048*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"25030547-bab4-4efe-9325-9629404b5f00"],

Cell[BoxData["6.744314033593028`"], "Output",
 CellChangeTimes->{
  3.737708126628216*^9, {3.7377085657448034`*^9, 3.737708591863076*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"0436eadb-3982-4caf-97bf-41bb07de5df8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"singleDownAndOutOutsideBarrierOptionValue", "[", 
  RowBox[{"1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"100", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<s\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", "0.04", 
     ",", 
     RowBox[{"fd", "[", 
      RowBox[{"0.25", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<vol\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"100", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<s\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", "0.04", 
     ",", 
     RowBox[{"fd", "[", 
      RowBox[{"0.25", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<vol\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}], 
   ",", "0.99", ",", "0.08", ",", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["10", 
      RowBox[{"-", "3"}]], ",", "0.5", ",", "95"}], "}"}], ",", "90", ",", 
   "0.5", ",", "0.5", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.737700713579824*^9, 3.7377008673654003`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"41eeddcc-ff7c-406e-99a1-cc1440f39e07"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Select", "[", 
  RowBox[{"data", ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"#", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", 
     RowBox[{"#", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7372619383636007`*^9, 3.737261971067024*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"ac7b90c6-df81-49b2-811e-e086de2c2731"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"call_put\"\>", ",", "\<\"type\"\>", ",", "\<\"S\"\>", 
     ",", "\<\"X\"\>", ",", "\<\"B\"\>", ",", "\<\"sigma\"\>", 
     ",", "\<\"T\"\>", ",", "\<\"r\"\>", ",", "\<\"b\"\>", 
     ",", "\<\"rebate\"\>", ",", "\<\"value\"\>"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "9.0246`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "6.7924`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "4.8759`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.6789`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.358`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.3453`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "8.8334`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "7.0285`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "5.4137`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.6341`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.4389`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.4315`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"do\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.2798`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"do\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.2947`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"do\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.6252`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "3.776`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "5.4932`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "7.5187`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"do\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.417`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"do\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.4258`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"do\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.6246`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "4.2293`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "5.8032`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"uo\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "7.5649`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"di\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "7.7627`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"di\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "4.0109`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"di\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.0576`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "14.1112`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "8.4482`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "4.591`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"di\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "9.0093`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"di\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "5.137`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"di\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.8517`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "15.2098`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "9.7278`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "5.835`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"di\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.9586`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"di\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "6.5677`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"di\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "11.9752`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "1.4653`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "3.3721`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "7.0846`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"di\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "3.8769`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"di\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "7.7989`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"di\"\>", ",", "100", ",", "110", ",", 
     "95", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "13.3078`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "90", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "2.0658`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "100", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "4.4226`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"put\"\>", ",", "\<\"ui\"\>", ",", "100", ",", "110", ",", 
     "105", ",", "0.3`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "8.3686`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.737261939088608*^9, 3.737261971704032*^9},
 CellLabel->"Out[14]=",ExpressionUUID->"18be95fa-878f-451d-adfa-0ea9b6a92249"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Remove", "[", "checkSingle", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"checkSingle", "[", 
   RowBox[{
   "callput_", ",", "type_", ",", "s_", ",", "x_", ",", "barrier_", ",", 
    "sigma_", ",", "bigT_", ",", "intRate_", ",", "b_", ",", "rebate_", ",", 
    "value_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"corr", ",", " ", "nMin", ",", " ", "nMax", ",", " ", "cp"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"corr", "=", "0.999"}], ";", "\[IndentingNewLine]", 
     RowBox[{"nMin", "=", 
      RowBox[{"-", "2"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nMax", "=", "2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"cp", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"callput", "\[Equal]", "\"\<call\>\""}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "\"\<Call\>\""}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", " ", "\"\<Put\>\""}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"type", "\[Equal]", "\"\<do\>\""}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FinancialDerivative", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "\"\<BarrierDownOut\>\"", ",", "\"\<European\>\"", ",", " ", 
             RowBox[{"cp", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "x"}], ",", 
             RowBox[{"\"\<Expiration\>\"", "\[Rule]", "bigT"}], ",", 
             RowBox[{"\"\<Barrier\>\"", "\[Rule]", "barrier"}], ",", " ", 
             RowBox[{"\"\<Rebate\>\"", "\[Rule]", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
              RowBox[{"intRate", "-", "b"}]}], ",", 
             RowBox[{"\"\<Volatility\>\"", "\[Rule]", "sigma"}], ",", 
             RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "intRate"}]}], 
            "}"}]}], "]"}], ",", " ", 
         RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
          RowBox[{
           RowBox[{"cp", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", 
             RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", 
             RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
           "corr", ",", "intRate", ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]], ",", "bigT", ",", "barrier", ",", 
             SuperscriptBox["10", "4"]}], "}"}], ",", "x", ",", "bigT", ",", 
           " ", "bigT", ",", 
           RowBox[{"{", 
            RowBox[{"nMin", ",", " ", "nMax"}], "}"}]}], "]"}]}], "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"type", "\[Equal]", "\"\<uo\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FinancialDerivative", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<BarrierUpOut\>\"", ",", "\"\<European\>\"", ",", 
             RowBox[{"cp", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "x"}], ",", 
             RowBox[{"\"\<Expiration\>\"", "\[Rule]", "bigT"}], ",", 
             RowBox[{"\"\<Barrier\>\"", "\[Rule]", "barrier"}], ",", " ", 
             RowBox[{"\"\<Rebate\>\"", "\[Rule]", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
              RowBox[{"intRate", "-", "b"}]}], ",", 
             RowBox[{"\"\<Volatility\>\"", "\[Rule]", "sigma"}], ",", 
             RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "intRate"}]}], 
            "}"}]}], "]"}], ",", " ", 
         RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
          RowBox[{
           RowBox[{"cp", "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", 
             RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", 
             RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
           "corr", ",", "intRate", ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["10", 
              RowBox[{"-", "3"}]], ",", "bigT", ",", 
             SuperscriptBox["10", 
              RowBox[{"-", "4"}]], ",", " ", "barrier"}], "}"}], ",", "x", 
           ",", "bigT", ",", " ", "bigT", ",", 
           RowBox[{"{", 
            RowBox[{"nMin", ",", " ", "nMax"}], "}"}]}], "]"}]}], "}"}], ",", 
       " ", "\[IndentingNewLine]", 
       RowBox[{"type", "\[Equal]", "\"\<di\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FinancialDerivative", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<BarrierDownIn\>\"", ",", "\"\<European\>\"", ",", 
             RowBox[{"cp", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "x"}], ",", 
             RowBox[{"\"\<Expiration\>\"", "\[Rule]", "bigT"}], ",", 
             RowBox[{"\"\<Barrier\>\"", "\[Rule]", "barrier"}], ",", " ", 
             RowBox[{"\"\<Rebate\>\"", "\[Rule]", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
              RowBox[{"intRate", "-", "b"}]}], ",", 
             RowBox[{"\"\<Volatility\>\"", "\[Rule]", "sigma"}], ",", 
             RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "intRate"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
           RowBox[{
            RowBox[{"cp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            "corr", ",", "intRate", ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]], ",", "bigT", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]], ",", " ", 
              SuperscriptBox["10", "4"]}], "}"}], ",", "x", ",", "bigT", ",", 
            " ", "bigT", ",", 
            RowBox[{"{", 
             RowBox[{"nMin", ",", " ", "nMax"}], "}"}]}], "]"}], "-", 
          RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
           RowBox[{
            RowBox[{"cp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            "corr", ",", "intRate", ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]], ",", "bigT", ",", "barrier", ",", " ", 
              SuperscriptBox["10", "4"]}], "}"}], ",", "x", ",", "bigT", ",", 
            " ", "bigT", ",", 
            RowBox[{"{", 
             RowBox[{"nMin", ",", " ", "nMax"}], "}"}]}], "]"}]}]}], "}"}], 
       ",", " ", "\[IndentingNewLine]", 
       RowBox[{"type", "\[Equal]", "\"\<ui\>\""}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FinancialDerivative", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<BarrierUpIn\>\"", ",", "\"\<European\>\"", ",", 
             RowBox[{"cp", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "x"}], ",", 
             RowBox[{"\"\<Expiration\>\"", "\[Rule]", "bigT"}], ",", 
             RowBox[{"\"\<Barrier\>\"", "\[Rule]", "barrier"}], ",", " ", 
             RowBox[{"\"\<Rebate\>\"", "\[Rule]", "0"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
             RowBox[{"\"\<Dividend\>\"", "\[Rule]", 
              RowBox[{"intRate", "-", "b"}]}], ",", 
             RowBox[{"\"\<Volatility\>\"", "\[Rule]", "sigma"}], ",", 
             RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "intRate"}]}], 
            "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
           RowBox[{
            RowBox[{"cp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            "corr", ",", "intRate", ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]], ",", "bigT", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]], ",", " ", 
              SuperscriptBox["10", "4"]}], "}"}], ",", "x", ",", "bigT", ",", 
            " ", "bigT", ",", 
            RowBox[{"{", 
             RowBox[{"nMin", ",", " ", "nMax"}], "}"}]}], "]"}], "-", 
          RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
           RowBox[{
            RowBox[{"cp", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"intRate", "-", "b"}], ",", "sigma"}], "}"}], ",", 
            "corr", ",", "intRate", ",", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]], ",", "bigT", ",", 
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]], ",", " ", "barrier"}], "}"}], ",", "x", 
            ",", "bigT", ",", " ", "bigT", ",", 
            RowBox[{"{", 
             RowBox[{"nMin", ",", " ", "nMax"}], "}"}]}], "]"}]}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.737262371350815*^9, 3.7372624884163203`*^9}, {
   3.7372625312618556`*^9, 3.7372626173429656`*^9}, {3.737262656834466*^9, 
   3.737262661573526*^9}, {3.7372627058200703`*^9, 3.7372628385648127`*^9}, {
   3.7372628919535108`*^9, 3.7372629136227903`*^9}, 3.73726296037338*^9, {
   3.7372631196135063`*^9, 3.7372631232255535`*^9}, 3.7372631739581966`*^9, {
   3.7372632256738605`*^9, 3.7372632334609556`*^9}, {3.7372638177512207`*^9, 
   3.7372638343634396`*^9}, {3.737263942956833*^9, 3.737264001093571*^9}, 
   3.737264088224741*^9, {3.7372641468715324`*^9, 3.737264148618558*^9}, {
   3.7372649950314035`*^9, 3.7372652404376144`*^9}, {3.7372658543233366`*^9, 
   3.737265925050288*^9}, {3.7372659568307176`*^9, 3.737266030314706*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"8b88a1f0-ff61-4e57-810b-f70c3c39f476"],

Cell[BoxData[
 RowBox[{
  RowBox[{"out", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sequence", "@@", "#"}], ",", " ", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"checkSingle", "[", 
         RowBox[{"Sequence", "@@", "#"}], "]"}]}]}], "}"}], " ", "&"}], " ", "/@",
     " ", 
    RowBox[{"Select", "[", 
     RowBox[{
      RowBox[{"data", "[", 
       RowBox[{"[", 
        RowBox[{"2", ";;"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "\[NotEqual]", 
        RowBox[{"#", "[", 
         RowBox[{"[", "5", "]"}], "]"}]}], " ", "&"}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7372631779932446`*^9, 3.7372631887443748`*^9}, {
   3.737264012290715*^9, 3.737264036918054*^9}, {3.7372641885420732`*^9, 
   3.7372642373237333`*^9}, 3.7372643624504323`*^9, {3.7372659367974424`*^9, 
   3.7372659389314675`*^9}, 3.7372660661301956`*^9, {3.7372662301196504`*^9, 
   3.737266231845823*^9}, 3.7372664566342936`*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"4bbf0f92-ed6f-4aae-986a-bb81e1eb11e9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{"out", ",", " ", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "out", "]"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<call_put\>\"", ",", "\"\<type\>\"", ",", "\"\<S\>\"", ",", 
        "\"\<X\>\"", ",", " ", "\"\<B\>\"", ",", "\"\<sigma\>\"", ",", 
        "\"\<T\>\"", ",", "\"\<intRate\>\"", ",", "\"\<b\>\"", ",", " ", 
        "\"\<rebate\>\"", ",", " ", "\"\<Haug\>\"", ",", " ", "\"\<WL\>\"", 
        ",", "\"\<FS\>\""}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7372642436978188`*^9, 3.7372642678551593`*^9}, {
  3.737264303228634*^9, 3.7372643502322626`*^9}, {3.73726604599992*^9, 
  3.737266048779959*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"4e1d1f60-3889-4239-9d04-a4480169fe00"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      StyleBox["\[Null]",
       ShowStringCharacters->False], 
      TagBox["\<\"call_put\"\>",
       HoldForm], 
      TagBox["\<\"type\"\>",
       HoldForm], 
      TagBox["\<\"S\"\>",
       HoldForm], 
      TagBox["\<\"X\"\>",
       HoldForm], 
      TagBox["\<\"B\"\>",
       HoldForm], 
      TagBox["\<\"sigma\"\>",
       HoldForm], 
      TagBox["\<\"T\"\>",
       HoldForm], 
      TagBox["\<\"intRate\"\>",
       HoldForm], 
      TagBox["\<\"b\"\>",
       HoldForm], 
      TagBox["\<\"rebate\"\>",
       HoldForm], 
      TagBox["\<\"Haug\"\>",
       HoldForm], 
      TagBox["\<\"WL\"\>",
       HoldForm], 
      TagBox["\<\"FS\"\>",
       HoldForm]},
     {
      TagBox["1",
       HoldForm], "\<\"call\"\>", "\<\"do\"\>", "100", "90", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "9.0246`", "6.744729727765325`", 
      "6.740572879009552`"},
     {
      TagBox["2",
       HoldForm], "\<\"call\"\>", "\<\"do\"\>", "100", "100", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "6.7924`", "4.512598607823676`", 
      "4.509444826438305`"},
     {
      TagBox["3",
       HoldForm], "\<\"call\"\>", "\<\"do\"\>", "100", "110", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "4.8759`", "2.596019772946068`", 
      "2.5944148394617557`"},
     {
      TagBox["4",
       HoldForm], "\<\"call\"\>", "\<\"uo\"\>", "100", "90", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.6789`", "0.333563558453136`", 
      "0.3359997323974486`"},
     {
      TagBox["5",
       HoldForm], "\<\"call\"\>", "\<\"uo\"\>", "100", "100", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.358`", "0.012670844457087327`", 
      "0.013642275576312812`"},
     {
      TagBox["6",
       HoldForm], "\<\"call\"\>", "\<\"uo\"\>", "100", "110", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.3453`", "0.`", 
      "2.6701668396828443`*^-15"},
     {
      TagBox["7",
       HoldForm], "\<\"call\"\>", "\<\"do\"\>", "100", "90", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "8.8334`", "6.416367592167305`", 
      "6.411954983258081`"},
     {
      TagBox["8",
       HoldForm], "\<\"call\"\>", "\<\"do\"\>", "100", "100", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "7.0285`", "4.611549885175446`", 
      "4.608002984074776`"},
     {
      TagBox["9",
       HoldForm], "\<\"call\"\>", "\<\"do\"\>", "100", "110", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "5.4137`", "2.9967096431319717`", 
      "2.9945920895637794`"},
     {
      TagBox["10",
       HoldForm], "\<\"call\"\>", "\<\"uo\"\>", "100", "90", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.6341`", "0.20250927277902342`", 
      "0.2047098656257904`"},
     {
      TagBox["11",
       HoldForm], "\<\"call\"\>", "\<\"uo\"\>", "100", "100", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.4389`", "0.0074092065025546106`", 
      "0.008236895863499238`"},
     {
      TagBox["12",
       HoldForm], "\<\"call\"\>", "\<\"uo\"\>", "100", "110", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.4315`", "0.`", 
      "1.0118679632174986`*^-12"},
     {
      TagBox["13",
       HoldForm], "\<\"put\"\>", "\<\"do\"\>", "100", "90", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.2798`", "0.`", 
      RowBox[{"-", "4.070567156552592`*^-15"}]},
     {
      TagBox["14",
       HoldForm], "\<\"put\"\>", "\<\"do\"\>", "100", "100", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.2947`", "0.014911666141561142`", 
      "0.015914733418919025`"},
     {
      TagBox["15",
       HoldForm], "\<\"put\"\>", "\<\"do\"\>", "100", "110", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.6252`", "0.34537561734715183`", 
      "0.34792753243254815`"},
     {
      TagBox["16",
       HoldForm], "\<\"put\"\>", "\<\"uo\"\>", "100", "90", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "3.776`", "1.4306061857827927`", 
      "1.4296587829273513`"},
     {
      TagBox["17",
       HoldForm], "\<\"put\"\>", "\<\"uo\"\>", "100", "100", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "5.4932`", "3.1478787259849774`", 
      "3.1454665796370023`"},
     {
      TagBox["18",
       HoldForm], "\<\"put\"\>", "\<\"uo\"\>", "100", "110", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "7.5187`", "5.1733731357261235`", 
      "5.1699895575915065`"},
     {
      TagBox["19",
       HoldForm], "\<\"put\"\>", "\<\"do\"\>", "100", "90", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.417`", "0.`", 
      "4.903624030320747`*^-15"},
     {
      TagBox["20",
       HoldForm], "\<\"put\"\>", "\<\"do\"\>", "100", "100", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.4258`", "0.008819519276290322`", 
      "0.00968517045426398`"},
     {
      TagBox["21",
       HoldForm], "\<\"put\"\>", "\<\"do\"\>", "100", "110", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.6246`", "0.20761650350095096`", 
      "0.20991144558084596`"},
     {
      TagBox["22",
       HoldForm], "\<\"put\"\>", "\<\"uo\"\>", "100", "90", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "4.2293`", "1.7977047866846032`", 
      "1.7964075022332207`"},
     {
      TagBox["23",
       HoldForm], "\<\"put\"\>", "\<\"uo\"\>", "100", "100", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "5.8032`", "3.371719327741122`", 
      "3.369048907483844`"},
     {
      TagBox["24",
       HoldForm], "\<\"put\"\>", "\<\"uo\"\>", "100", "110", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "7.5649`", "5.133424728571541`", 
      "5.129926386634256`"},
     {
      TagBox["25",
       HoldForm], "\<\"call\"\>", "\<\"di\"\>", "100", "90", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "7.7627`", "7.088557374031389`", 
      "7.092714222787169`"},
     {
      TagBox["26",
       HoldForm], "\<\"call\"\>", "\<\"di\"\>", "100", "100", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "4.0109`", "3.336829014624108`", 
      "3.3399827960094868`"},
     {
      TagBox["27",
       HoldForm], "\<\"call\"\>", "\<\"di\"\>", "100", "110", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.0576`", "1.3834999169033004`", 
      "1.38510485038762`"},
     {
      TagBox["28",
       HoldForm], "\<\"call\"\>", "\<\"ui\"\>", "100", "90", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "14.1112`", "13.499723543343578`", 
      "13.497287369399272`"},
     {
      TagBox["29",
       HoldForm], "\<\"call\"\>", "\<\"ui\"\>", "100", "100", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "8.4482`", "7.836756777990697`", 
      "7.835785346871479`"},
     {
      TagBox["30",
       HoldForm], "\<\"call\"\>", "\<\"ui\"\>", "100", "110", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "4.591`", "3.9795196898493685`", 
      "3.979519689849373`"},
     {
      TagBox["31",
       HoldForm], "\<\"call\"\>", "\<\"di\"\>", "100", "90", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "9.0093`", "8.465253212801464`", 
      "8.469665821710674`"},
     {
      TagBox["32",
       HoldForm], "\<\"call\"\>", "\<\"di\"\>", "100", "100", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "5.137`", "4.592947414997514`", 
      "4.596494316098191`"},
     {
      TagBox["33",
       HoldForm], "\<\"call\"\>", "\<\"di\"\>", "100", "110", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.8517`", "2.3075916170460857`", 
      "2.309709170614271`"},
     {
      TagBox["34",
       HoldForm], "\<\"call\"\>", "\<\"ui\"\>", "100", "90", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "15.2098`", "14.679111532189745`", 
      "14.676910939342964`"},
     {
      TagBox["35",
       HoldForm], "\<\"call\"\>", "\<\"ui\"\>", "100", "100", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "9.7278`", "9.197088093670406`", 
      "9.196260404309468`"},
     {
      TagBox["36",
       HoldForm], "\<\"call\"\>", "\<\"ui\"\>", "100", "110", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "5.835`", "5.3043012601780575`", 
      "5.304301260177039`"},
     {
      TagBox["37",
       HoldForm], "\<\"put\"\>", "\<\"di\"\>", "100", "90", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "2.9586`", "2.2844692948302807`", 
      "2.284469294830292`"},
     {
      TagBox["38",
       HoldForm], "\<\"put\"\>", "\<\"di\"\>", "100", "100", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "6.5677`", "5.893592540863022`", 
      "5.892589473585664`"},
     {
      TagBox["39",
       HoldForm], "\<\"put\"\>", "\<\"di\"\>", "100", "110", "95", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "11.9752`", "11.30111504858224`", 
      "11.29856313349685`"},
     {
      TagBox["40",
       HoldForm], "\<\"put\"\>", "\<\"ui\"\>", "100", "90", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "1.4653`", "0.853863109047488`", 
      "0.8548105119029366`"},
     {
      TagBox["41",
       HoldForm], "\<\"put\"\>", "\<\"ui\"\>", "100", "100", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "3.3721`", "2.7606254810196056`", 
      "2.7630376273675807`"},
     {
      TagBox["42",
       HoldForm], "\<\"put\"\>", "\<\"ui\"\>", "100", "110", "105", "0.25`", 
      "0.5`", "0.08`", "0.04`", "3", "7.0846`", "6.473117530203268`", 
      "6.476501108337892`"},
     {
      TagBox["43",
       HoldForm], "\<\"put\"\>", "\<\"di\"\>", "100", "90", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "3.8769`", "3.3328029980023217`", 
      "3.3328029980023133`"},
     {
      TagBox["44",
       HoldForm], "\<\"put\"\>", "\<\"di\"\>", "100", "100", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "7.7989`", "7.2547543654534685`", 
      "7.253888714275502`"},
     {
      TagBox["45",
       HoldForm], "\<\"put\"\>", "\<\"di\"\>", "100", "110", "95", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "13.3078`", "12.763655732757137`", 
      "12.761360790677227`"},
     {
      TagBox["46",
       HoldForm], "\<\"put\"\>", "\<\"ui\"\>", "100", "90", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "2.0658`", "1.5350982113177185`", 
      "1.5363954957690975`"},
     {
      TagBox["47",
       HoldForm], "\<\"put\"\>", "\<\"ui\"\>", "100", "100", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "4.4226`", "3.891854556988637`", 
      "3.894524977245922`"},
     {
      TagBox["48",
       HoldForm], "\<\"put\"\>", "\<\"ui\"\>", "100", "110", "105", "0.3`", 
      "0.5`", "0.08`", "0.04`", "3", "8.3686`", "7.837847507686547`", 
      "7.841345849623817`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {False, True, {False}, False}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {OutputFormsDump`HeadedRows, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 
      17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
      35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48}, {
      "call_put", "type", "S", "X", "B", "sigma", "T", "intRate", "b", 
       "rebate", "Haug", "WL", "FS"}}]]]], "Output",
 CellChangeTimes->{
  3.737264244380827*^9, {3.737264350582266*^9, 3.7372643665254807`*^9}, 
   3.737266049139963*^9, 3.737266204820121*^9, 3.7372664473592205`*^9, 
   3.7372665938403063`*^9},
 CellLabel->
  "Out[57]//TableForm=",ExpressionUUID->"afe98b94-be8f-4f2f-9473-\
1be4fe92b262"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"out", "[", 
  RowBox[{"[", 
   RowBox[{"1", ";;", "2"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7372666273947067`*^9, 3.7372666295913997`*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"fd56e6da-fe75-43ad-8bab-c311a996a47d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "90", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "9.0246`", ",", "6.744729727765325`", ",", "6.740572879009552`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\<\"call\"\>", ",", "\<\"do\"\>", ",", "100", ",", "100", ",", 
     "95", ",", "0.25`", ",", "0.5`", ",", "0.08`", ",", "0.04`", ",", "3", 
     ",", "6.7924`", ",", "4.512598607823676`", ",", "4.509444826438305`"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7372666299913435`*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"0881bb50-aaca-4abf-a2ff-870b7ab1af75"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"out", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", 
        RowBox[{"-", "2"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"out", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", " ", 
        RowBox[{"-", "1"}]}], "]"}], "]"}]}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"Filling", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", "\[Rule]", 
      RowBox[{"{", "2", "}"}]}], "}"}]}], ",", " ", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"Placed", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\"\<WL\>\"", ",", " ", "\"\<FS-atom\>\""}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"Right", ",", " ", "Top"}], "}"}]}], "]"}]}], ",", " ", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7372666332758837`*^9, 3.7372666915847254`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"c45e3381-5819-483f-93c3-59b130d71e29"],

Cell[BoxData[
 TagBox[
  GraphicsBox[{{{}, GraphicsComplexBox[CompressedData["
1:eJztlntMk1cUwD9qZVZg8hBFBrF2RKBSRARlQO3hITTghiMyEasig+HEQIvi
Gqau1akw2JSXOHTKdDgYhvkgBpgBBtU5GIEqIAmPIRBBAWXAUB4dm95bL36A
Af4d3z/N7zvnnvS7+d17zrKgCN8QBkVR+hoU9eIXPT2CPAkzPG3IGPALuOLj
eumhtj7medCRrJhzScHErAtU8OVnxltqBIgXAiWN7F/RF4vZCKjXHhOwaTN1
F/20BL9nQ1eFPscxUl2fAyebb7e7Dr6F2QyKv2hov9v5O663HChxS77plkOY
LWj1uTS2Akro0qfx1Tc43xpkzX5+F4xrMdsAeNb6lLYOYF4FUtb5+fXWLFzH
FsTlKwtiri7EvJpW3w6oXY21zxYcxuvtgSry3c9LKsO8BvIUXKNPSkcwr4WY
I+eHPQfn4zoOoHtr4GB6jLr+eyB899adnAATzI6w0Vnv03tX1flO0NOmV1nF
Uf9fZwgM/bG0flT93Xw4m1ulqPVfinkdBB5/P+zt2gWYBZCb45Vt/4SNGaA/
I/wMbwfefxlAcZsqtTeKgeMuUGFdIM/dysNxF7hwkPVLRzAHx10hM6ilKG2t
IY67gu4ScW2qh3q9G1jd8+5iJS3GcTdgqsKKV6Qtx3F3KK4xKKjz7UTfI3MH
i6bOyhJDTRxfD+nxqk5pG/ZFth7YkW7nkrPU++EBZnG6m5qYpjjuAfE2W1tU
xyxx3BNilorMSk88x/U9wULs/8OXHPV+CIGyjbzWv0W9Xz0Cu7RzN/0HiP/P
Lye2Z7OI/+IBfoLoV+J/uvnxuXPlY/yvi3P6vCeO+H8gZMOIdoczYhMw0e89
dj+D+N/WkuB3Opz47+wdf62rn/gvZjCVT1aXvfI/MLkmUt4kI/7vyvLTrpDw
EXNhSC7bruXXexOxFbAdnXP6vE++8r9Z4H1f4k7831j+YeuDP4n/su+UOx9b
jvFfz7hQL2es/wLRIcMB/D12IMuoT1TWHHnlf2Duo+rAJuK/dLFmuWEh8Z9t
1vKoso/4b9Ztv0frKPG/eogb3bOd+F8lFz8U5hH/Kc7S3I8tif+eCQ57z/5D
/O8355nWbSb+76b5fyO1mSXtIf4zE56GVgYR/5nRDhXCaAaOu0DBSUP95ADi
/wlm8LoDY/znbX/df0ua/6fWpg4yEon/Or4i98bTxP/mCpOkMwHEf7ZXvvS6
MfE/08Og42k78V+H5r9OvG3o8Bzif05180LlUeJ/3h8yiUEK8T+90vDGiDnx
v4G1WhG7bfr+c8ODBrfxtKCpI736gcWwgM4of+r9IYuBWPSzqumIQQKfzihr
6udnbwSVbzDMAQfm4XtamkMCOqP8qfeX3xTmb2T0kPPXPQ+x0DepQTJvFZ/O
KH/y/hT40cPMnVErQc5dtmeDTe84RvkzP7+Omog7Nsl5mXdt+HRG+ZP3t/1e
O76Ov2gP0m5l2cakvnGM8qd+/iO+7XJT7XOAv4U2F+PeMRrHKH/q/TFlzWdF
2SFOkKLycbW6YwR0RvmT3x+MMOXo6CgfWk89Fr+4P+iM8mfeX1t7v+9WFP7H
GtJHV4rY4xitn8b9w57/kv8q6S6ckF+uJ/15kSZisVQyIaP6k99fm23Ddvs3
uoHt9WxKEqUzjtH6mfd30VzEQSXuEzJaP/n9Jy0297it9IB9J2K5H4gWjWO0
fvrzwex8PDsfz87Hs/Mx4tn5+P8yH/8LFYuOXg==
      "], {{{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, 
        {RGBColor[0.368417, 0.506779, 0.709798], Opacity[0.3], 
         LineBox[{52, 102}], LineBox[{53, 103}], LineBox[{54, 104}], 
         LineBox[{58, 112}], LineBox[{59, 113}], LineBox[{60, 114}], 
         LineBox[{62, 120}], LineBox[{63, 121}], LineBox[{68, 130}], 
         LineBox[{69, 131}], LineBox[{73, 139}], LineBox[{74, 140}], 
         LineBox[{75, 141}], LineBox[{78, 148}], LineBox[{79, 149}], 
         LineBox[{80, 150}], LineBox[{81, 151}], LineBox[{85, 159}], 
         LineBox[{88, 166}], LineBox[{89, 167}], LineBox[{90, 168}], 
         LineBox[{91, 169}], LineBox[{94, 176}], LineBox[{95, 177}], 
         LineBox[{96, 178}]}, 
        {RGBColor[0.368417, 0.506779, 0.709798], Opacity[0.3], 
         LineBox[{1, 97}], LineBox[{2, 98}], LineBox[{3, 99}], 
         LineBox[{7, 107}], LineBox[{8, 108}], LineBox[{9, 109}], 
         LineBox[{13, 117}], LineBox[{16, 124}], LineBox[{17, 125}], 
         LineBox[{18, 126}], LineBox[{19, 127}], LineBox[{22, 134}], 
         LineBox[{23, 135}], LineBox[{24, 136}], LineBox[{28, 144}], 
         LineBox[{29, 145}], LineBox[{34, 154}], LineBox[{35, 155}], 
         LineBox[{36, 156}], LineBox[{38, 162}], LineBox[{39, 163}], 
         LineBox[{44, 172}], LineBox[{45, 173}]}}, {{}, 
        {RGBColor[0.368417, 0.506779, 0.709798], PointSize[
         0.011000000000000001`], AbsoluteThickness[1.6], 
         PointBox[{179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190,
           191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 
          204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 
          217, 218, 219, 220, 221, 222, 223, 224, 225, 226}]}, 
        {RGBColor[0.880722, 0.611041, 0.142051], PointSize[
         0.011000000000000001`], AbsoluteThickness[1.6], 
         PointBox[{227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238,
           239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 
          252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 
          265, 266, 267, 268, 269, 270, 271, 272, 273, 
          274}]}, {}}}], {}, {}, {}, {}}, InsetBox[
     TemplateBox[{"\"WL\"","\"FS-atom\""},
      "PointLegend",
      DisplayFunction->(FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.396], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.396], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.396], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.396], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], 
                    PointBox[
                    NCache[{
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}]}, {
                    Scaled[{0.5, 0.5}]}]]}}}, AspectRatio -> Full, 
                    ImageSize -> {10, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ),
      Editable->True,
      InterpretationFunction:>(RowBox[{"PointLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.011000000000000001`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.368417`", ",", "0.506779`", ",", "0.709798`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.011000000000000001`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, DefaultBaseStyle -> 
                    "ColorSwatchGraphics", AspectRatio -> 1, Frame -> True, 
                    FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    StyleBox[
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0.880722`", ",", "0.611041`", ",", "0.142051`"}],
                     "]"}], NumberMarks -> False]], Appearance -> None, 
                    BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"False", ",", "False"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& )], 
     Scaled[{0.99, 0.99}], ImageScaled[{1, 1}],
     BaseStyle->{FontSize -> Larger},
     FormatType->StandardForm]},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0.265625, 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->All,
   ImageSize->Large,
   Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         (Identity[#]& )[
          Part[#, 1]], 
         (Identity[#]& )[
          Part[#, 2]]}& )}},
   PlotRange->{{1., 48.}, {-4.070567156552592*^-15, 14.679111532189745`}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {
      Scaled[0.05], 
      Scaled[0.05]}},
   Ticks->{Automatic, Automatic}],
  InterpretTemplate[Legended[
    Graphics[{{}, 
      GraphicsComplex[CompressedData["
1:eJztlntMk1cUwD9qZVZg8hBFBrF2RKBSRARlQO3hITTghiMyEasig+HEQIvi
Gqau1akw2JSXOHTKdDgYhvkgBpgBBtU5GIEqIAmPIRBBAWXAUB4dm95bL36A
Af4d3z/N7zvnnvS7+d17zrKgCN8QBkVR+hoU9eIXPT2CPAkzPG3IGPALuOLj
eumhtj7medCRrJhzScHErAtU8OVnxltqBIgXAiWN7F/RF4vZCKjXHhOwaTN1
F/20BL9nQ1eFPscxUl2fAyebb7e7Dr6F2QyKv2hov9v5O663HChxS77plkOY
LWj1uTS2Akro0qfx1Tc43xpkzX5+F4xrMdsAeNb6lLYOYF4FUtb5+fXWLFzH
FsTlKwtiri7EvJpW3w6oXY21zxYcxuvtgSry3c9LKsO8BvIUXKNPSkcwr4WY
I+eHPQfn4zoOoHtr4GB6jLr+eyB899adnAATzI6w0Vnv03tX1flO0NOmV1nF
Uf9fZwgM/bG0flT93Xw4m1ulqPVfinkdBB5/P+zt2gWYBZCb45Vt/4SNGaA/
I/wMbwfefxlAcZsqtTeKgeMuUGFdIM/dysNxF7hwkPVLRzAHx10hM6ilKG2t
IY67gu4ScW2qh3q9G1jd8+5iJS3GcTdgqsKKV6Qtx3F3KK4xKKjz7UTfI3MH
i6bOyhJDTRxfD+nxqk5pG/ZFth7YkW7nkrPU++EBZnG6m5qYpjjuAfE2W1tU
xyxx3BNilorMSk88x/U9wULs/8OXHPV+CIGyjbzWv0W9Xz0Cu7RzN/0HiP/P
Lye2Z7OI/+IBfoLoV+J/uvnxuXPlY/yvi3P6vCeO+H8gZMOIdoczYhMw0e89
dj+D+N/WkuB3Opz47+wdf62rn/gvZjCVT1aXvfI/MLkmUt4kI/7vyvLTrpDw
EXNhSC7bruXXexOxFbAdnXP6vE++8r9Z4H1f4k7831j+YeuDP4n/su+UOx9b
jvFfz7hQL2es/wLRIcMB/D12IMuoT1TWHHnlf2Duo+rAJuK/dLFmuWEh8Z9t
1vKoso/4b9Ztv0frKPG/eogb3bOd+F8lFz8U5hH/Kc7S3I8tif+eCQ57z/5D
/O8355nWbSb+76b5fyO1mSXtIf4zE56GVgYR/5nRDhXCaAaOu0DBSUP95ADi
/wlm8LoDY/znbX/df0ua/6fWpg4yEon/Or4i98bTxP/mCpOkMwHEf7ZXvvS6
MfE/08Og42k78V+H5r9OvG3o8Bzif05180LlUeJ/3h8yiUEK8T+90vDGiDnx
v4G1WhG7bfr+c8ODBrfxtKCpI736gcWwgM4of+r9IYuBWPSzqumIQQKfzihr
6udnbwSVbzDMAQfm4XtamkMCOqP8qfeX3xTmb2T0kPPXPQ+x0DepQTJvFZ/O
KH/y/hT40cPMnVErQc5dtmeDTe84RvkzP7+Omog7Nsl5mXdt+HRG+ZP3t/1e
O76Ov2gP0m5l2cakvnGM8qd+/iO+7XJT7XOAv4U2F+PeMRrHKH/q/TFlzWdF
2SFOkKLycbW6YwR0RvmT3x+MMOXo6CgfWk89Fr+4P+iM8mfeX1t7v+9WFP7H
GtJHV4rY4xitn8b9w57/kv8q6S6ckF+uJ/15kSZisVQyIaP6k99fm23Ddvs3
uoHt9WxKEqUzjtH6mfd30VzEQSXuEzJaP/n9Jy0297it9IB9J2K5H4gWjWO0
fvrzwex8PDsfz87Hs/Mx4tn5+P8yH/8LFYuOXg==
       "], {{{}, {}, {}, {}, {}, {}, {}, {}, {}, {}, {
          Directive[
           RGBColor[0.368417, 0.506779, 0.709798], 
           Opacity[0.3]], 
          Line[{52, 102}], 
          Line[{53, 103}], 
          Line[{54, 104}], 
          Line[{58, 112}], 
          Line[{59, 113}], 
          Line[{60, 114}], 
          Line[{62, 120}], 
          Line[{63, 121}], 
          Line[{68, 130}], 
          Line[{69, 131}], 
          Line[{73, 139}], 
          Line[{74, 140}], 
          Line[{75, 141}], 
          Line[{78, 148}], 
          Line[{79, 149}], 
          Line[{80, 150}], 
          Line[{81, 151}], 
          Line[{85, 159}], 
          Line[{88, 166}], 
          Line[{89, 167}], 
          Line[{90, 168}], 
          Line[{91, 169}], 
          Line[{94, 176}], 
          Line[{95, 177}], 
          Line[{96, 178}]}, {
          Directive[
           RGBColor[0.368417, 0.506779, 0.709798], 
           Opacity[0.3]], 
          Line[{1, 97}], 
          Line[{2, 98}], 
          Line[{3, 99}], 
          Line[{7, 107}], 
          Line[{8, 108}], 
          Line[{9, 109}], 
          Line[{13, 117}], 
          Line[{16, 124}], 
          Line[{17, 125}], 
          Line[{18, 126}], 
          Line[{19, 127}], 
          Line[{22, 134}], 
          Line[{23, 135}], 
          Line[{24, 136}], 
          Line[{28, 144}], 
          Line[{29, 145}], 
          Line[{34, 154}], 
          Line[{35, 155}], 
          Line[{36, 156}], 
          Line[{38, 162}], 
          Line[{39, 163}], 
          Line[{44, 172}], 
          Line[{45, 173}]}}, {{}, {
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[0.011000000000000001`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], 
          
          Point[{179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 
           191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 
           204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 
           217, 218, 219, 220, 221, 222, 223, 224, 225, 226}]}, {
          Hue[0.9060679774997897, 0.6, 0.6], 
          Directive[
           PointSize[0.011000000000000001`], 
           RGBColor[0.880722, 0.611041, 0.142051], 
           AbsoluteThickness[1.6]], 
          
          Point[{227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 
           239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 
           252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 
           265, 266, 267, 268, 269, 270, 271, 272, 273, 
           274}]}, {}}}], {}, {}, {}, {}}, {
     DisplayFunction -> Identity, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}}, AxesOrigin -> {0.265625, 0}, 
      PlotRange -> {{1., 48.}, {-4.070567156552592*^-15, 
       14.679111532189745`}}, PlotRangeClipping -> True, ImagePadding -> All, 
      DisplayFunction -> Identity, AspectRatio -> GoldenRatio^(-1), 
      Axes -> {True, True}, AxesLabel -> {None, None}, 
      AxesOrigin -> {0.265625, 0}, DisplayFunction :> Identity, 
      Frame -> {{False, False}, {False, False}}, 
      FrameLabel -> {{None, None}, {None, None}}, 
      FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
      GridLines -> {None, None}, GridLinesStyle -> Directive[
        GrayLevel[0.5, 0.4]], ImageSize -> Large, 
      Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& ), "CopiedValueFunction" -> ({
            (Identity[#]& )[
             Part[#, 1]], 
            (Identity[#]& )[
             Part[#, 2]]}& )}}, 
      PlotRange -> {{1., 48.}, {-4.070567156552592*^-15, 
       14.679111532189745`}}, PlotRangeClipping -> True, PlotRangePadding -> {{
         Scaled[0.02], 
         Scaled[0.02]}, {
         Scaled[0.05], 
         Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}], 
    Placed[
     Unevaluated[
      PointLegend[{
        Directive[
         PointSize[0.011000000000000001`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        Directive[
         PointSize[0.011000000000000001`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]]}, {"WL", "FS-atom"}, 
       LegendMarkers -> {{False, Automatic}, {False, Automatic}}, 
       Joined -> {False, False}, LabelStyle -> {}, LegendLayout -> 
       "Column"]], {Right, Top}, Identity]]& ],
  AutoDelete->True,
  Editable->True,
  SelectWithContents->False,
  Selectable->True]], "Output",
 CellChangeTimes->{3.737266697925838*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"7c0b18da-58ba-46a4-8aae-dfdb51dc608e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Reverse", "[", 
     RowBox[{"SortBy", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sequence", "@@", "#"}], ",", " ", 
           RowBox[{
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "2"}], "]"}], "]"}], "-", 
            RowBox[{"#", "[", 
             RowBox[{"[", 
              RowBox[{"-", "1"}], "]"}], "]"}]}]}], "}"}], " ", "&"}], " ", "/@",
         " ", "out"}], ",", " ", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"#", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}], "]"}], " ", "&"}]}], "]"}], 
     "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ";;", "5"}], "]"}], "]"}], ",", " ", 
   RowBox[{"TableHeadings", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"None", ",", " ", 
      RowBox[{"{", 
       RowBox[{
       "\"\<call_put\>\"", ",", "\"\<type\>\"", ",", "\"\<S\>\"", ",", 
        "\"\<X\>\"", ",", " ", "\"\<B\>\"", ",", "\"\<sigma\>\"", ",", 
        "\"\<T\>\"", ",", "\"\<intRate\>\"", ",", "\"\<b\>\"", ",", " ", 
        "\"\<rebate\>\"", ",", " ", "\"\<Haug (with rebate)\>\"", ",", " ", 
        "\"\<WL (no rebate)\>\"", ",", "\"\<FS (no rebate)\>\"", ",", " ", 
        "\"\<WL - FS\>\""}], "}"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7372667086433387`*^9, 3.737266732301443*^9}, {
  3.737266772663431*^9, 3.7372667906155357`*^9}, {3.737266821670988*^9, 
  3.737266926549758*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"eeb817a2-d255-4998-813b-9d840c34d5dc"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      TagBox["\<\"call_put\"\>",
       HoldForm], 
      TagBox["\<\"type\"\>",
       HoldForm], 
      TagBox["\<\"S\"\>",
       HoldForm], 
      TagBox["\<\"X\"\>",
       HoldForm], 
      TagBox["\<\"B\"\>",
       HoldForm], 
      TagBox["\<\"sigma\"\>",
       HoldForm], 
      TagBox["\<\"T\"\>",
       HoldForm], 
      TagBox["\<\"intRate\"\>",
       HoldForm], 
      TagBox["\<\"b\"\>",
       HoldForm], 
      TagBox["\<\"rebate\"\>",
       HoldForm], 
      TagBox["\<\"Haug (with rebate)\"\>",
       HoldForm], 
      TagBox["\<\"WL (no rebate)\"\>",
       HoldForm], 
      TagBox["\<\"FS (no rebate)\"\>",
       HoldForm], 
      TagBox["\<\"WL - FS\"\>",
       HoldForm]},
     {"\<\"call\"\>", "\<\"do\"\>", "100", "90", "95", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "8.8334`", "6.416367592167305`", 
      "6.411954983258081`", "0.004412608909223792`"},
     {"\<\"call\"\>", "\<\"di\"\>", "100", "90", "95", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "9.0093`", "8.465253212801464`", 
      "8.469665821710674`", 
      RowBox[{"-", "0.004412608909209581`"}]},
     {"\<\"call\"\>", "\<\"di\"\>", "100", "90", "95", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "7.7627`", "7.088557374031389`", 
      "7.092714222787169`", 
      RowBox[{"-", "0.0041568487557803735`"}]},
     {"\<\"call\"\>", "\<\"do\"\>", "100", "90", "95", "0.25`", "0.5`", 
      "0.08`", "0.04`", "3", "9.0246`", "6.744729727765325`", 
      "6.740572879009552`", "0.004156848755773268`"},
     {"\<\"call\"\>", "\<\"di\"\>", "100", "100", "95", "0.3`", "0.5`", 
      "0.08`", "0.04`", "3", "5.137`", "4.592947414997514`", 
      "4.596494316098191`", 
      RowBox[{"-", "0.0035469011006767914`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxDividers->{
     "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
      "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   {None, OutputFormsDump`HeadedColumns}],
  Function[BoxForm`e$, 
   TableForm[
   BoxForm`e$, 
    TableHeadings -> {
     None, {"call_put", "type", "S", "X", "B", "sigma", "T", "intRate", "b", 
       "rebate", "Haug (with rebate)", "WL (no rebate)", "FS (no rebate)", 
       "WL - FS"}}]]]], "Output",
 CellChangeTimes->{
  3.7372667326334267`*^9, 3.7372667926064367`*^9, 3.73726682423186*^9, {
   3.737266910305567*^9, 3.7372669271607275`*^9}},
 CellLabel->
  "Out[64]//TableForm=",ExpressionUUID->"6696e878-b891-453f-b09c-\
b94547c82eb0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FinancialDerivative", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "\"\<BarrierDownOut\>\"", ",", "\"\<European\>\"", ",", "\"\<Call\>\""}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
     RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
     RowBox[{"\"\<Barrier\>\"", "\[Rule]", "95"}], ",", " ", 
     RowBox[{"\"\<Rebate\>\"", "\[Rule]", "3"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "100"}], ",", 
     RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.04"}], ",", 
     RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
     RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}], ",", " ", 
   RowBox[{"{", "\"\<Value\>\"", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7373461926447334`*^9, 3.7373461988667965`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"c593d6b4-f890-4930-8ae7-114c26b76d9c"],

Cell[BoxData["9.02456769496686`"], "Output",
 CellChangeTimes->{3.7373461995368032`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"c39f872a-764f-4138-88c9-58c8ac02fa1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"FinancialDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<BarrierDownOut\>\"", ",", "\"\<European\>\"", ",", 
       "\"\<Call\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
       RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
       RowBox[{"\"\<Barrier\>\"", "\[Rule]", "95"}], ",", " ", 
       RowBox[{"\"\<Rebate\>\"", "\[Rule]", "3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
       RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.04"}], ",", 
       RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
       RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}], ",", " ", 
     RowBox[{"{", "\"\<Value\>\"", "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "90", ",", " ", "110"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", " ", 
   RowBox[{
   "PlotLabel", "\[Rule]", "\"\<strike=90, barrier=95, rebate=3\>\""}], ",", 
   " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", " ", "\"\<value\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7373462160069723`*^9, 3.7373463725105753`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"9018e91b-ab63-4fb2-8dc6-b47eb8d96d64"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,18,21,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373462522123413`*^9, {3.7373462855286837`*^9, 3.737346318520022*^9}, 
   3.7373463729115796`*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"31a98a84-a5ca-4e54-8028-8e8a5502e718"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,18,22,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373462522123413`*^9, {3.7373462855286837`*^9, 3.737346318520022*^9}, 
   3.7373463729715805`*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"d340845b-40ed-4543-a570-2afd995dc793"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,18,23,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373462522123413`*^9, {3.7373462855286837`*^9, 3.737346318520022*^9}, 
   3.737346373051581*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"faed69d6-8d45-4368-baa0-390d4ef6010d"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \
\\!\\(\\*StyleBox[RowBox[{\\\"FinancialDerivative\\\", \\\"::\\\", \
\\\"barrier\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,18,24,25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373462522123413`*^9, {3.7373462855286837`*^9, 3.737346318520022*^9}, 
   3.737346373111582*^9},
 CellLabel->
  "During evaluation of \
In[18]:=",ExpressionUUID->"21f36d19-550b-48ac-85a7-c5bbd2618ada"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVy3s0VAkAx/HxaLuYjVZbWQ2ZSSbGFHNVUutX9JBWpbF3Zi5tygwyx6M3
BtGD0IOyJ0p6mMIppPLKSooattbJo1HaYsvWwYbJ1m4Ze/eP3/mezx8/u61R
/nJDFovlx+z/eqtq+cYNFGxaht3VLAKBxbxfrBh75q9M1hsRuJ/ucukQ49o5
CaV10wg4Kz2PjDCexRcnxdkT0AvpAM1dClo+iz22ioDCItzDrZGC6u3rB9cp
Ao9H9thdYJxelOYQGUag4Gb20L57zP+y4MmbIwSwpOUQv4lC+LPGzrZfCRRZ
ayNOMZ77Or48/QUBi/E3G1nNFIy7XOd7/0Wg946BjZZxt7ZmZqW5CVJWulem
PqTgZ0Tk5/ib4P6Gov7+VgoVQ0kxXloT+IQeXq1+QuEYO3u/7A9TlOiWjZm0
U/gSm+E0MGoK0/1jFyMZN1evSI03NEPL6RD9og4K0X8abTxjZ4Z1LStutXRS
MMxMFj79yQwbnCe4w1oK7iGD09FjBkq3V7/kJQWuUaymq4MNeVL4rbYBCoHv
0yytmqYgsLTLwWqyBF7lFhxF3FT8MKWmr9dOAtWX+pLbhyyxWvBVWs8SCeI9
itYoI77FrOAXLh8CJBAn5gWW7J2BfzfZNi+LksCs+rylerMVbgQNbC5Ml+Cw
XhnZEWENxWkBMtQS7CrW5XxWcsDN0poV1kvgW2kQleFji5rzU3q6uyVg1TWw
PqpnQxpZ9vNynQSZQ6u+EDl20CmbcuexpSCChKVRiVyEpcgvCB2kkI0+bc2O
46E/IPqkHFIcK/MP7QuZA09MSq+hpViYMpWnCbZHFm2uObpHit23ZzgS0rkY
Ig+OnjwuxeJXB1PrvncAz/7A7KoSKSYMjW1eLuRjW/vgYvZ9KR6as9VnOfOQ
X9Ga29sjxdDzoHvj+nm4XkROtH+Uwi6oo/bKqCN+CyTWf7KQYUvyo1ZBpxMe
OCguuQtkGDC4VvNcI4CmXNh3daUMCUYcg7Rrzmjargw/v1kG2YXMU6xMIc54
kGPlsTKMSoJ6k1XzEd+iiNBly9B8wjCUI1wAt2hev3+pDJ8f+cYPX16Ad6sC
il01MpSFmFc5cVxw5fnIj959MpwbcC+zyXCBZ+pMk53jMlxs3Kb8x8AVvcPF
6vbpNIqL3ovzol2hyihPvzmfRqbOa11DjytGly7fVbGWhq+tNqdhowg7ri5d
07eNxlo+X1VQL8LNV9Pu+IfQMO50+HCwQYS/pw253WPceFuh2N4oQlxCPq9Q
TgMFhe5uzSKk+On18lAaw1kuZ1oeiZA9fOfWu+00thZO9/3QI8J10os3EkNj
kpPnVq/PIoyGWecF76DxddZ6Hn9cBDJfZ/GE8WVZxe/sCRGqJxXqK3bSaIuL
8e4yJNHQZfxs124ab872t4aZkmjb13zi0z4aHjdcWjOtSHxz7dzk8Fga3Ltl
LjHWJMS9exK7GY9UHskO4JDQ+jgoa+NoaGs2ednYkXj1XdpqlYpGStWG4DI+
Ce76LfWDjPML6vNOOpIIObDYLSiBRpXz0cd7BSTeDrzlfp9IwzLPzx4LSDjO
vptbylh8ZcWaOa4klOJcC9skGqerc+UESaI0LSb1OGN3uThh0I3EcJ2PfoJx
rvfO422LSPwHroQpKg==
       "]]},
     Annotation[#, "Charting`Private`Tag$10514#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"S\"", TraditionalForm], 
    FormBox["\"value\"", TraditionalForm]},
  AxesOrigin->{90, 3.0003151442154055`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"strike=90, barrier=95, rebate=3\"", TraditionalForm],
  PlotRange->{{90, 110}, {3.0003151442154055`, 20.218026128427116`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.737346253293353*^9, {3.7373462866386967`*^9, 3.7373463195610323`*^9}, 
   3.7373463739825907`*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"b383c3cf-e491-44d3-8275-daa350111291"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"FinancialDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<BarrierDownOut\>\"", ",", "\"\<European\>\"", ",", 
       "\"\<Call\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "90"}], ",", 
       RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.5"}], ",", 
       RowBox[{"\"\<Barrier\>\"", "\[Rule]", "95"}], ",", " ", 
       RowBox[{"\"\<Rebate\>\"", "\[Rule]", "3"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
       RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.04"}], ",", 
       RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.25"}], ",", 
       RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.08"}]}], "}"}], ",", " ", 
     RowBox[{"{", "\"\<Delta\>\"", "}"}]}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "90", ",", " ", "110"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", " ", 
   RowBox[{
   "PlotLabel", "\[Rule]", "\"\<strike=90, barrier=95, rebate=3\>\""}], ",", 
   " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", " ", "\"\<delta\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.737346385360707*^9, 3.7373463896417513`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"07564567-44c9-4995-9d56-2b6945e9bc54"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,19,25,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7373463901127563`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"42506931-395a-4300-a928-bbae2dd0e6c1"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,19,26,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.737346390172757*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"266749e5-7781-49cd-b0b6-617dbc9917f8"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,19,27,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7373463902227573`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"c5174170-fe9d-4eec-aa12-9b4c5bb7a235"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \
\\!\\(\\*StyleBox[RowBox[{\\\"FinancialDerivative\\\", \\\"::\\\", \
\\\"barrier\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,19,28,25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7373463902727575`*^9},
 CellLabel->
  "During evaluation of \
In[19]:=",ExpressionUUID->"2bcc8427-88cf-4656-b18b-b42180559cb9"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwV0H00lHkUB3BbRLKxnbb3nWLW0QvT6nhP3eulovSm9MzMU0oM0SyVYmqR
vKdsK2nTrpo2RKeQWKplhFHGVpbWjkxnjXN2liO7fs+T6qTG/vaPe+75/PW9
92u7Py5YNsXExGQLnf+3f9L9pabNDA6u98+e0PGwu0LYOJ9600jBJQN1W67z
9UxqfenFiSRqJzmcJtRtdemqGdRGERvS8ZDBgWRJwIp+HiJtole7tjCoDBRU
tL/g4SlJsL1G/Q+Ky8TUV2vPjypaGVS8DN+u6OMBvTSZS9UMemRZjaj/4KF8
ofbgBergxojeXdQ2H//abtLO4I5jVYVDvTzoVZ8ItNSbll6o/4w6bZ3nz9mP
GbQ2Hs7b95zeu63cYOhk0D7WLfxNFw+BUVkbSrsZ3BioPu2s4eEmv2Z8eg+D
Xlp9fGcHD5ap4z/FUqfsmm4dQ625FGF0f87grKkDy5SPeQjS+NZpfmewfOXr
3k8f8bDNadJuTMtgP/GJHG7lgeETjV5/MmjZuf/JjUYeZCej67pGGGy2z9Li
HdpnZa/DfHMxKgvGX6ou8rB55r1Bva0YTbeUaYKSedjgOC1H5yVGz5K8xxaR
PCwKe+n8OkSM9osLU7dv5uH9jsXta+LEuK5qMuWBGw9394yEluSKsVpwuahZ
QPu+5IhnSsWo8vUpvmvOg12+dkZJkxgHD1gLb3Mc3FPO1PX1ibFibaxbsI4D
SWzVRR9ejP6OsXLDIw54ubpomZUEu5WyuetrOTiQJrsmcpBgQ6thOPIqB4aQ
QwUylGB8l4ev+CwHgGa591gJNvUbgoQKDvJZ6468BAlO+DuT+ggORl0yuIJz
EswZVYsmgzkQ2qcvqb8pwSvct6wTchDe88rDqk2C7zVK1aSIg+KaziK9ToIt
gsuhqQIO7pS7TPa8lWBY7YeHE1YcPNttsfWdjRSVnj1+bz8QeOQQed3TUYpx
JX5DFq8IdFSLBm+tk+Jpy7kX8nQE1DHyaGWoFKdJVvjVPCHww2qX8erjUnTd
7NTwupHAN5rIg/x5KcpSudKCKgKuh4SG4EopOqwtdN6rJDC8PqRiVYcUd++1
aNbkE7jRT3b5D0qxu6EwIDGDAGTPmx7/UYotaeqAmAQC+rGK0p45LEYtb3DM
jyaQdKY6t3YliwXLRQqfPQQ4b5+jNRtZXBR6qtJtG4Ejt7wDBsNZdEi33yj1
J1A7MFsVHMHi2eNHzL+kfjN71LWVeoFwInXMj8CJ5GJhiYzFz6NyLbKp07YY
jbIoFtMsNW31vgTOj6nqhmNYNIv//tYcHwJ3XPyE5DCLPwpWft23huYfWHg5
7AiL8//NbCmjdinmbbqpK3bMazpE3WBWYqyJZ1HupnYzp27uNX1x9BiLM9ti
Eld7E+hStH/3TsHiVtPEL4q9CMy6fcU8+jiL6q+evIil3qlPSOmjXqWLNbhT
awMd5PdPsGjwPhX2zJPAwIKcDUlJLIoyM2ynUttt3df0inrKr2FxPR4EItI9
XPcks/ggyPzgFeqhkSG7tSn0X9nTaHfq5UseFlVSfwyZ83QatXxnkc3ikyyW
ZUgSf3MnUJlzOPsctdmxUF0x9dgvgcZJ6qvZdn/HUP8HVYFp0w==
       "]]},
     Annotation[#, "Charting`Private`Tag$12941#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"S\"", TraditionalForm], 
    FormBox["\"delta\"", TraditionalForm]},
  AxesOrigin->{90, 1.0760296848970723`},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"strike=90, barrier=95, rebate=3\"", TraditionalForm],
  PlotRange->{{90, 110}, {1.0760296848970723`, 1.2414508136611677`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.7373463915527706`*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"b2099439-fec1-49a7-b9b6-3ae4def8e6f2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"FinancialDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<DoubleBarrierKnockOut\>\"", ",", "\"\<European\>\"", ",", 
       "\"\<Call\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "100"}], ",", 
       RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.25"}], ",", 
       RowBox[{"\"\<Barriers\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"75", ",", "125"}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
       RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.0"}], ",", 
       RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.35"}], ",", 
       RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.0"}]}], "}"}], ",", " ", 
     "\"\<Value\>\""}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "70", ",", " ", "130"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<strike=100, barriers={75, 125}\>\""}],
    ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", " ", "\"\<value\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7373464554504247`*^9, 3.737346525504145*^9}, {
  3.7373465668385677`*^9, 3.7373465735546365`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"3327dbe4-ff3c-447e-8c84-1f595bd06e2c"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,22,37,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373465267151575`*^9, {3.737346570232603*^9, 3.7373465739766407`*^9}},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"b6b6c6fe-936e-4a0a-b223-abec636c9ce2"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,22,38,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373465267151575`*^9, {3.737346570232603*^9, 3.7373465741066422`*^9}},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"b73481f7-d7f1-4fcc-ab2d-02860a9de27c"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,22,39,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373465267151575`*^9, {3.737346570232603*^9, 3.737346574156643*^9}},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"97cd88f1-380e-4c7b-9c77-b6a0b1ef02b6"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \
\\!\\(\\*StyleBox[RowBox[{\\\"FinancialDerivative\\\", \\\"::\\\", \
\\\"barrier\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,22,40,25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7373465267151575`*^9, {3.737346570232603*^9, 3.7373465742466435`*^9}},
 CellLabel->
  "During evaluation of \
In[22]:=",ExpressionUUID->"375032bf-ca13-4c09-ab9c-d13c1f39c549"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJxN13k4Ff/3AHDuTCgqVIgPkqVCUhSF3qfFvnZtdwZzsxfpQ4p20kJChUSp
VJRIRIsQQrpR1nsViawpS8gW0nc+z/N7nn73n/u8nrlz57zP+5wzMwpu/zI9
GXx8fMf4+fj++9YQn9QSLmWCgOpzicgjC9FjHRv1NtrGS1/Ww04mcgtYWryy
jAkDu4xL2o54oaWZH629y5kQODTqU98XgF53J3dkVjBB40/Jgvz4wyhIzjVw
+DUTUP/kaCqEoObL3xKOcJhgWSK40cLiHIqszlpd/JYJa1lb1+26cx7pzztQ
wKhmwsplunnOU1Ho5uHpzxfeM+F9VLGLYcNl5MEWVr7ZwIR1fp+3ZJ1MRD/U
1+aVtTLB63nZDteBOyjFa2SnYBsTHiR2/lhWdhcxU542mbczISw1Oan2aip6
smTrNLeDCdtPlb9g7riHjk5bbfvay4S48emxG9ceoHkc/1rhESbUzWZp6ynn
IBn3J/1282yhJK211PLjM/TkxiHuaQFb+PLQRitU/zmy+rjpZa6gLTSINNx5
nvIchVm+iBFdYAvw1KR649589F2neP27RbYQmVB0MmD6BcoX4QTvkLIFERPD
hVOyL5HDs0/YBjVbEPAWfND75BW6NB/7Z/EuW/BeJmq5V4SD4sd+ECvu2oJG
/MlzhfMb0bkD+gG5P23B087CQUa9BcWrvjVu2WoHswaaQ3eivqANq8bUiEt2
ED6ZbG18uBsNuLBr/VrtIOCQ3IyPWR+KX6Vqga2yB7ntiZdHNQbQu41xTT+C
7YFhMR5mbDyMVpzUX3Gg3B54C05mZO4eRbjwmWDzZQ4wwT8aNpk7hniqaulp
ng7w4lWufCDfJCo/I554JccBFubvLA1S/oVAMfFKK78jzGrYN8T7z6CWGRfm
C0tHWLa2RkL37G+ELS/7Z/CWIyyKu931/OEfJP32bOntYUeIjAj5EtLIB5Z5
5xUH9FgwW5sr0pLJD6KdavHR0SzY+Cs4S+84A5749vsXx7Age4vJ24UhDHAc
z7D8cZEF0rd0j7edYsBNIVXBXbEsqKobeHksnAHq61YfXXqVBdv3XLC8F8sA
k+NKu6+nsKCo1uVUaToDQiVk1R/ksSCN0bEa5zJg2GxRRUUzC/ZfPGF+WwGD
dqZW6o8WFny4xYv6pIhBDck6I93Kgvlvyg9KqGCQ5XNnp38bCyYu9PlcVMXA
J3LTa5kuFuzNarZK0MKg6y1VeWCABfF7/N5oGGHQUH/63o1BFgQ/jD8WbYJB
WXP6Oc4QC+Lq6slBMwxSvo0ayY2woHBStuCRNQbO88PfvB1nwbb65s+qBAZN
JtmcFX9YsMHUXDzFF4PXNtx0cz4CytRViGY/DJ6wfkUE8ROgHX3SVsQfg7g9
O0zfYQSMeNWEuxzEwCbiw9tgIQJS3eunbh3HoOrNn6oaMQICmh72J13A4KWR
zfvjSgS0lzWK5d3DoPhN5vxXygSoWKZERqdjUGoiaDRvFQF9u0WU9mXQ8ZsV
F0evIUDPcoW57iMMOFbqOTc1CNi350Tm4mcYcB2E4kp1CWAmNQ2YVdLxf3Cv
xbcQkPX+8jx7DgYfWCXCpnoEzGz7NOhShUELGXSm3oCAcWv/+T41GHyhug91
bicgCs0/4tyEwYBXKQu3JOBcrcqIVg8GQ19lrphYEVAl7BM52IvBjz3B9VHW
BCiclv96qw+DUR8Ns2VMAuIntmgO92MwtT9ZT8WRgCMe/3QZj2KABR+WM3El
YGL9izTpOQykwzW7LxwiQELn50K3pTjg888HFwQRUCiYXJyxDIehyI4F34IJ
kDRTSRiVwKEsJna90VEC3LfMGocsx2FvwthJvhD6fPbta+flcMhPy19+KIKA
Q2Uv1E1X43BnlVjW3fN0PiRqfgetwSHqwV5oiCSg2/+65h1VHHZnSXuviybA
qqLGbFgdB8Gnx598u0zAycyJLXvX4+BQAdbUdQIeaIkS9ZtxAKOkzqhkAoai
f/+q34KDKmfkUOENAkpOeozU6uEwV30nWSqFgN1c0z/lBjikNeLfG1IJ+BTS
xIrehsNYJ+eM8SMC3oZOzc80waHNQ0EqKJuAA0+7Lc+Y4sDpPZKZmkPA+68H
7J3McEj+rtrAn0fA2dta2QwLHHaORskXPSfg/Pi06yZrHOL4dxVovqL3V03c
V9Meh0uz7Q8OlxFQ0ZbtNEY7anJ/Umk5AVsT1l1+6oDDmcGowzaVBPSfn1++
joXDwWbOJv9q+v/2ZgljTjj4cx1V8t8RoGndNpBDe19t7zK+GgIE7ntgzs44
eL7Gxy/WESAknMd54ELn5zHkZfMIeLaXFa64Gwfmw9o7k00EtKrm9xXQtrpP
xaKPBIRoKgVbu+JgdON4QG0LAZZSZtL+bjjonM9f96OdgGOLhwMveuCgfcZY
XqeDAARcHVFPHDRDmhaFdBIg5yS1Kob26kNjg4t6CNiD+s+d8sJBylXzocZ3
Au4k9Rsa7cFhqXPJ9aB+Ap6cn6NyaIs6Wl0oHiBglMO5LbkXByHLfT5WPwh4
yci5+5k2bjJDJAwT4Hje3U3fBwe+HZGmbSN0PwfPmCbS/qWbvnr/GAH2snic
sS8OE1o6Us/GCVhzo+7nNdqjGpWCcxMExKzgP95P+7tSd2/0LwKee/X8Ob0P
h175wCbeNJ2PlYbT1bQ7pRmVsrME6PN2Lxfzw6FFdEVa1hwBmTnK5bG0m4Sz
48f/EODPOG5RS7tBYOsZA34SSq/3TQrtx6Fq1sn9PUbS+7k7N5B25eR35rJ5
JLCtpEtTaZeNHtnuIkBC74zRYAPtwr6rCoNCJOw97XhX5V+6P7pUxDYuIOFS
x3dVC9pP2p7ynRAmwdnApnY/7ZzmncMVIiQUPWu/GEP7IbexXWQRCSviRnwz
aafXutXaLSbBy6DN7TXt1KqR4mRREj4bzgW20k55HfqoW4wELbeMm8O0k0sX
31RfQkKgn14nvz8O3Zvxy/uXkhBafY1flLZ63tTpnGUkmKSF2crQPqg+GDQq
QcIPQ9YHRdpFaR17taVIaG7PilpDG5dvcg5aTkL9B51AddoWiVXW+dIkJIRm
Rv7neLGS7dMyJJxAxQ3//f5TZN5GfVkSXKOUzZVor8TTV5+UI+HuSMLP/67n
cyJZplSehDUinOr/4smduLSIoUCC44X9jQza0/+e5d+5kgTh9bBglF7P9m9H
xs4qkhBbP/pvG+1It/1f3yiR8NxWH+fQbvjk1jJfhYT0nIbKR7Sl7R3fm68i
Ye6n7/NY2m415qXRq0ko0CvmBdLOMIa82jUk6OWHKDBpj5Zq3xNTI0H/ode1
tbQ3b1mTZKtOAnffGhCgHZonG3VlLQl7XE+Kt9L7y1EXD/mgQcIT7B+xbNos
+RkPp/UkVMQJx1rQTkn84XhjAwkedVVLJGn3iXWbtWvR+8fKKm2j6+sw/l7T
fRMJwznPr3nSLj3xSjFNh86Hm+UbJdpCk08lvurS61nRKdtB1+/VbzdnffRI
qDkxaLyLdptb3I+H+iR8VWiVnkdbpTW8c8iABL/YZxLP6H54VuPPOQB0Pb1Y
EbGYdlPe9vijhiSoCPiapdD9J7dWJ7zIiASLoywXA9pe99SOzhmTsHiz5NUP
dP+OJy7dHWZGglXS7Ansv/4+2asWaU1fL1tCfDPd/86TLXLvbOh6eWdgV0LP
h1T/WrFFTHq9P+ULt9PWds+fvGxHQsQJ4Qmg54utSWR5EkHCJtmty2Xo+RMr
ruH0wJ2E7I1KbYb0PCuLkk/jeZDw0eRM5gN63o0KiP3g9yJh1cILvxbQtp35
GUbuISF484BEJUnH0/0iQ9iPhIxdyUw5ep5efWo47RdEQnJaTYYDk96fdTo7
rwWTcKO/49/YXThMPVgdU3mYhJg3cnnVNvR+3RReKX+MBG12cN5/81w6vN60
LoSE9ZrE1SFzun9YLkkbzpNQPqFQ17MTh3cNVl1UJAlbAmu9f+3AYdYC1l64
QALL6sWxBbRdtim+6oomQZfbIqlM32/kVL/1xcfSx5+fltOn70cpMwd1J6+T
8Kt+2mpEm74/3Yz6UPiIBP+1eFLwSro+Lj85wZ9Dgrfdo3vyCvT97WyrovFj
El48cy+qkKfng6+6f0MeCbarSv7Mk8WhQPed0Ld8Eq7zd3V7SOJQ0yC8RaKc
7scbRnLxwvS8FLiQ7P+Bnj9pJSvzRzDQnc7d/uwjCY8UfRT5hzE4NtjSN9NM
16P5BzXjIQz4uKobw1vp+gpdblf1HYMFt6ve3+ggoSlUFsvqwkBOb8Gfqn4S
Hhcd7uziYmD873lXZT4n8NJV1ZJ6isEB90eUPb8T/M4e6lbOwyDZsdHpLMMJ
PDv/Zax/TD+fIFmHHtwJ3AYZp1AWBjdFH5ulzXeCW/e7YwzSMJh4/FFLeYkT
fBL6hBXHY3BvbJWAsooTiNdKM+sDMBA4WpmhZOEEdqW5p8yUMDgxYJNpZekE
7FAVh1f08+sY9SnzsJUTyPTZFmyUx6Bjx/DDdzZ0fD33N0hKY1C0UDr7oL0T
pH5q6CtajEHAbb+8CsoJHIydU+KmGdDKWVrkEeAE5d7PFvjXMCBX0v19aoIT
2A4nffu5nwF6mJJq31UnyJUrQ1G+DKgY6j6nluQEZ1M51Qp7GND02gtyr9Pr
7xYK3+nKgOlAn7ySFCfIkJVM2GPLgG11AUktGfT6jjBD1HQYUBcR6ila4gRx
Ub/f3Zrlh6FfN34f++oE6s1+cy4h/GAksXywb4MzrL/PV+dyhA80gjd8f3jG
GUS9Hu946TuHtMSj7gnUO0MiU8++o2oGKYOhfoeMC7S3e7y/NTuF7ucmt4v7
uYC+3R8bwefjyJCtvb0l3wVEs7GZqCOjKNDGJ3dqAQWHDfSk7BMHUQz3z8xV
JwpqmHoz2K8eFK6mWFfhTPvbwRqF1h4UGmaUOuJCwZ16rcI9JT3ogGa0hflu
Ch4XR6iePteD7KOkb8x5ULDg9Xx9d8keZNVlEKDmRUFBX1Lh9tluZLTF1ZDl
TcGv7594fh3dSLfv/uDjvRRs4rosyn/Yjf7ZuXGr534K5tz28+KNu9Gy6yzx
2H8pyLtmech0XTdaNHqst9ifgqExD4F9kt2IL6UsRiqQgje2ndIi37pQ14x1
e3UwBX3HdS3rLnehjDyf0A2nKDDaqH/o0WAnursgxo4dRkEuU/R458dOlOz6
eHXUaQpUIiO+15Z3opjFU3U9ZylYVHgm/EpiJwr3kkkTD6dgfHEvn2VYJwp9
ufUIiqDgnHNa8HHfThTge1YhKZICEffMRQz9TuRTlj7++gIFN3eMRusodiK3
5e/ejkZRUHYpgXN3fieyeyN+wOIi7W9XTdsbO5CuYkrZnzgKjtobTUs7d6D1
R8sT1K9QwF+bWbZVrwOp1vf6EAkU3Jdq2CK5vAP9E7J2SV4iBR0HJTzS6r6g
ZU02X9uTKDAdNc/ZkvEFLVp7sFDkOgXyW/07d4R9QX9aCty9blCgsM+WfXDt
FzS1vk0n7iYFT+aczG7zfUHDEfwipbco2C4vOPEitR11bjJ5svwOBeZFk74a
3W2oMpaHv79Hwf4v3tLelp9Rvdu6jUvSKdi1RmVycWsrat1w3pN4QMFqdsB1
OZ9WNNqgX9mTSUFObKRa/9lPSH5JavhcDkXP2+rw7MpmpNr1+/nOXAoc09dr
jJPNaFOeY19kHgUlZ791XBv5iCxshU0ln1HQdrTAO2zVR+So6HnE5Tkdb2XS
wrA3H5Dbz+IHd/MpWLvBZY+L7wd0OO7AAs1CCrzeNG1aWdqETru/2xJURMEV
cxe+twFNKEZLxbfoJQW4837VytVNKAkLvc4ooYBY81D3cA8PpTY2V5uUUqDr
J3TLIJ2Hsu9qzca8osB6+5tXBwN4qCAwWp1XRud79tT4sW08VLnjq7NMBd0v
fKohj6V4qH7JtmjX1xT0WORvDpzkotauay/vV1LwLXhFUstnLurLGxscfEOB
/8DVNN9qLvp52kpO+y0FyoKeRQklXDRnm251tIruF99o5rsXXDRfiRFSWk1B
6tP6seO0l445ZQu8p2BE64Hx8mIukq942m5RQ8ebaCAo/oaLVOMXi8bVUhCW
4yX4sZGLNnrsheY6uj7l7mm1dnERaJf7yzdQoCqqePHiBBeZ47K3PRvp41Np
2u7CPOTADarP5FLQbhbvwFHgIdfUOv5RHgVHNg5s1dzMQ/sOqm7Q/UCBLJ0S
kV08dHppW2xFMwXryse6ekN4KKZbp3zBJwpCTbfc5lzhoWtPLv+0aaVAZ8XW
qe4HPJR2pl/x6me6frw3l2YV8lCOnaHd5zYKWjd8+RpfxUOFSrfOKH6h+9vc
5ZBIE53fsaknezsouDBmee7cZzq/Fcye7E6Kfk98aX3oCw+1xj9cNtFFwdsp
BTnzNh766iFgpN9D53Olg/1R+vxR7d1BYb0UROBX/Q9xeOg3XnCP85Xur4aT
jOw8HhLiLfmw6BsFGu18T5Ou8tCSND9B++8UJHt7mqYH8pDcoTc61/spcHEx
TLQ05qE1hgp7OgYoaFl/7vKsGA9pLzuWuGqIAg9Fjder6XyjHi7H7wcFgpJC
SkmRXGT2VONX3jAFlplvT7/S5SL7sxFrpkcouOvUv0qtrRHttqdfpn7S+Yqx
M2Afa0S+yvqR58YoeHqP3dIr2oiCxq8UvBun56tY25zZrQYUfcVUhpiigKvY
u+9dej0K9Uq5c/4XBY2JHw171tajgzqTawqmKdCyrth27VEdcm5O1ZX5Tffz
lTo1VdNapCrL5/CZnw3VRbWbuz5XIbkhh88LMTYIXrXtkSt4i8RKsjy24mxw
NPmjcSqeg6Z2OwXeEmBDZITUDg3jSlSZ+uySqzAb6mQkLtkWvUIFhxZKxYqw
4flmZ/2h26Uoy8jjVtlCNuzGPF+rLi9B8X1ijxRF2aBcsEr8Z18BinixZ6Od
GBuWL5Hktfbmo2ORJUVnxNlwN+eHWMn4M+Sm7lfds5QNKRVtSaaWecjhdzlT
QoINx37PRLGTHiPTGukWI0k2vPJ+R4VPZyP9WwGuwVJsOBfMESF/PkSa/py+
+8vZ0O932n9cJgMpbZP3/yjNBoFXct97DtxHUuJBk0L/sIEs8RbPn0hFf/IU
BXzk2FB0jBzUDklBo2eORl+TZ0N5pWnzT/4bqNe+fmn1CjbsaEzwzrBNQi0q
q5NnFNgwF1Q/kD58BdVMnlRUV2RDCCzbJtwUi8o4vAxnJTZ46u3KGuS7hJ4m
qW+IVmaDPObT1NwaidJ9Tr94qcKG3K96ZhY651CyXgsMrWID4goN+AmHoUsi
6zlya9jwLeZu2vi94+j053Bra1U2nNKYN8heEoSCHrU1haixgZ2YyE6w8Uc+
IRupHHU2qF6ea1e/54Uom6ieL2vZwKwyMD5h4Ix2KXTtE1vHhrgko6qLteZo
5+jmsW2abJC+D66K31cg3fJLxw6sZwPf/33U478y7m74a3nPrZGNWn8tIDiQ
qL3pr6c/bF/hqfPXg+lJ96/o/jXXzPjZxJa/5sjcNFil/9eFA2MVjgZ//eil
uUXE1r++E3OnMR/9tVd+aOH4//P/AMEvhH4=
       "]]},
     Annotation[#, "Charting`Private`Tag$17133#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"S\"", TraditionalForm], 
    FormBox["\"value\"", TraditionalForm]},
  AxesOrigin->{70, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"strike=100, barriers={75, 125}\"", TraditionalForm],
  PlotRange->{{70, 130}, {0., 2.5547724565113397`}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.737346528804179*^9, {3.737346570612607*^9, 3.7373465760986624`*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"a0a6af35-eb35-49e7-844f-ea04f16a409e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"FinancialDerivative", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<DoubleBarrierKnockOut\>\"", ",", "\"\<European\>\"", ",", 
       "\"\<Call\>\""}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<StrikePrice\>\"", "\[Rule]", "100"}], ",", 
       RowBox[{"\"\<Expiration\>\"", "\[Rule]", "0.25"}], ",", 
       RowBox[{"\"\<Barriers\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"75", ",", "125"}], "}"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\"\<CurrentPrice\>\"", "\[Rule]", "s"}], ",", 
       RowBox[{"\"\<Dividend\>\"", "\[Rule]", "0.0"}], ",", 
       RowBox[{"\"\<Volatility\>\"", "\[Rule]", "0.35"}], ",", 
       RowBox[{"\"\<InterestRate\>\"", "\[Rule]", "0.0"}]}], "}"}], ",", " ", 
     "\"\<Delta\>\""}], "]"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"s", ",", " ", "70", ",", " ", "130"}], "}"}], ",", " ", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
   RowBox[{"PlotLabel", "\[Rule]", "\"\<strike=100, barriers={75, 125}\>\""}],
    ",", " ", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<S\>\"", ",", " ", "\"\<delta\>\""}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.737346555913457*^9, 3.7373465629375286`*^9}, {
  3.737346600182908*^9, 3.737346658711511*^9}, {3.737346693852872*^9, 
  3.7373467587045364`*^9}, {3.73734679666193*^9, 3.7373467970819345`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"3e674f83-13b2-452a-8ecb-9425e9e276c0"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,31,85,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.737346580210704*^9, 3.737346611110018*^9, 3.737346659975526*^9, {
   3.7373466957148905`*^9, 3.737346726006201*^9}, 3.737346759636546*^9, 
   3.7373467976119394`*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"9119f3e0-8718-41e0-b226-5d3b170be8db"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,31,86,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.737346580210704*^9, 3.737346611110018*^9, 3.737346659975526*^9, {
   3.7373466957148905`*^9, 3.737346726006201*^9}, 3.737346759636546*^9, 
   3.7373467976919403`*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"e0228d9a-8c1b-4a55-8055-04ce8d6b7bc6"],

Cell[BoxData[
 TemplateBox[{
  "FinancialDerivative","barrier",
   "\"The contract price has reached the barrier level; the contract is \
\\!\\(\\*RowBox[{\\\"\\\\\\\"void.\\\\\\\"\\\"}]\\).\"",2,31,87,
   25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.737346580210704*^9, 3.737346611110018*^9, 3.737346659975526*^9, {
   3.7373466957148905`*^9, 3.737346726006201*^9}, 3.737346759636546*^9, 
   3.737346797771941*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"14a827ca-1d81-4ff6-8cc7-a9c48c9a28c7"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \
\\!\\(\\*StyleBox[RowBox[{\\\"FinancialDerivative\\\", \\\"::\\\", \
\\\"barrier\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,31,88,25823008174842532652,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.737346580210704*^9, 3.737346611110018*^9, 3.737346659975526*^9, {
   3.7373466957148905`*^9, 3.737346726006201*^9}, 3.737346759636546*^9, 
   3.7373467978319416`*^9},
 CellLabel->
  "During evaluation of \
In[31]:=",ExpressionUUID->"7d27143c-9399-427b-8895-a18a5ab1e7f2"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[1.6], Opacity[
      1.], LineBox[CompressedData["
1:eJwVl3c8Vf8fx22hZO9QyCxCqOjzrlCS4uKOcK6VpJQohYZQSkZL3yJ7K9s1
73XsS7L3bKiUKKmkxe/8/uHxfJxzz+f9eb1f79fnnI3uZ0jHuDg4OF4Qf/7/
f6vYTwOhehKQrw437FrLQCXGtjpTBLfJF68xI9j9rETdpkYSnBAKD7IgWOLp
yJHjTSTAW6ToBwluefvk9dNmEkSsTl91JThQ0S1goYUEc4lxGoEEa1DVeLez
SfAwmyrzgODRux8fBrWR4KSlrHoZwVEdBRp17SRIXlSqGifYlNe/hquDBDX/
trAF1jHQ/G6jQ/tfkIC2t3POkODki78nb3eSwCOLT+g0wbaldWd6ukhgbmrs
mUsw51wYp2QPCfw9fPRnCS5V23+f1kuCPnF1eQNhBvKkC6kl95Hgp7Jg71WC
pR53V7zpJ4HI5vLPvQSz++4fUB8kweRCncqm9QykZalwqniYBHsSh169Inj8
6qt/30dIULRDK9BKhIGiqzPjdoyRYOseB5kKgr/obClrnCDBRT9rq2RRBkr1
+mrOP0WCyjwOXFyMgUipjCHrlySoD/Cw/o/gcvHdvwdek2BTxohIrjgDedlw
RctOk0ChUCdqhwQDSUe2bsDekuCNH5PWTXDw78N7Zt4Terz87s0rxUA6huL9
2h9IwDfSTXtK8KTvsKffRxJIjne9d5BmIHhNv/nrEwkSqx/9ZcowEG+bX7fQ
VxJc0uI63CjPQBWc291sF0mgL232IlqBgbx3/Vp88I0EKZQDG9w2MNDzwmtS
ikskcOu4bCetxEB34u+56P0hAU9nPm/dJgaS9yj/5MBrD83z9Qq82sR+ks4P
hPPZg4DEj3ViOgx0eMSIVcpvD46BIbdUtjBQmE11rIigPciRtHfa6jLQrHHd
thfC9sAlzds1bsBAVWvbLuyTsYe/10e315sReu2/5eovaw/LyXcvCCMGmrt2
0CpNzh4UusWHPICBlH++kFtVsIdPM941cvsYKPJ1L6tmoz1UWi8XVR5gIHLF
OLe+tj1MWKNdDAcGWlh4MueqYw+Kgc1a+8iE/7Sxwbgt9uCQofF4lMJArNRX
2fO69vDo0z5bSScGUr39zirP0B4eP8Ryi90Y6Bv9S5zybnuQVmHFVJ0h9BDg
VlhvZw8WrO1mqbGEf1m/XSkke/jcpyE6eoeBPvgtZqXY28N7QcNqxftEP0Ze
6+qR7WGT1pndef8R9WTX77Nzsoe6uMXlb6kMZGd+5eT9Y/ZAVmSkOpUzkNjV
XzXSwfbQpi+hZzvFQHX6X1fpIfYQevSqvMhrBvJ5/8E895I9mD/UudY/zUCN
NiNdJlftoTRgHenERwbyV6h8Q4uwh+kez1vs7wzUX31O8Eksoffwun/b11ag
B9+/0JQz7EH3ZZxEt1kFit5sk+6eaQ/nvm9xWYEKFEHNn83Msockj6bbGuYV
KIDpGaKZaw9OfblRNw9WIFLE6BP9AkJftbN4MKUCiUg0vTSvtIfd4Wt0Pp6t
QDEGD4+d6LAHg9TZWdm8CnTD3/Rs6Td76FBReVmvVIkeaLXvH9vtAJ975v+o
SlQhffXv2rQ7DvAx7xTXdb1qNOdC7/adcIBvk4GiQbtq0AN1rUPc6o6waSFh
qUK/FnV22K9YajjCee+9O0uNahGf3+XiKE1H2HOxjl2wsxZdrOqRENNxhGa1
vQbxe2uRk9WFSeVtjqAV+SD1MKkWbTrZfHr3Lkf4G+umQT5bi4oLsbtBRxxh
7daOyoiCWvSRdHMfy9YR1jgJP9xaQtz/s+QHB8kRfHRUPoyU16IHiPfoTQdH
GAYTfBOzFl3oebrpP5oj6AqeKnj8vBbtXlwuK/dwBESJMvz1vha92H5/6MsF
R5D7OU5x38BE82PVLzcEOcKDbizpvDITCYe++mAd7Agn58TUbqowkd3zLX9y
LjnCCXdNtRRNJhrC2pRcrzlC8I+lvLztTPQ68p93T5Qj+Hk+3bnNhomWRo//
KU5yBDBdPjcfxETSV2N5XiY7wtupf9TES0xkospYty7VEbbe8g47dJWJQk5z
KZ9Id4Rr/NEnH0cwEQd3kvnGHEf4/p9I6Po4JhLS6Yu5W+wI7xtXb7tkMJHy
FVNl/yZHUD9yTm1vOxM5PHl8vbrZEfYt7PvM6GCiyJqlWY5WR5h2MahQ6mKi
z0vFjLg2R/jsN7PxUx8TMc+oWRd0Evvf+7LEcoKJaG7CgR+GHSHq9Oa6TZ+Z
KPrqyXHdUUc40/uM++ACE9UntcGFMUdY16Y/47vIRBpjYUJ8k0Q/XrdcTl8i
9kv6maryxhHKBtd9n1xhonvmrzqwOUd4x5We4yHMQq3uZtuy5x1BQdAl2VyE
hX6FJjyc/+wIde6CQXJiLOTKcnC79NURwsu0+cslWWirUfvS4yWiH78Sp8sV
WKhDvXTjIAcZGu+tN2/RZKEVi/WRClxkMH3su85Bm4X0PU/NeXCTAVeYuzmu
w0IJqZsrF3nJAOoWs0O6LOQtm3hIRIgMXzdy3Y/dzkI8QhEXrCXJEE3HLPmA
hcJzLF9FS5HBzqKoaMceFuIyF7DqkiZDvHjOb/e9LMR5OVbOTo4Mf/PW7C02
J9b//IhFViIDaf1pHUErFrp822nzI2UyPOcwaFh/kIX+qivGjW4k6r0VbClj
zUJ/XDNcnVXJ4LvT+g+fDQst9xVwu2uSAatkd5TbstCFM36nMrTI4K+g0xBn
x0JLQgaDb7XJsJobHXOcxEI/zKuyj28lQ1tw41tBBxZarGi08jUgw7m0K+M8
FBY6a3+9tNCQDGk/EjfXErzwZb/8wnYybCj/vM+LykJfNDrn/E3I8OlFzaVC
GgvNJQzHXTQjQyuvFJPbmYVOGicsV+8mw+imy+cjCZ7td3b7g4h6226E8buw
0Me1b/Sv7CVDZPvMlV8Ee+dlJuL7yED+dHyPD8ZCHyyO83BakGHG/5FNP8Hv
r8wNhu8n9B7nwh7SWeiYfNHulgNkWBOnY/uZ4LeVZ3P4DpLBcnNg4z5XFvJ0
MBQ5YE2GguKRg7EETy8sXbx1iAxnLV4oDRLsHlP9+rkNGZT05rpl3Vjojeal
g2uPkCH8uX4JiWC31t1lNrZkaOmQfBdD8Ct3ToU4OzLQVTZU1hFMX22K6CGR
4dZp8vwswVOJN+ZFHcigyt0UJuzOQpiJFdnekQxWPB+7dQieHBDCH5CJ/XV4
aFkT7Hy2S32IQoYYdQFuOsET6+7ekaaRYTj0o4sfwU759r+oR8mg3tx96SLB
Y5ZS7glOZNiUxFcVRPDR6ZHn485kuM5/ffr/10evJhpswMiwM9bt0VmCqQrY
E4xOhiqG1yYPgkeqlHlTXcmQef/H4CGCKY7Tvq/dyFDP6dehS/DQ16yhTR5k
cFFMsRIlmBzrjTw9ifU3tSb/f3+DWtq5WcfIwOyH2UaCTdtmj/d6kSG/maoZ
S3DmsXz1f8fJsF5pscWZ4LXcPjMaJ8iwIi49rELwuVTNHAcfMnhe49b9SOg/
YfbRK/Qk4efb/9mmEbxvPHfzs1PEfPX1FVMIFpPSyOY+Q4auLYvfq4n+BpfN
HNP1I0OA55rnGMFvbHPUnM4Sfhp+TecluOT25qzSADIEeZtP7yL8IqP53nPq
HHHdoCjyOeGv0NYsVcFAYn+rHPMuBNtyqmW6XSTY6U26N+HPquS3HjFBZEih
n6p+48RCyqaZKtXBZOL9pHHFheAvgSoZIpeJPKgeerrvKKGPxLS76RUyxIkq
emUR/q8rSd/kfZUMWqyqbCGCY+c2puPXCP/8EdFvJuZn6dZrt09hxPyJpe6R
IBhTT9soHUHMk+Y47k5moS3uymmnb5Bhz4kAgQViHl8MK6ZuuE3oyfZDrcT8
Gp6foltFk0E42cFhhpjvJ2LJSudjyPBm3HtYkOCTNhtSXsSRQU9HqN3iMAsJ
NsknhzwgwyV+scu+RH74u4675MSTwcR2tvk4kS9j/xI29D8kw0UmdyH9AAvl
mcglaT0m+tUXZmlmyUIHCmWejCYR/jh97nw1kV/F1iNOvClk6Ej60XeNyDeZ
j//Jb0slw3eTUc3DiIVmVKQTb6aTwYh9On3QlIVuPJZMMM4hw7YrO/wTjFmo
KULsUXwxMQ8NMVvliDw1TVxTPlZChup+t6tntFioomSlW6mMmI/u1pt1GiyU
PzXLn88gg2t9y/l9aix0z6TpQl0NGfoafzzmUiTmdy6AMtNMhv9iGzvNiPNg
gssnQKeV6MfUy0y1tUR/ZF3jzrKJ+X7su2WdIAsdtDzE/tNOhn5anHYNL5Hv
qarGIt1EPsd8KWv/y0RcDoNSO0bJwN+cIp74kYku+XToXxkjg/ds0zeZGeI8
Cm043DROBvHTxXJRb5lotqDghs0Usf79ZV7Pl0zUx39jyW2a4OI9bxkDTJRW
azQUNU8G6fuqC2vrmAhUHsVPcFLAuN109PxtJkrfeXvNWm4K2Ips4jhwk4l4
SVdCdvFQYHtYnKvkdSZ6HurplsBHgesiI7IpV5jIfkpvC1WIAs+kMt28zzKR
1+P25n4JCizfe9LZ4chEMev/fHuuToE5VZmHY7JMtLD5s9dvDQpIdew1eSvJ
RKTdr0c1tShw5POjZ7OiTCTly8Zv6lBg58Wt198JMFHq8/u3LbdR4PzWL3nX
f9Wi8us6Ko07KRBepbYpergWjf1xIVXbUCAsYOTIeGwtOhwduZHrCAV8Bfn/
Y9yqRU0KJQsHbSlgKcz9OzyiFj0z44mbIFFAL970oEhwLbp6Nb9jlUKBeE6K
7nPPWqTK/dPc0p0CL6bPLreb1KLTgneM+wMpgFWZfVYbr0FvEqr5FC5SYKh0
6rfgYA2iaE8PegZRQLvGTnOmqwbBIaNzSyEUmHeRfh7VWIPEYyeKZa9RYPIU
Ze+FvBpUJaqp5XqbAiy6ne3U+RrELduoMJ9CgWme2Z1f1tSgZnW7L7ppFLD4
zVn1j7MGRRi9avBPp4DMg+bBNX+qEY/DitdyJgUEKaQ9/PPViC9uZwl3PgXi
3E9tLOipRmt4yyzkyimQsjnOMuphNRL+mnF6fxtx/XnxCYZCNZJrv16ftkAB
7uXDEk/FqlDTiOhs11cK9K0bjD0vWIVOfUgS/7tI7N+hqdqMqwqx+Cu8yD8o
sKOslF37tRK5Wr5fK/SbArP+rVd8eipRTpMl7Rw3FVK5BebSoiuRYR3/oqUU
FbRVoxpxjkpkU3ZLZW4XFUh2DjFBIwy0xvRQnr4ZFY4KoVLhLgZqbhbWDdpN
BabRm5WEJgbaOXR/J98eKlic019IKWSgzb+S7JQtqVC6PozzaAQDrewuvepg
S4Vv7c4ZCcT3XuHzsXGmJxVihs26Gk+XoxP2SW7cXlS4HuYmdNi9HKlO0Ges
jlPh/lD51LRjOUqYf7s4dIIKx6RyU/XMytENkS8CX09TwUiR/4/12nJEJ3Ob
qAVRIYvElXH7WRmSe9nCOhlMBe9Cu9T61DI0dPzmvtIQKhR8OpnGFV+GDgWt
O4KuUEFjyjo753IZMnki7UULp8Li1F+1s0fKkMgb7QcxMVRos8r52/CzFJWf
/ORXF0uFaUGBye2fSxHlR77NlzgqiBpMv+h6W4qS12jx292jgn3aw0MX+kqR
jq5GsMR/VLC9dCzlelEp6qmaIVs8osLtp3lv1XJKUcDeHIPAx1RQG7IdX0gu
RTWOm+eHE6mwwLIe/Rxbig5cUnVNTKXC4/LDNgV+pWiO963pizQqRHGVzIWc
KEVxcRmy/9KpYMg69cnXvRTpy3osbcmkQoPqs7rrTqVoKH1TP5ZFhWCeqY1N
DqUoWOdNUVw2FdpffEgdtSlFGyrSoutzqHAhmHlDwLIU1SO3E19zqbBXXpCB
zEqRZ7uy5aZ8KjQXjE5FGJSiNfavNtk/pcJdbW58WKMUPZ1IWQ1/RoWmcbb4
9g2l6LAXfaK8gApzmf9dTBQpRYtfFKvfFVLhz+tPz0S4S9HDoKl4qWIqSP8r
97n3vQTt4E72319C+Mt5nn/DuxIUKrVBJ6+MClp4yCK9qQSppk6sGSunQl8W
K0+spASxNZ+8E6ygwozE9tX+pBIkbCafcqqKCqdiedaGnitBpa1jIUnVVPiZ
XzngjZUgR9sEalcNFU47tIe47i9BTzxkxfRYVKjPmjxzRaoEwfzIZ9c6Khhk
4BeS/xaj6cBHHXdxKqy7MKXS97oYaUVJX//WQAWbOflHx/KKUVWx5HJFKxXO
zvdYHt9SjJx3Dg7MsKmg8CrN8JZwMVptelAi006FhKQGraLpIpRu4xBr9ZzQ
azHncGJhEbIcFj8Z3EEFGB9Z6b5chGZd+/c/fUEFt5fcq852RShm9p7qRCfh
/1Nv9u7QLEJ650ic67qp8Ogw29aNtwgN/BOdMuuhQmz96JXhd4XoYmRvzele
wr9c9WnJzwuRvOjd/1L6qFBZ4dVdVlaI6hJsz/X0UyHT6MwzvrRC5K4qYsc5
SIVlpe0GBfcKEV9h9xb9ISpgzL4vSTcLUZ5xnKDHMBXkLOlfusMK0aGGwzP3
R6iwIb714ZFrhWjhoHBz8ygV4lZ9PaUiCtFLkkHmlzFCzyGhlaWoQtR1lBoh
N0GFwY5wi8/xxPrulz0tJqmQ6zS18iuzEBX4pJv7TRH58bvhnlpVIXriz1ZN
fEn4sfgsdqa7EEUHz/G0vqLCbPCvEvZsIQoJE3238JoKfm81Mk0Fi5BPlFGL
/DQV+NV4UfOWIkS755Rl+ZbIE1PRCDfHInQgIfT62XdUaJFpmpK8VoSM07OO
PXlPhYpjxqYjxUVoc/5zC/YMFbYc3EDWIvojWfpFbfEDFfb10lJk1hQjnhoJ
vg2zVLCaxY94yhej7w073u//RIXayMjfp7UJf7Rjrf5zVNghUL9qYVKM+nrD
s5PmqZAhNc//bk8xahzNvdH2mfAv/dKS1YFiVPK60+vbFyooxXl/DbAuRqkf
Fy0Vv1IhQM03/zTBcV+l1a0WibzgvP/LgLj/yi9T/nPfqNDdutm4gXieL6f7
TPJ3Kjz/ri8nT6znLBDJbv9B1BtBZ+8m6rEWfZbzfYkKYiGPFbcR9e6U7Y1U
Wib6r1NxeYGf8O/GpeMHf1Hh4vEZj99vipCspvyB878JP5P+/isrKkJrtoFG
6h8q7LnApK4LLELLJsfWdPwl8ifR7djK9iI0A1Effvwj+v/b7MDDL4Vo6EBR
m/Iq0c/TPHad6YWoxXYg15qDBowH5euLjhSicuqvm4GcNPCM88zXWipA9733
Wb3gpkFH5ddaSb0CFObnrfmTh0b4dWpfTNMz5H8xRmATHw38UhqGs2yfIdub
w+0X1tDAtmlN7UnqU4Tu/M1LF6DBPOXSQYnJfLT10caoTkEaHPj29hvLOx8p
plr6LAvR4KHqaKD/nzy0LvfkQZV1NOD72FJpEJ+H/hbd0TosTIN+RV/zT9vz
0FwlQzBoPQ1+V37gLpjMReP42GyGCA3q54dDAqJz0XP26vMuURrkGUbv3bY3
F1V3qz79JUYDtfd9FcsrOSh32Oq2qgSxXtYOYbwxBz16efrkEUni95zmJmdj
clDkzH3rYCkatLnXZ+jQc1DglyrtLGka6K8Uxbw0zkFePyeFemSI+oZW9t+S
zkGOq1xzv2VpULEsRN6yko3M+TVeqMnT4Ifbruutn7KRwXqbZ7YKNHjPLx1g
/yobbZL2jw7ZQIMPf+lHhsezkajSf6eyFWnAMVc6bjGVjTjUmYd6lWiQjx9c
yZnJRl+2vtb5q0wDsfEv3as/s9GUEd869U006PMbTzZbn4O6dmvP26nQoFf3
QorvlhzEsrTtvKRKg3HtfLfbpBxUx34q0KBGAyWy96fksBxUf4DfkledqC/w
jX1/TQ5qaHcPs9KggfCOmqNb/uSgxoN1dTGaNMhNeLlqvi8XNXfI/unVooHC
jpo/OrdyUcuh88ZSOjRYkkloMWvLRa2dPQFHt9Dg4w21vSEceajtsE5x8lYa
+I8S71Pb8tDz7si5N7rEdQGRMzHOeajDdlpDfRsNzGdXW51D89CL3t3HTurT
YPL8TKlHUh7qIiWkFRkQei8J5haU5aGe/h+T3wxpIGko3STXlId6HezkTIyI
fn3TQW0deahv8Bn5kjENnvovbsnuzEMD5DX3601oYIS7VXe25aGhYY9unp00
GN0Sl7GJlYeGqbiQ1S4auNZVH8fz89DIqNyBGFMalLyX+RB/Nw+NHQ2M6DWj
QYGuVGPh2Tw0Md5bL4loYNo9W8tjnYcmnbf8owENfm6q8s/ekIemJm/uSN5D
1BumcSb8Yy56hb09/2YvDS7/9ZPOKMxFb16i0s3mNPiKb6DI+uaiadfEzz4W
hL5ha1XYqrno7eslrSJLGpyyHhtvHMxB791Jx7/tJ/y5s19TODQHfZguyDC2
osGTkcd2mSo56KOnwKuQgzQYUunIuVafjea86qk8NjR45DJgnPsrC32ekY8/
cJgG4cmiZ8yeZKEv3hd6o4/QYLZIeWpgbxZa9Nl6UJJEAxH63FGBJ5no+6db
N2j2NFC1eilUdDgT/Tj1rjHJgQY1wyfYB3kz0fLpJ7s2U2iwUeTjj8grGej3
l58XfKg0OJOTk6K+JwP98bMvL6TRIElfj9XAn4H+fi1cWDxKg2HalCm1Lx2t
+AtuMXYm/HJD5Ox8ajpa/XbsRIgLDai/MmVDAtIRx/mGLByjAXe3Bd/ag+mI
a0nhDbcrDc6ZTY1Hq6Yj7gsXFQ+40UCCsuIowJ2OeJb7j0a70yDnttOeoHdp
iC9I978eD+L5pI59cx1piP93VL/EMRqIHhk4bF2RhtaEvF9P86KBstKar9mZ
aUjw755DScdpwOVDtvr+MA0JXU66+dqbBuu8SNo7Y9LQ2pXlZjUfwk+vehN8
ItOQ8FUHTp+T/9c/wPXR9TQkwlFsVniKBjL1h15JEddFrwkFL/oS84ec9J4S
LMZ1vMLoDA3SBA7cu34jDUmENy4G+9HgZqcxV3Z4GpLiUdTFz9LAwW8li+Nq
GpK+HnSSO4BwVL7TUN7FNCTDN5iz/xwNHs+NvHvol4bkIvXe3j5Pg93/Bubr
vdIQj8CtCzWBNADFY8f5nNPQ56jXgh8v0OCv7uOItiNpaGTtzmTpIBp8073g
tX5vGmqMvbfNMpgGdiN81D79NPRM5FPzuRAabOUZeym8KQ09vLePmnGJBtFV
O9JfrE9DJx5+v8JxlQYhp3zJve9TEUnGRkw3lAbimx0owj2pyDQhK8vlGjE/
4+oH+itTkUgy+UVNOA3cVJWLR8JS0W+lIvrHCGI++FrjZL1S0ds0/m/SN4h+
dM4mv9ufiqqyqmTP36SBe8yA8He+VJSuLlqQcYvQx/rU84i2FBSddwL6ooh8
9074vDE0BbkWyB3XjaFBVfTfh+feJyN+xqXyj3dpsNbvQbZNdhIiN8MRLJEG
OkakC9YHEtF9TrsavQYaCPy7n1EB99GT+vXJOuJH4QfJyTOxiIruiW11yvM4
Cj9j/O6tC7+DZyUTX7GFR+FWaqPK5f5UfP+ZW25qHE7w7o6o0SuNfJwvuDVf
9ZATZIeL53EcK8FLpT06Mx86QR2+htYZycA//0r6FzLjBNu26fF9H6vGLaVk
5z/oO8PJ+Nj7WUUsfOsF/dlnEc5g9Gd3uEVbPW4gFp3N1+sMP+J32bmdbcTV
wML0tbwL3NUTGqZ9bMIXkvq4Nm9wAcao9FbnL014zR96u4+iC+it2RXi9KMJ
P1wZTP6u7AKPwSePxNmMB24t9uPf7AIsoxdPxWSb8VYF+awtei5g65IdKHKg
Gff6tbAu2NwF5qr1UpkZzXhO6ZOXYr4uoLS9rnUbqQU/Kqr+b89pF2DzHXdb
T2nB1/qVyJ094wLP8jSzPju14H5bWh27z7pA6Kkmo8fHWvCduV86bge6QEi1
rEf7xRa8K2lvFU+oCzz4KWV0NbkFX7r54c7SPReonRzlVZhpwS3ohnvHqlwg
ueeGmO7JVjzA1qd0WRCDKmbYS4NYNh6RfUd311oMXnGo/om/x8Yf/K14dnkd
Bu+Tu/S6H7Lx8lzuHC4RDKI1l1KYyWy8eUVT1UIUg+3Kgob+6Wx80ME2LVIM
A49b6XJc2Wx8iSMpca0kBhmW2RVPnrFxPkqTzBEpDG69Dh7JL2Lj0gUf4+9K
Y+Bi+Er4bikb1+AWER+QwcB88WPRAQYbN6EZ3ZGSwyBURaJ9tJKNHyhyXkeT
x2DvQhpzRw0bp/GGRyUqYLDrV0Z+IJON+zjl8U9twOCU633hW3VsPLikO0JZ
CQPnhbkg33o2HsW/xOmhjIG/4Le7Go1sPNFF4WrWRgyELOdeMZrY+LOyvX9n
NmEw5WExp9TCxpkCJ4K0VDHo+YuzXVrZ+At63NIpNQx4+dhT7Ww2PsFgBBRt
xuC1yVmbhnY2Pic0sfBVHQMZJ50Sqxds/J8b12lDTQyWU9TPu3SzceEqjU+B
WhgwiqIiOPrZuKLwEe9qbQxyH7WlGA6z8a2e59/90SH06Kg8ujjOxnfXJLrv
3opBznh6BXrNxg+LNL4M1cVgqfKYt/wMG6d7fXBu0sPAorEqI2KejYeKbacc
MCD0Xzh1iOsvG7/j7TQQZYhBYvMqQ4KnDU+ru2bXuR2DM+Z3zxStbcMbfbqs
SSYY1Mr9+Rmv1Ib31X9ve7ADAzH13dXTmm34tJS85fBOor+GqhOlhm04T9Nx
cDbDwOlm8SvOQ224hGwsK3k3BrjS0PgVahuudqZ852uEgU+gWun1Y224pTzn
dq+9GDz7mRBtfK0NjwxI0PTbj8E9DvZVA7wNf9Ren116AAOrpwM64j1teK7S
jMoPKwy08otZQa/b8Krz69KMrTEQ5pcZ8//Whrd1GCgGH8KgiKrEW8fbjo9s
PJrItMFgjlOoS0iyHf94IVRm9TCxvoJzt4hyO/67Mzt+jy1x/17diwOb23FB
1U6xCDuiP9rtRVTNdlwu+FtcKwmDbpW9zQnq7bh2j+w6AQcM1FniIikb23HT
zRBl7YiBgml5qbt0O37okhd/LPn//t7fN7OmHXfui47ooWAQcDtrZctSG+6r
UcYpTiN+z7/9p/7LNvzKldErjkcxoOAuV1ab2vDYgdU//zlh8E2Tc/2DTEIP
bZWeZmcMNkXoXQwIb8NDwywzv7pgoPIw2TgVa8ODRk9cVKRj8Llzz5ySURvu
rxdzyNoVg6iDd3p+CrThJyOLlS+6YZAuY/FRcYyNe071f890x0BR/sXaFGL+
HKPlklY8MWhEHr8fGRL+mTY7q+1F9Kvm/hnJpVbccqebBfU4BnocO31ny1px
kw858yUnMNhpFJD6RLUV34Y6GqZ8MNBe6OUPGm7BtR5+jhc6hYHm6+uRRTda
cAXz7buPncagmCkZpjLWjEsmUsXuncFgtfd+qfeVZlx4MeR9nR8GHIczCnmV
mnGO1MZYmQAiP6IWrpEdm/BfS+/cLc5h8GHpkZ3Qp0Z80UbA2P88ofdz7uOU
G434bKaOUEogBteMNs9l6jbi03+OvOy4gMGKnMzo8vsGfIIUULZ8EYM9tCe5
ds8a8IG8h5FqwURejLazsq824J0cNU6kEAz0/64eWHZtwFspk7pXL2Eg7qOt
fdC2AccLOXieXSb0E3UvirdpwKt4VUdGrhB+M+EpHaQ24CXO+5/xhhL+CFGy
E/FvwPPLfEL1r2Fw/oKTjfHjBjxDMNaBHkb0Ty0K2XU14E/cSjSiwzGQSG6m
O4s24vFVA3+rIjAQ9D3U4uDeiMeuX+55dx2D8PaKZZOGRjzSSz5LLBKDs29j
DvBsbcJDWbuD0E0iL3S4dpTlNuEXJdxtTt3C4Hhr7K0D25rxsyevb3wchUEw
d9GJenYz7tOY+6PlNgbsfgs96VMtuLvsi/bFaAyGW7ldDyu24k5+X5KUYjHA
/gn6uky14g5sMf9DcRi80df4YUHksY2ikWXQHQxsNlTWCN4k5vU8TS77LgaR
35R708624yYqqY2r9zEY3c9fZHG6A98W3PRQJ57Yz6WEWYdrL3Ct3vc+tIdE
3srPMHTSO3GFq1vEyx5h8LD+acoTvh5ccsh25uVjDG4evvuh7GkPLrzlXO3a
RAz8YgNaiii9+OpYjYdXEgbephcOZdf14cvbpozvJ2Mwdkn3SItHP75wk3Nt
fQoG/wkuzU4t9+MfX6q+mksl9JC8o/718gD+xuhAuWw6Bn8Mkt4JfBvAx2NO
3rTMIPzYsN9WiTqID7yNdQ7IxEC68HT0joJBvHNXqV5qFjGPYwqj2OIg3npv
kKczG4MCryXZaPUhvNddd7t4LrHfl+X92keG8An9W8doeRgUBoLIes8hfIZr
Oj4ln8jD7KNPTb2G8MU+09Z3TzEwPfLDN9dxCP+X/nBJu4A4P7Gg0GP6Q/ia
gIXN/oVE3j8zPe7zdxCX2HeQUlWEQdtW+4LmskFcSTwzcqUYg4PM+JELRL1a
0/8qzUsxkJu58zRkdgA3KqN8iCrDwE3v2LaREwP4nvASmd5yDDpDujb+N9SP
H7IXspKuIPxwcuM2hl4/TlE5FuRSiUHY6RVj44t9uPu3uryMKiJPdWT3KxX0
4r5NMmMfqzHQ+PLunF93D37xvr+gXi2RF0OXSR513Xi4x4udgUzifJPtxfCq
TjzWYPNJJguDSzLB53ljO/DM/tGOA/WEP45X9dLbW/GiDIO/sQ0YNJQET17U
bcZrAmJ0Bhsx6Ct8wBHv14D3iu+JcWshzhd4aNglVIlPTCewcloxkJI8j1kb
luAfyr7Pz7OJ+RzbkaOUmIN/Cz+saNiOwVE1yXNSWCK+Yp97OPg5BlsfnbnR
fScMF1DlulrfQeTBxbByV51LSOK7UxFfJ5HnWQEzpU/ikVIz4+WhLgzywovW
UozSkNaD9SL3uzHYNjunWczKRts9T8BoD7HftMHEMM+nCAyb/JT6MOhvTdu6
rFWErHk2pB3rx+DXwERD0poSRB4I7H06gEH7r8DLRUKlyC2zh3NxEAOH680P
upJL0alzWvomw8Q8/7v/grexFF00j3C/MoJBUMbExZPnS1G4xNS95lEi/4w6
aeLVJSj2rXGT4DgG5bgrXTCmGCWU3/1mO4FBvNygZv+bApQV8Unlv0lCX1+r
6asv8lCxg4XD5BRRH3Vht8lwJqpVTYlQeYXB5L49YW58yaj1+3L5idfE+j96
RvjT7qDeZtK7ojdEfdesddQ+UdDEg2eSS9OE//Ljgp/Wx+IznnyWpu8wOME6
t+bNv1R80dA1MOw94Zff3Z3PNJ/i/3hqsttmiDwe8FQolC3D1wyKDwt/JM4r
7vnLPuuqcfEsX37HWQx0l95o/zmD44rn2caJn4j3lVgTRoZyE24oGfJI/TMG
z4dkUlTin+Po3UCb7xcMhnSqWv0duvCDjK2/yhYI/cVFRb587sEdr9/U/P2V
ON8oNR8qH/Xhro5viI8l4n3FV6IgQX0AP6lmGnXjOwabeeIvJiUO4oE/4mte
/MCAnhTqyPo+hIe1fJkV+0n0q03LZkV/BI+Jt5KnLWPA7Z5b6EsexUO9UtNv
/cKApC7x68jhMfyc8U/Nmt8YjOQfk+/dOo57rzlcMvsHA0sjo7P/fo7jzqOZ
JvL/MPgBGs29eRO4bf4f3HqFeL9yODNANp/E94WQ9l9axUDkztrq6+xJ3OhQ
XtczDjqY6RrK+RtM4VobOMiTnHSYLN1tInpzClf8TJ5cx02HDwu/bQNapnBR
vMBzNw8dOnQGFeM+TeE8d3jmTvPSwXl+JNTv9xS+7OoUkMJH3G9UtlZucQqf
21b6u5ufDrtcbq3G9U3hL7kEwjgE6HDttO76vsQpvK+fLrBNkA7Jo80/3tpM
4a2ZFXfchOiQcjOWq+vDJF5zfp3MvbV0GJ4zaYg+NYkXWHqmNK6jQ/Tkwxtb
RyfwVOnazd+E6TBdlMBRtHUCf/BBtFBFhA6F7xJDhXzH8ZvV3tsdROkQu3Bj
xP7BGB4ShTMjxOiwDRl+jckcxU87SZkzxOlQ+mgwLTdpBHfX8e14J0EHGb2N
RfjVYZz8r4kkJUWHTBFz+5aDQ7hVl9yYpTQdJO8UTyhwDuJ6fm0fcmTpkLso
KXr8Sh++WqbC56NIB5K3kfKGiQ58MSI4JkGJDgpPBDpym9vx9469Eh3KdDjK
Mf88nXif7/p5RUVHhQ45N97z/VxswhvbBvOdVengsdzab6XZiDMe6+jHqNGB
bi8vyRlQjz/ZNQaf1enwr/ikEflaDX5n7bY2RU06yB704la+VYmHT0YeOaJF
h+096UYFleV4YOHU0FVtOtxVGdn4dW0p7nN1O1asQ4cb5tjJFtEiHLONfvdq
C9Efe35jLko+brdx+pSoLh0acgInb37Mwk2a7oT4b6ODpdId7jtzibjOgxmu
DH06TLXkBvW+eoArHdsd1W9Ah7GEOIe7U9G4mFG8KM92OpxxjBFl6l7D+fjn
HhkaEc8re6Ex2++D/x7eq3zMmA6LrEYxszgHNJ/7OCfehA5hVYyhbQfPo1dB
C1tbd9DBxPbueGPENTRwcH/F0k469BZsvaWwLRK1ySebqZvSoeaH3boj+bdR
7dz3ZooZHcIxU4mbC7GokGV96OZuot/lKZf/XLuD0mPT+6sQHcQDt8edWLyD
vKpCa38QvGeHpF7E0h30P4rTWe0=
       "]]},
     Annotation[#, "Charting`Private`Tag$40115#1"]& ]}, {}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{
    FormBox["\"S\"", TraditionalForm], 
    FormBox["\"delta\"", TraditionalForm]},
  AxesOrigin->{75.0006837761691, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}, {Automatic, 
     Charting`ScaledFrameTicks[{Identity, Identity}]}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{
   "DefaultBoundaryStyle" -> Automatic, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox["\"strike=100, barriers={75, 125}\"", TraditionalForm],
  PlotRange->{All, All},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.737346586188766*^9, 3.737346617156084*^9, 3.7373466618465447`*^9, {
   3.7373466974269075`*^9, 3.737346727676217*^9}, 3.7373467656516123`*^9, 
   3.7373468036490016`*^9},
 CellLabel->"Out[31]=",ExpressionUUID->"649320b7-dae1-41d5-a15c-98f78564a275"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", " ", "\[Rho]"}], "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"\[Rho]", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", " ", "y"}], "}"}]}], "]"}], ",", " ", "x"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7373526909147253`*^9, 3.737352732616261*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"af01661c-9605-4ca9-a879-e51e9dc71943"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["CDF", 
   TagBox[
    RowBox[{"(", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}]}], ")"}],
    Derivative],
   MultilineFunction->None], "[", 
  RowBox[{
   RowBox[{"MultinormalDistribution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Rho]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Rho]", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.737352733108266*^9},
 CellLabel->"Out[32]=",ExpressionUUID->"7634e26b-18c9-4e82-a53d-41979a346852"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1389, 894},
WindowMargins->{{Automatic, -1583}, {7, Automatic}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 195, 3, 35, "Input",ExpressionUUID->"db3d923a-a50b-4ca2-ac5d-4031c2b69046"],
Cell[778, 27, 241, 3, 39, "Output",ExpressionUUID->"08e1268d-ba25-4158-b6a2-88e7f6cdb9bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1056, 35, 161, 3, 81, "Chapter",ExpressionUUID->"3d07e8c0-4533-4f2a-b3f8-d00ad46d4f0d"],
Cell[1220, 40, 279, 5, 35, "Input",ExpressionUUID->"feed91c2-bb35-47cf-9557-9ac97291f62a"],
Cell[CellGroupData[{
Cell[1524, 49, 526, 14, 35, "Input",ExpressionUUID->"e030f6d6-3bb7-4986-a637-49c68b66dac8"],
Cell[2053, 65, 466, 14, 39, "Output",ExpressionUUID->"f0686794-df4a-4d47-a7a4-fd7898b0b6ab"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2568, 85, 181, 3, 81, "Chapter",ExpressionUUID->"dc5cddf8-0489-4ffb-a343-e58ffc557c7f"],
Cell[2752, 90, 481, 14, 1759, "Input",ExpressionUUID->"035b278f-cac0-4f64-9adb-5f077b41632c"],
Cell[CellGroupData[{
Cell[3258, 108, 195, 4, 1759, "Input",ExpressionUUID->"a86535ee-167b-4928-92c5-f793adbbbda3"],
Cell[3456, 114, 745, 21, 4253, "Output",ExpressionUUID->"af2805fe-f00e-4986-aa0d-f8ef5698d98e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4238, 140, 1285, 37, 4371, "Input",ExpressionUUID->"b3a9e571-fb93-4361-a83d-86dc50badeb7"],
Cell[5526, 179, 643, 12, 1339, "Message",ExpressionUUID->"ba8c336f-05cd-4841-a318-eb66e3b945a9"],
Cell[6172, 193, 217, 4, 2014, "Output",ExpressionUUID->"0b2c98cc-21b6-4494-9955-41d0eefeae93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6426, 202, 519, 15, 1759, "Input",ExpressionUUID->"bb001e94-8c85-486e-a94c-21616658f875"],
Cell[6948, 219, 186, 3, 2014, "Output",ExpressionUUID->"12097ef3-bf6a-4bdf-8b33-6e830097a85f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7171, 227, 1831, 48, 6891, "Input",ExpressionUUID->"1a3a2e0d-3560-4f6b-8af8-3461d9672c19"],
Cell[9005, 277, 621, 14, 2014, "Output",ExpressionUUID->"bd28a4ac-6833-4f9a-b403-9f606c7181df"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[9675, 297, 150, 3, 67, "Chapter",ExpressionUUID->"e1f4bb0d-9fd1-4add-9558-20da117ce88b"],
Cell[9828, 302, 1228, 34, 6891, "Input",ExpressionUUID->"d0647dcf-d0dd-4214-a9d2-d884a60d2829"],
Cell[CellGroupData[{
Cell[11081, 340, 2033, 50, 6124, "Input",ExpressionUUID->"be74b322-555d-4be9-886d-8ce7c7e309aa"],
Cell[13117, 392, 485, 10, 1339, "Message",ExpressionUUID->"e3add398-73fe-4186-8d66-1edee70cbc61"],
Cell[13605, 404, 485, 10, 1339, "Message",ExpressionUUID->"66b5d534-9ffd-47d1-8060-f48c1758360a"],
Cell[14093, 416, 485, 10, 1339, "Message",ExpressionUUID->"def54c7c-da30-46d4-b491-3610aacf6403"],
Cell[14581, 428, 599, 12, 1339, "Message",ExpressionUUID->"45d00e4a-3db4-4f3a-b196-6b87ea042bb4"],
Cell[15183, 442, 479, 9, 1339, "Message",ExpressionUUID->"65a07df2-8d69-4580-aa3a-e1ea4a00f178"],
Cell[15665, 453, 484, 10, 1339, "Message",ExpressionUUID->"df29cba4-9d07-4485-b23a-2acdc34f0329"],
Cell[16152, 465, 253, 4, 2014, "Output",ExpressionUUID->"48313630-b35d-462e-9509-a2abef0f21f2"]
}, Open  ]],
Cell[16420, 472, 1459, 43, 13187, "Input",ExpressionUUID->"07d694bc-5d9f-4aad-bf2c-6ce7533d7c3c"],
Cell[CellGroupData[{
Cell[17904, 519, 692, 15, 1759, "Input",ExpressionUUID->"b46c9c00-8117-4a72-99c8-d2441b9ae728"],
Cell[18599, 536, 191, 2, 2014, "Output",ExpressionUUID->"ccdfa18b-f016-4c59-b35c-89cd3cc18e54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18827, 543, 664, 15, 1759, "Input",ExpressionUUID->"527ceba6-8d7a-49cf-80ad-6cef78b24729"],
Cell[19494, 560, 193, 2, 2014, "Output",ExpressionUUID->"4ad081b0-60b4-4e79-9fc3-03ebb1dc8541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19724, 567, 853, 19, 3101, "Input",ExpressionUUID->"f612a595-4ee6-41b7-a9d6-aef1ef605207"],
Cell[20580, 588, 4698, 71, 5770, "Message",ExpressionUUID->"79fc0761-e57f-4cae-8735-23a431a241d7"],
Cell[25281, 661, 4884, 73, 5755, "Message",ExpressionUUID->"309d0a76-a5da-425c-8a9c-a55532461f7e"],
Cell[30168, 736, 6885, 101, 7642, "Message",ExpressionUUID->"677cd45c-3278-4561-a9a2-edf787bb7f5b"],
Cell[37056, 839, 523, 12, 1339, "Message",ExpressionUUID->"30993af4-870a-4460-9389-010348675ab0"],
Cell[37582, 853, 235, 4, 2014, "Output",ExpressionUUID->"052b61d9-0115-4d44-b291-22273a84792c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37854, 862, 212, 3, 1759, "Input",ExpressionUUID->"1d1c5812-3f89-46f9-a55a-e313cd43fc47"],
Cell[38069, 867, 214, 4, 2014, "Output",ExpressionUUID->"9e78b6ca-9f79-4e7e-a95c-edf842a47d3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38320, 876, 212, 3, 1759, "Input",ExpressionUUID->"3c788f70-e7aa-4073-a499-2d417fe49afd"],
Cell[38535, 881, 216, 4, 2014, "Output",ExpressionUUID->"925ceb1d-55c8-4664-9952-0be6f8b5e403"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[38800, 891, 257, 4, 67, "Chapter",ExpressionUUID->"75b4616d-cb2d-4656-87bd-17ed2a8e38bc"],
Cell[CellGroupData[{
Cell[39082, 899, 957, 33, 3587, "Input",ExpressionUUID->"516df623-c1b4-4d39-8e19-f21438f0427c"],
Cell[40042, 934, 1245, 41, 9753, "Output",ExpressionUUID->"0acf2943-b76c-48b1-ad84-041d41afed55"]
}, Open  ]],
Cell[41302, 978, 878, 21, 1759, "Input",ExpressionUUID->"370b5de4-7fd2-4358-acdf-2b8061d3869b"],
Cell[CellGroupData[{
Cell[42205, 1003, 157, 3, 1759, "Input",ExpressionUUID->"267e35c6-d1f1-4dc3-9af0-3edefaa40ee3"],
Cell[42365, 1008, 68236, 1714, 228831, "Output",ExpressionUUID->"792cab9b-1c85-43bc-a00c-8d99192d75f2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[110650, 2728, 197, 4, 67, "Chapter",ExpressionUUID->"26de32d0-bcfd-4552-ad87-d75be2af4510"],
Cell[110850, 2734, 997, 34, 3587, "Input",ExpressionUUID->"b93c0c4b-96a2-4cad-bf8b-d6baa1268a11"],
Cell[CellGroupData[{
Cell[111872, 2772, 252, 6, 1759, "Input",ExpressionUUID->"d1c06d8d-dc10-4d20-81cb-be657eb033be"],
Cell[112127, 2780, 568, 18, 3814, "Output",ExpressionUUID->"3fe70b11-e2cc-4cea-8f44-9d8ce6febe87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112732, 2803, 611, 14, 1759, "Input",ExpressionUUID->"f0925c1d-18de-419f-aecb-29270505abb0"],
Cell[113346, 2819, 193, 2, 2014, "Output",ExpressionUUID->"548681a1-ed54-42d6-813b-fdecd356d865"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113576, 2826, 1970, 60, 6773, "Input",ExpressionUUID->"315f94aa-d991-4f93-ae79-d4ac1761d557"],
Cell[115549, 2888, 212, 4, 2014, "Output",ExpressionUUID->"1dc82ed8-e878-41a7-b541-a4873f397e2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[115798, 2897, 3573, 107, 12951, "Input",ExpressionUUID->"0a0ec0da-77d3-45f2-a9dd-729c22bcb592"],
Cell[119374, 3006, 3409, 104, 13330, "Output",ExpressionUUID->"666de570-4dcc-4501-9e59-0384f74a22b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122820, 3115, 556, 15, 1759, "Input",ExpressionUUID->"a5cb283f-d249-474f-94a7-60bf5e8570bd"],
Cell[123379, 3132, 646, 12, 1339, "Message",ExpressionUUID->"1f40051c-695e-4200-a3e9-607e22c8c6bb"],
Cell[124028, 3146, 414, 12, 2014, "Output",ExpressionUUID->"48350ea4-fbc0-4b46-8cc4-d20bf94df952"]
}, Open  ]],
Cell[124457, 3161, 733, 18, 1759, "Input",ExpressionUUID->"90a0b17f-f6d5-4ba1-8d91-577b158db02f"],
Cell[CellGroupData[{
Cell[125215, 3183, 369, 9, 1759, "Input",ExpressionUUID->"fc92d22e-904a-48eb-a256-6097df77540a"],
Cell[125587, 3194, 243, 3, 2014, "Output",ExpressionUUID->"7cf48ea1-8dec-42a4-b1c7-5e8f8d99bca2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125867, 3202, 500, 14, 1759, "Input",ExpressionUUID->"cc736091-7bd2-45b6-b2e6-ce6319cc7b2f"],
Cell[126370, 3218, 366, 7, 2014, "Output",ExpressionUUID->"4631502b-c68f-4b87-831f-ea0a96396c0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126773, 3230, 650, 19, 1759, "Input",ExpressionUUID->"3341e86e-58c6-410b-961e-3c19c30d7266"],
Cell[127426, 3251, 430, 9, 2014, "Output",ExpressionUUID->"618fb676-84d6-421d-8fe0-d2c5120c9dcc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127893, 3265, 743, 20, 1759, "Input",ExpressionUUID->"81f14485-0fdb-4534-a522-31e96fd46f6b"],
Cell[128639, 3287, 170, 2, 2014, "Output",ExpressionUUID->"464e8ef5-c18e-4b8a-a591-9a1d304bbe57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[128846, 3294, 1016, 29, 1759, "Input",ExpressionUUID->"cb2fe641-0ed5-4e03-bc6b-fb334c6b568a"],
Cell[129865, 3325, 1037, 29, 2014, "Output",ExpressionUUID->"97c35a00-6bf4-4ad3-bfdb-0f310c082620"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130939, 3359, 429, 10, 1759, "Input",ExpressionUUID->"843df714-47ca-47f3-acd6-1de5ad2bfbd3"],
Cell[131371, 3371, 250, 4, 2014, "Output",ExpressionUUID->"4b2db56f-d6fc-4016-b877-9ec9e37572c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131658, 3380, 849, 25, 1759, "Input",ExpressionUUID->"58cb1883-86d6-4796-b721-1ecf5f0ac5e6"],
Cell[132510, 3407, 566, 12, 2014, "Output",ExpressionUUID->"1d7493bd-f5c8-4a61-82aa-08ddacf0aa1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133113, 3424, 748, 20, 1759, "Input",ExpressionUUID->"6df89177-9545-4bea-b477-c55b3b6c233d"],
Cell[133864, 3446, 220, 3, 2014, "Output",ExpressionUUID->"a3f45e65-84d4-4fb8-b04f-ae4bfd7af2ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134121, 3454, 2654, 75, 4903, "Input",ExpressionUUID->"7fb5d600-557e-4871-9b94-ac1c805b6d3c"],
Cell[136778, 3531, 958, 18, 2014, "Output",ExpressionUUID->"0a7e3a34-292a-4185-a1b1-89179e98f727"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137773, 3554, 522, 11, 1759, "Input",ExpressionUUID->"e1f5569b-5313-4999-9bd7-02f43863c77f"],
Cell[138298, 3567, 449, 6, 2014, "Output",ExpressionUUID->"14cf20d0-ae04-4eea-96a8-71c81969c57d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138784, 3578, 784, 22, 1759, "Input",ExpressionUUID->"ccd78427-fbd1-4aa8-acf2-5e89b5f635bb"],
Cell[139571, 3602, 196, 2, 2014, "Output",ExpressionUUID->"7c30a7fc-cd77-48d7-ba8e-7839782be436"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139804, 3609, 510, 14, 1759, "Input",ExpressionUUID->"d6baadc3-8503-42ce-8a90-f3f7854e63d6"],
Cell[140317, 3625, 1481, 26, 2296, "Message",ExpressionUUID->"466dc360-0f1a-4995-a182-09262e07f54a"],
Cell[141801, 3653, 1483, 26, 2296, "Message",ExpressionUUID->"e6509476-acc6-4a92-bfcd-20fae17e8792"],
Cell[143287, 3681, 1483, 26, 2296, "Message",ExpressionUUID->"b7ca2181-2f26-44c5-a17e-c2f5eab41286"],
Cell[144773, 3709, 450, 10, 1339, "Message",ExpressionUUID->"6cc015af-3e9c-48ab-8bb9-946d650a89be"],
Cell[145226, 3721, 1149, 32, 2900, "Output",ExpressionUUID->"10136733-d257-4d08-817e-f01be0889219"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146412, 3758, 634, 16, 1759, "Input",ExpressionUUID->"0b7e0e37-3741-47fb-9eb6-3bb5e8d9e4eb"],
Cell[147049, 3776, 3039, 87, 4119, "Output",ExpressionUUID->"f1aedf49-73bb-4eb1-8b7b-5cc4ff5149c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150125, 3868, 772, 21, 1759, "Input",ExpressionUUID->"b97a893c-ba69-4668-9aa4-5aa18c5fb6df"],
Cell[150900, 3891, 1516, 43, 5633, "Output",ExpressionUUID->"630ce4f0-9a7e-4c52-975e-7ea3df9b74c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152453, 3939, 768, 21, 1759, "Input",ExpressionUUID->"d454b804-1c50-43f3-ba2f-3e6a2e4a4407"],
Cell[153224, 3962, 574, 17, 3144, "Output",ExpressionUUID->"171730ad-8224-47e6-91eb-019b7d034899"]
}, Open  ]],
Cell[CellGroupData[{
Cell[153835, 3984, 1131, 27, 3101, "Input",ExpressionUUID->"fc2083dd-39d4-447d-b642-f66699cbe156"],
Cell[154969, 4013, 6313, 150, 6392, "Output",ExpressionUUID->"f12112a5-07a7-4f68-b953-d59ce15891bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161319, 4168, 1434, 33, 3101, "Input",ExpressionUUID->"b2c201ad-199e-48f1-8877-7d105bd12927"],
Cell[162756, 4203, 210, 3, 2014, "Output",ExpressionUUID->"3f00270d-0741-4ca7-b9ad-9a08c52526fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163003, 4211, 464, 12, 2109, "Input",ExpressionUUID->"167e1ad0-1a10-4ceb-b8a5-e821fc8d2857"],
Cell[163470, 4225, 306, 8, 2014, "Output",ExpressionUUID->"59178369-5ae0-4424-8c82-9a2c0a85c4d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163813, 4238, 654, 18, 2109, "Input",ExpressionUUID->"cb0b97d7-150a-4ec7-8d5d-00c032fa5793"],
Cell[164470, 4258, 665, 18, 2365, "Output",ExpressionUUID->"a2a9d0ca-38fb-419c-b62c-b39fb745a9ff"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[165184, 4282, 159, 3, 67, "Chapter",ExpressionUUID->"4bf7ef27-65b1-4d42-ba7b-aa3cb4c72ab5"],
Cell[165346, 4287, 737, 17, 1311, "Input",ExpressionUUID->"4649bec9-d8d7-4f3f-9a65-a678aa614722"],
Cell[CellGroupData[{
Cell[166108, 4308, 338, 6, 1311, "Input",ExpressionUUID->"f82b6fca-60de-41a8-a6f5-98381ba1b94e"],
Cell[166449, 4316, 551, 14, 1465, "Output",ExpressionUUID->"582e5f66-44fc-453e-a559-5daa5296cc3f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[167037, 4335, 156, 3, 2861, "Subchapter",ExpressionUUID->"50dc4739-da8f-4b35-b106-5b39a52e0d1c"],
Cell[CellGroupData[{
Cell[167218, 4342, 275, 4, 1311, "Input",ExpressionUUID->"0c7792cf-999b-4a41-bb0b-76bcabaf4439"],
Cell[167496, 4348, 28774, 832, 72953, "Output",ExpressionUUID->"22e12425-8fe8-405f-91b4-9abba948d580"]
}, Open  ]],
Cell[196285, 5183, 175, 3, 2154, "Text",ExpressionUUID->"654e5c7e-041a-4554-93e7-c1ce66083531"],
Cell[196463, 5188, 23859, 634, 88822, "Input",ExpressionUUID->"e39126a8-deef-405f-a92a-49ed2c0b8b10"],
Cell[220325, 5824, 186, 3, 2154, "Text",ExpressionUUID->"dcffafac-3f90-4f1b-9556-ccc5fb65807c"],
Cell[220514, 5829, 26149, 694, 75689, "Input",ExpressionUUID->"1603b1fc-e2a5-4074-9588-7b773b2a4ecf"],
Cell[CellGroupData[{
Cell[246688, 6527, 308, 5, 1759, "Input",ExpressionUUID->"42a1b2b4-d573-4e92-bf99-13b96c2223df"],
Cell[246999, 6534, 11261, 321, 30908, "Output",ExpressionUUID->"39c907ea-88cf-4d38-b281-f3ca9023aff4"]
}, Open  ]],
Cell[258275, 6858, 1295, 43, 3405, "Text",ExpressionUUID->"9d922d88-9640-47cc-8526-9ce465c464dd"],
Cell[259573, 6903, 11333, 303, 34545, "Input",ExpressionUUID->"839db110-6e9a-4d5e-b1fb-087f6f7d15bd"],
Cell[CellGroupData[{
Cell[270931, 7210, 213, 3, 1759, "Input",ExpressionUUID->"f4cf7818-7ae7-4c1e-8dc4-c715ce667260"],
Cell[271147, 7215, 10640, 300, 27453, "Output",ExpressionUUID->"e609da86-db6f-4378-ae0d-ddff6d971b8a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[281836, 7521, 156, 3, 4119, "Subchapter",ExpressionUUID->"3a51e324-af16-4064-9dcf-b63b9d2a22a8"],
Cell[CellGroupData[{
Cell[282017, 7528, 176, 2, 1759, "Input",ExpressionUUID->"3ee679ec-0756-4e94-b141-aebd057e1cad"],
Cell[282196, 7532, 25704, 742, 74669, "Output",ExpressionUUID->"4ebfcfd9-26c0-4ce9-a112-ac374670b11e"]
}, Open  ]],
Cell[307915, 8277, 175, 3, 2154, "Text",ExpressionUUID->"1768ff78-0f00-4b0e-b59f-d3dc7afaf504"],
Cell[308093, 8282, 21779, 577, 66909, "Input",ExpressionUUID->"f74562e0-d2a0-486e-ba60-84b2d649c942"],
Cell[329875, 8861, 186, 3, 2154, "Text",ExpressionUUID->"d944b962-feae-4fc3-bd8d-074286741745"],
Cell[330064, 8866, 23897, 636, 73193, "Input",ExpressionUUID->"1b47edeb-d96a-44d9-9b3f-99800bce2bf8"],
Cell[CellGroupData[{
Cell[353986, 9506, 210, 3, 1759, "Input",ExpressionUUID->"279a4d7e-b651-41e2-9ddb-fdaa295822ef"],
Cell[354199, 9511, 11128, 321, 31596, "Output",ExpressionUUID->"08f486ce-894b-4227-bc2f-b553b588fea4"]
}, Open  ]],
Cell[365342, 9835, 1295, 43, 3746, "Text",ExpressionUUID->"315983bf-bfb6-4358-9d13-390bb66b136d"],
Cell[366640, 9880, 11294, 306, 44785, "Input",ExpressionUUID->"9627b817-762c-478b-8f84-6fc5c819e1c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377971, 10191, 206, 4, 4119, "Subchapter",ExpressionUUID->"3cce6c3c-a1ba-4e62-85e8-1d9e0b090694"],
Cell[378180, 10197, 1710, 53, 3101, "Input",ExpressionUUID->"fcaa1aa6-4bbb-415b-bef3-46e61b03ff4c"],
Cell[379893, 10252, 560, 15, 1759, "Input",ExpressionUUID->"bc9f2b79-311e-4382-8ac7-c714d8212683"],
Cell[CellGroupData[{
Cell[380478, 10271, 150, 2, 1759, "Input",ExpressionUUID->"f9d795be-d657-4d5a-8f7a-ac0e8acd5f6e"],
Cell[380631, 10275, 21845, 605, 79315, "Output",ExpressionUUID->"e203af36-f004-40f6-829c-ca3366dad687"]
}, Open  ]],
Cell[402491, 10883, 807, 21, 5921, "Input",ExpressionUUID->"bf81b906-547c-4b39-a4fd-8a0f1669fac3"],
Cell[CellGroupData[{
Cell[403323, 10908, 281, 4, 1887, "Input",ExpressionUUID->"652aceeb-f953-448e-8de4-4f039d8daf89"],
Cell[403607, 10914, 12677, 356, 42246, "Output",ExpressionUUID->"0ded9d72-5187-4157-8605-9a96bc80af0e"]
}, Open  ]],
Cell[416299, 11273, 212, 4, 2193, "Text",ExpressionUUID->"7ba32886-e769-45e3-9172-c07150e64d8c"],
Cell[416514, 11279, 8413, 235, 30209, "Input",ExpressionUUID->"44f307d8-288f-4142-bb84-01c6dd2dee64"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[424976, 11520, 154, 3, 67, "Chapter",ExpressionUUID->"ae2c5ecb-5077-469c-bcc8-a7808b0a5256"],
Cell[CellGroupData[{
Cell[425155, 11527, 916, 21, 60, "Input",ExpressionUUID->"708fa8f3-50c6-49ad-adfd-6161501c1a03"],
Cell[426074, 11550, 190, 2, 39, "Output",ExpressionUUID->"31a7a9e0-5a91-43bb-a920-103bf45aaa92"]
}, Open  ]],
Cell[CellGroupData[{
Cell[426301, 11557, 1223, 26, 60, "Input",ExpressionUUID->"1a76356c-eacc-411d-906b-f9f8bcad9a58"],
Cell[427527, 11585, 523, 7, 39, "Output",ExpressionUUID->"0ad4f549-0f44-42bf-b8a0-740fcddec9a1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[428087, 11597, 746, 18, 65, "Input",ExpressionUUID->"7c680ba6-93b6-47e1-8644-560067213f4a"],
Cell[428836, 11617, 219, 3, 39, "Output",ExpressionUUID->"26603558-6a98-480c-87cf-ec4a9f0b0aac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[429092, 11625, 156, 3, 76, "Subchapter",ExpressionUUID->"a483211a-9576-429f-af69-99df8911fda8"],
Cell[429251, 11630, 505, 10, 35, "Input",ExpressionUUID->"c8e4f34d-d364-4a69-b700-bfa7b4241147"],
Cell[CellGroupData[{
Cell[429781, 11644, 722, 20, 35, "Input",ExpressionUUID->"68f46aa2-de8c-4033-a787-b4695ad95583"],
Cell[430506, 11666, 2899, 74, 294, "Output",ExpressionUUID->"e9956020-272e-409b-b13b-e45f7d848f2d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[433442, 11745, 1017, 23, 60, "Input",ExpressionUUID->"7104f533-16dd-4455-9a40-020f15223ba2"],
Cell[434462, 11770, 216, 3, 39, "Output",ExpressionUUID->"9fd88826-20a1-4b91-854c-ee47fb9f36d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[434715, 11778, 890, 21, 60, "Input",ExpressionUUID->"4a600c88-c9da-4782-ab20-4ac597b795bd"],
Cell[435608, 11801, 167, 2, 39, "Output",ExpressionUUID->"039e59c7-3034-42dd-b9c1-45e97d1f6401"]
}, Open  ]],
Cell[CellGroupData[{
Cell[435812, 11808, 252, 5, 35, "Input",ExpressionUUID->"da7c7218-d8a4-40a9-9d80-0812ed67ceb2"],
Cell[436067, 11815, 729, 14, 39, "Output",ExpressionUUID->"8306e0d9-7e74-45cd-bb8a-ff66304ae5fc"]
}, Open  ]],
Cell[436811, 11832, 2705, 56, 228, "Input",ExpressionUUID->"fa85c89b-fc48-4ed8-a3d2-a9b0e579772e"],
Cell[CellGroupData[{
Cell[439541, 11892, 1715, 45, 60, "Input",ExpressionUUID->"dd72d362-d078-48d6-bed7-1139aa12be8f"],
Cell[441259, 11939, 8122, 140, 1007, "Output",ExpressionUUID->"88f00d60-04f8-44f0-99d9-4ad4bb5db2be"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[449430, 12085, 207, 4, 76, "Subchapter",ExpressionUUID->"a7776c9e-cd50-4f13-a282-d14f74c2a80c"],
Cell[449640, 12091, 535, 11, 440, "Input",ExpressionUUID->"c095c85d-ec8d-4d5a-a336-1c72c6530838"],
Cell[CellGroupData[{
Cell[450200, 12106, 252, 5, 440, "Input",ExpressionUUID->"505fd470-72e3-42cb-b7b2-c2f473a8dbd4"],
Cell[450455, 12113, 787, 15, 491, "Output",ExpressionUUID->"1777beec-95e8-4754-8e88-61527aad2edf"]
}, Open  ]],
Cell[451257, 12131, 2641, 55, 2602, "Input",ExpressionUUID->"30a9c667-93b9-4c58-bfb8-0d1787883572"],
Cell[CellGroupData[{
Cell[453923, 12190, 1653, 39, 756, "Input",ExpressionUUID->"b202a751-1fad-426b-8ec0-c92d9c97b678"],
Cell[455579, 12231, 5849, 100, 8111, "Output",ExpressionUUID->"4940d2ed-3d59-4bbb-80e1-6f8ce5b52c6d"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[461477, 12337, 255, 4, 56, "Subchapter",ExpressionUUID->"3f24a35c-9c79-482e-8a2e-13c9861584b1"],
Cell[CellGroupData[{
Cell[461757, 12345, 153, 3, 80, "Section",ExpressionUUID->"986906c2-8110-4a5a-9851-2663824f0ce5"],
Cell[461913, 12350, 326, 9, 440, "Input",ExpressionUUID->"e8b4f73b-f52d-470a-96cc-31584928e26a"],
Cell[CellGroupData[{
Cell[462264, 12363, 252, 5, 440, "Input",ExpressionUUID->"97ba69df-d7fb-4d12-8ff0-dfe363f7b8ef"],
Cell[462519, 12370, 696, 14, 491, "Output",ExpressionUUID->"cf557779-becf-4c67-b0d7-ab634f490b74"]
}, Open  ]],
Cell[463230, 12387, 636, 15, 756, "Input",ExpressionUUID->"bfab99e1-ff2f-41f3-85f7-aeb29263d1d7"],
Cell[CellGroupData[{
Cell[463891, 12406, 2576, 69, 1517, "Input",ExpressionUUID->"103d220c-9960-4c1e-bbf2-269cf08bba39"],
Cell[466470, 12477, 525, 12, 355, "Message",ExpressionUUID->"41d62634-022e-4051-b204-1cd22dd5b73c"],
Cell[466998, 12491, 528, 12, 355, "Message",ExpressionUUID->"f6253755-6e62-4f2f-8bf4-bfaddc09cb04"],
Cell[467529, 12505, 546, 12, 355, "Message",ExpressionUUID->"0c00921a-ee5c-4ac9-ae8f-df28ceaffa0e"],
Cell[468078, 12519, 496, 11, 326, "Message",ExpressionUUID->"1aaa8c96-87b2-4d15-8ed8-214c2c3c8626"],
Cell[468577, 12532, 5646, 106, 8220, "Output",ExpressionUUID->"6cd242e6-ef67-4780-86e8-0d488adcd3ba"]
}, Open  ]],
Cell[474238, 12641, 236, 3, 440, "Input",ExpressionUUID->"6443548f-2471-4ec6-b829-5e664d27ba10"],
Cell[474477, 12646, 227, 3, 440, "Input",ExpressionUUID->"66338571-49e5-4471-a981-00f9f36b3028"],
Cell[CellGroupData[{
Cell[474729, 12653, 1174, 29, 756, "Input",ExpressionUUID->"9c879f77-4726-4269-8128-7e1542081e6d"],
Cell[475906, 12684, 1102, 62, 13429, "Print",ExpressionUUID->"78506cf7-6370-4cf5-ad79-eadda2d044a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[477045, 12751, 407, 9, 440, "Input",ExpressionUUID->"e01d3fda-b18f-49b3-8abf-2e7c0943cca7"],
Cell[477455, 12762, 199, 2, 491, "Output",ExpressionUUID->"8cdba84b-e021-4efa-b199-a21112e32237"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[477703, 12770, 207, 4, 62, "Section",ExpressionUUID->"9fcd4607-00b2-4728-946c-92b7d28c143f"],
Cell[CellGroupData[{
Cell[477935, 12778, 759, 17, 525, "Input",ExpressionUUID->"9e938fa6-baac-4977-bb08-c718388a2b45"],
Cell[478697, 12797, 167, 2, 341, "Output",ExpressionUUID->"e6a79c55-ed15-481a-925a-b1646a4d9387"]
}, Open  ]],
Cell[478879, 12802, 3663, 92, 1954, "Input",ExpressionUUID->"0048650a-0e82-4f3d-830c-743cce357a8b"],
Cell[482545, 12896, 663, 19, 306, "Input",ExpressionUUID->"d1461f44-4d73-4275-bb4c-108a85373166"],
Cell[483211, 12917, 551, 12, 306, "Input",ExpressionUUID->"4f147626-d11b-420b-bb97-4055d24e2cbf"],
Cell[483765, 12931, 371, 9, 306, "Input",ExpressionUUID->"0054ef68-d15c-481a-9b8b-b264287bf99c"],
Cell[CellGroupData[{
Cell[484161, 12944, 619, 17, 306, "Input",ExpressionUUID->"127b1650-8ef0-4e16-a22b-8cbe1d53333d"],
Cell[484783, 12963, 1468, 45, 648, "Output",ExpressionUUID->"34e90b2e-6f98-4078-bfcb-f5517fee3bfa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[486288, 13013, 4417, 107, 1255, "Input",ExpressionUUID->"185cb675-2727-458e-8a37-d9e1859def7f"],
Cell[490708, 13122, 616, 13, 247, "Message",ExpressionUUID->"6a282664-97b3-42ff-8caa-1ba272466bad"],
Cell[491327, 13137, 616, 13, 247, "Message",ExpressionUUID->"1f13b36e-8fe9-44a9-b3f3-def87777c477"],
Cell[491946, 13152, 615, 13, 247, "Message",ExpressionUUID->"466f2a53-5c85-4950-bc4d-002085217b4c"],
Cell[492564, 13167, 588, 12, 227, "Message",ExpressionUUID->"4502d45e-f727-474c-a725-2f8ac07a9420"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493189, 13184, 745, 18, 306, "Input",ExpressionUUID->"56018d72-de8c-45e1-92e0-c0a07a910233"],
Cell[493937, 13204, 30613, 656, 18305, "Output",ExpressionUUID->"dbf73dbb-5798-4d7f-a8ca-848356a08624"]
}, Open  ]],
Cell[CellGroupData[{
Cell[524587, 13865, 1622, 43, 525, "Input",ExpressionUUID->"549f9b37-8876-4a2d-a1be-93f8898d59f9"],
Cell[526212, 13910, 25139, 547, 4055, "Output",ExpressionUUID->"a92bbb25-fb67-4185-94f3-ca1247fe44f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551388, 14462, 1688, 46, 525, "Input",ExpressionUUID->"27730b4b-3687-49d2-940b-9bc4b3165e02"],
Cell[553079, 14510, 3177, 77, 1438, "Output",ExpressionUUID->"5c4d5675-e111-4afa-b476-4527c422848e"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[556305, 14593, 252, 4, 62, "Section",ExpressionUUID->"5b17ee1f-5f28-4dc9-be40-d3f3a616949c"],
Cell[556560, 14599, 371, 8, 35, "Input",ExpressionUUID->"d7975db7-81c2-496f-bc8c-0e3dd98292bd"],
Cell[CellGroupData[{
Cell[556956, 14611, 1045, 24, 60, "Input",ExpressionUUID->"f0f9004c-a65d-4ddd-b641-c7ea5fdfcffc"],
Cell[558004, 14637, 694, 14, 39, "Output",ExpressionUUID->"ec4f7f7a-f365-4ed1-8a59-bfa4ddf7ba1f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[558735, 14656, 732, 18, 65, "Input",ExpressionUUID->"25030547-bab4-4efe-9325-9629404b5f00"],
Cell[559470, 14676, 217, 3, 39, "Output",ExpressionUUID->"0436eadb-3982-4caf-97bf-41bb07de5df8"]
}, Open  ]],
Cell[559702, 14682, 1246, 36, 65, "Input",ExpressionUUID->"41eeddcc-ff7c-406e-99a1-cc1440f39e07"],
Cell[CellGroupData[{
Cell[560973, 14722, 412, 10, 35, "Input",ExpressionUUID->"ac7b90c6-df81-49b2-811e-e086de2c2731"],
Cell[561388, 14734, 10368, 201, 616, "Output",ExpressionUUID->"18be95fa-878f-451d-adfa-0ea9b6a92249"]
}, Open  ]],
Cell[571771, 14938, 11852, 260, 902, "Input",ExpressionUUID->"8b88a1f0-ff61-4e57-810b-f70c3c39f476"],
Cell[583626, 15200, 1127, 29, 35, "Input",ExpressionUUID->"4bbf0f92-ed6f-4aae-986a-bb81e1eb11e9"],
Cell[CellGroupData[{
Cell[584778, 15233, 877, 18, 60, "Input",ExpressionUUID->"4e1d1f60-3889-4239-9d04-a4480169fe00"],
Cell[585658, 15253, 11851, 301, 1022, "Output",ExpressionUUID->"afe98b94-be8f-4f2f-9473-1be4fe92b262"]
}, Open  ]],
Cell[CellGroupData[{
Cell[597546, 15559, 253, 5, 103, "Input",ExpressionUUID->"fd56e6da-fe75-43ad-8bab-c311a996a47d"],
Cell[597802, 15566, 707, 14, 190, "Output",ExpressionUUID->"0881bb50-aaca-4abf-a2ff-870b7ab1af75"]
}, Open  ]],
Cell[CellGroupData[{
Cell[598546, 15585, 1032, 27, 177, "Input",ExpressionUUID->"c45e3381-5819-483f-93c3-59b130d71e29"],
Cell[599581, 15614, 21322, 454, 1311, "Output",ExpressionUUID->"7c0b18da-58ba-46a4-8aae-dfdb51dc608e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[620940, 16073, 1646, 42, 247, "Input",ExpressionUUID->"eeb817a2-d255-4998-813b-9d840c34d5dc"],
Cell[622589, 16117, 2879, 77, 457, "Output",ExpressionUUID->"6696e878-b891-453f-b09c-b94547c82eb0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[625505, 16199, 967, 21, 177, "Input",ExpressionUUID->"c593d6b4-f890-4930-8ae7-114c26b76d9c"],
Cell[626475, 16222, 167, 2, 115, "Output",ExpressionUUID->"c39f872a-764f-4138-88c9-58c8ac02fa1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[626679, 16229, 1421, 33, 247, "Input",ExpressionUUID->"9018e91b-ab63-4fb2-8dc6-b47eb8d96d64"],
Cell[628103, 16264, 505, 12, 77, "Message",ExpressionUUID->"31a98a84-a5ca-4e54-8028-8e8a5502e718"],
Cell[628611, 16278, 505, 12, 77, "Message",ExpressionUUID->"d340845b-40ed-4543-a570-2afd995dc793"],
Cell[629119, 16292, 503, 12, 77, "Message",ExpressionUUID->"faed69d6-8d45-4368-baa0-390d4ef6010d"],
Cell[629625, 16306, 541, 13, 77, "Message",ExpressionUUID->"21f36d19-550b-48ac-85a7-c5bbd2618ada"],
Cell[630169, 16321, 3449, 75, 938, "Output",ExpressionUUID->"b383c3cf-e491-44d3-8275-daa350111291"]
}, Open  ]],
Cell[CellGroupData[{
Cell[633655, 16401, 1419, 33, 247, "Input",ExpressionUUID->"07564567-44c9-4995-9d56-2b6945e9bc54"],
Cell[635077, 16436, 426, 10, 77, "Message",ExpressionUUID->"42506931-395a-4300-a928-bbae2dd0e6c1"],
Cell[635506, 16448, 424, 10, 77, "Message",ExpressionUUID->"266749e5-7781-49cd-b0b6-617dbc9917f8"],
Cell[635933, 16460, 426, 10, 77, "Message",ExpressionUUID->"c5174170-fe9d-4eec-aa12-9b4c5bb7a235"],
Cell[636362, 16472, 464, 11, 77, "Message",ExpressionUUID->"2bcc8427-88cf-4656-b18b-b42180559cb9"],
Cell[636829, 16485, 3341, 72, 920, "Output",ExpressionUUID->"b2099439-fec1-49a7-b9b6-3ae4def8e6f2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[640207, 16562, 1454, 34, 247, "Input",ExpressionUUID->"3327dbe4-ff3c-447e-8c84-1f595bd06e2c"],
Cell[641664, 16598, 477, 11, 77, "Message",ExpressionUUID->"b6b6c6fe-936e-4a0a-b223-abec636c9ce2"],
Cell[642144, 16611, 477, 11, 77, "Message",ExpressionUUID->"b73481f7-d7f1-4fcc-ab2d-02860a9de27c"],
Cell[642624, 16624, 475, 11, 77, "Message",ExpressionUUID->"97cd88f1-380e-4c7b-9c77-b6a0b1ef02b6"],
Cell[643102, 16637, 515, 12, 77, "Message",ExpressionUUID->"375032bf-ca13-4c09-ab9c-d13c1f39c549"],
Cell[643620, 16651, 9377, 172, 933, "Output",ExpressionUUID->"a0a6af35-eb35-49e7-844f-ea04f16a409e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[653034, 16828, 1547, 35, 247, "Input",ExpressionUUID->"3e674f83-13b2-452a-8ecb-9425e9e276c0"],
Cell[654584, 16865, 573, 13, 77, "Message",ExpressionUUID->"9119f3e0-8718-41e0-b226-5d3b170be8db"],
Cell[655160, 16880, 573, 13, 77, "Message",ExpressionUUID->"e0228d9a-8c1b-4a55-8055-04ce8d6b7bc6"],
Cell[655736, 16895, 571, 13, 77, "Message",ExpressionUUID->"14a827ca-1d81-4ff6-8cc7-a9c48c9a28c7"],
Cell[656310, 16910, 611, 14, 77, "Message",ExpressionUUID->"7d27143c-9399-427b-8895-a18a5ab1e7f2"],
Cell[656924, 16926, 16594, 291, 902, "Output",ExpressionUUID->"649320b7-dae1-41d5-a15c-98f78564a275"]
}, Open  ]],
Cell[CellGroupData[{
Cell[673555, 17222, 697, 19, 103, "Input",ExpressionUUID->"af01661c-9605-4ca9-a879-e51e9dc71943"],
Cell[674255, 17243, 742, 24, 115, "Output",ExpressionUUID->"7634e26b-18c9-4e82-a53d-41979a346852"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

