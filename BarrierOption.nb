(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    175634,       4445]
NotebookOptionsPosition[    164158,       4246]
NotebookOutlinePosition[    164501,       4261]
CellTagsIndexPosition[    164458,       4258]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"1", "+", "1"}]], "Input",
 CellChangeTimes->{{3.6362729698362236`*^9, 3.636272970066228*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"db3d923a-a50b-4ca2-ac5d-4031c2b69046"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.636272970298233*^9, 3.637669804933504*^9, 
  3.6536474209311266`*^9, 3.653971832424405*^9, 3.733121385262988*^9},
 CellLabel->"Out[3]=",ExpressionUUID->"08e1268d-ba25-4158-b6a2-88e7f6cdb9bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initialization", "Chapter",
 CellChangeTimes->{{3.732882674275463*^9, 
  3.7328826759316287`*^9}},ExpressionUUID->"3d07e8c0-4533-4f2a-b3f8-\
d00ad46d4f0d"],

Cell[BoxData[
 RowBox[{"<<", 
  "\"\<C:\\\\Users\\\\fsiano\\\\work\\\\dev\\\\workspace\\\\AD\\\\AD\\\\\
Kernel\\\\AD.m\>\""}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.732882677905826*^9, 3.7328826906471*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"feed91c2-bb35-47cf-9557-9ac97291f62a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[CapitalGamma] matrix and related", "Chapter",
 CellChangeTimes->{{3.6362850719466534`*^9, 
  3.636285082867876*^9}},ExpressionUUID->"dc5cddf8-0489-4ffb-a343-\
e58ffc557c7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", " ", "a", ",", " ", "b"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"a", ",", " ", "1", ",", " ", "c"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"b", ",", " ", "c", ",", "1"}], "}"}]}], "}"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.6362850958021407`*^9, 
  3.636285106286354*^9}},ExpressionUUID->"035b278f-cac0-4f64-9adb-\
5f077b41632c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", " ", "//", " ", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.636285107763384*^9, 
  3.636285110263435*^9}},ExpressionUUID->"a86535ee-167b-4928-92c5-\
f793adbbbda3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "a", "b"},
     {"a", "1", "c"},
     {"b", "c", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6362851105834413`*^9, 
  3.6362859084452877`*^9},ExpressionUUID->"af2805fe-f00e-4986-aa0d-\
f8ef5698d98e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{"g", ",", " ", 
     RowBox[{"Cubics", "\[Rule]", "True"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"es", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"es", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"Normalize", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
      RowBox[{"es", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Dot", "[", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"es", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
     RowBox[{"DiagonalMatrix", "[", 
      RowBox[{"es", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
     RowBox[{"es", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], " ", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.636285115385539*^9, 3.6362851213246603`*^9}, {
  3.6362854650609465`*^9, 3.636285468575632*^9}, {3.6362858483072877`*^9, 
  3.6362858717162876`*^9}, {3.6362859117472878`*^9, 
  3.6362859238502874`*^9}},ExpressionUUID->"b3a9e571-fb93-4361-a83d-\
86dc50badeb7"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Simplify", "::", "time"}], "MessageName"], ":", 
  " ", "\<\"Time spent on a transformation exceeded \[NoBreak]\\!\\(300.`\\)\
\[NoBreak] seconds, and the transformation was aborted. Increasing the value \
of TimeConstraint option may improve the result of simplification. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Simplify/time\\\", \
ButtonNote -> \\\"Simplify::time\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.6362862246071835`*^9},ExpressionUUID->"ba8c336f-05cd-4841-a318-\
eb66e3b945a9"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.6362854714703727`*^9, {3.6362859055432873`*^9, 3.6362859179332876`*^9}, 
   3.6362863540995445`*^9},ExpressionUUID->"0b2c98cc-21b6-4494-9955-\
41d0eefeae93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "[", 
   RowBox[{
    RowBox[{"es", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"es", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
    RowBox[{"Transpose", "[", 
     RowBox[{"es", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "]"}], " ", "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6362851261277604`*^9, 
  3.6362852081014423`*^9}},ExpressionUUID->"bb001e94-8c85-486e-a94c-\
21616658f875"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.636285155560364*^9, 3.636285195838185*^9}, 
   3.6362852351899943`*^9},ExpressionUUID->"12097ef3-bf6a-4bdf-8b33-\
6e830097a85f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "=", "4"}], ",", " ", 
     RowBox[{"b", "=", "3"}], ",", " ", 
     RowBox[{"c", "=", "5"}]}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"es", "=", " ", 
     RowBox[{"Eigensystem", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", " ", "a", ",", " ", "b"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{"a", ",", " ", "1", ",", " ", "c"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"b", ",", " ", "c", ",", "1"}], "}"}]}], "}"}], "]"}]}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"es", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"es", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"Normalize", "[", "#", "]"}], " ", "&"}], " ", "/@", " ", 
        RowBox[{"es", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"es", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"es", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", 
       RowBox[{"es", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "]"}], " ", "//", "Simplify"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.636285239958083*^9, 3.63628534405577*^9}, {
  3.6362853967940598`*^9, 3.6362854076860833`*^9}, {3.636285449268362*^9, 
  3.6362854573696365`*^9}, {3.6362855525580006`*^9, 3.6362856550639615`*^9}, {
  3.636285719795676*^9, 3.636285744637182*^9}, {3.6362857794284906`*^9, 
  3.6362858357143707`*^9}},ExpressionUUID->"1a3a2e0d-3560-4f6b-8af8-\
3461d9672c19"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6362852763558273`*^9, 3.6362853153943353`*^9}, 
   3.636285408088047*^9, 3.6362854590174885`*^9, {3.6362855671787095`*^9, 
   3.6362856579999037`*^9}, 3.6362857458831573`*^9, {3.636285779810483*^9, 
   3.6362857932862144`*^9}, {3.6362858247785883`*^9, 
   3.6362858368183484`*^9}},ExpressionUUID->"bd28a4ac-6833-4f9a-b403-\
9f606c7181df"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Checks", "Chapter",
 CellChangeTimes->{{3.636285090218025*^9, 
  3.63628509134405*^9}},ExpressionUUID->"e1f4bb0d-9fd1-4add-9558-\
20da117ce88b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"vDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2015", ",", " ", "4", ",", " ", "13", ",", " ", "0", ",", " ", "0", ",", 
     " ", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2016", ",", "4", ",", " ", "13", ",", " ", "0", ",", " ", "0", ",", " ", 
     "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"settDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2016", ",", "4", ",", " ", "13", ",", " ", "0", ",", " ", "0", ",", " ", 
     "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrierStartDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2015", ",", " ", "6", ",", " ", "1", ",", " ", "0", ",", "0", ",", "0"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"barrierEndDate", "=", 
   RowBox[{"{", 
    RowBox[{
    "2015", ",", " ", "8", ",", " ", "31", ",", " ", "0", ",", "0", ",", 
     "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.637898341986329*^9, 3.6378983543866725`*^9}, {
  3.6378983938957624`*^9, 3.6378984076921325`*^9}, {3.637898733616025*^9, 
  3.6378988442024045`*^9}},ExpressionUUID->"d0647dcf-d0dd-4214-a9d2-\
d884a60d2829"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"barrierOption", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"17.0", ",", "0.05", ",", "0.3"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"50.0", ",", 
      RowBox[{"0.05", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}], ",", " ", 
      RowBox[{"0.03", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}]}], "}"}], ",", "0.25", ",", "0.1", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"DateDifference", "[", 
         RowBox[{
         "vDate", ",", " ", "barrierStartDate", ",", " ", "\"\<Day\>\""}], 
         "]"}], "]"}], "/", "365.25"}], ",", 
      RowBox[{
       RowBox[{"QuantityMagnitude", "[", 
        RowBox[{"DateDifference", "[", 
         RowBox[{
         "vDate", ",", " ", "barrierEndDate", ",", " ", "\"\<Day\>\""}], 
         "]"}], "]"}], "/", "365.25"}], ",", 
      RowBox[{"10", " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "9"}]]}], ",", "55"}], "}"}], ",", "40", ",", 
    RowBox[{
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"DateDifference", "[", 
       RowBox[{"vDate", ",", " ", "expDate", ",", " ", "\"\<Day\>\""}], "]"}],
       "]"}], "/", "365.25"}], ",", 
    RowBox[{
     RowBox[{"QuantityMagnitude", "[", 
      RowBox[{"DateDifference", "[", 
       RowBox[{"vDate", ",", " ", "settDate", ",", " ", "\"\<Day\>\""}], 
       "]"}], "]"}], "/", "365.25"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}], " ", "/.", " ", 
  RowBox[{"BarrierOption`Private`n", " ", "\[Rule]", " ", "0"}]}]], "Input",
 CellChangeTimes->{{3.637898341986329*^9, 3.6378983543866725`*^9}, {
  3.6378983938957624`*^9, 3.6378984076921325`*^9}, {3.637898733616025*^9, 
  3.6378988442024045`*^9}, {3.637898888235452*^9, 3.6378989691725087`*^9}, {
  3.6388576057357054`*^9, 3.6388576159073195`*^9}, {3.638857660345004*^9, 
  3.6388577201946125`*^9}},ExpressionUUID->"be74b322-555d-4be9-886d-\
8ce7c7e309aa"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "unfl"}], "MessageName"], ":", 
  " ", "\<\"Underflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/unfl\\\", ButtonNote -> \
\\\"General::unfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474306694965`*^9},ExpressionUUID->"e3add398-73fe-4186-8d66-\
1edee70cbc61"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "unfl"}], "MessageName"], ":", 
  " ", "\<\"Underflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/unfl\\\", ButtonNote -> \
\\\"General::unfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474307294984`*^9},ExpressionUUID->"66b5d534-9ffd-47d1-8060-\
f48c1758360a"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "unfl"}], "MessageName"], ":", 
  " ", "\<\"Underflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/unfl\\\", ButtonNote -> \
\\\"General::unfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474307995005`*^9},ExpressionUUID->"def54c7c-da30-46d4-b491-\
3610aacf6403"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], ":", 
  " ", "\<\"Further output of \[NoBreak]\\!\\(\\*StyleBox[\\(General :: \
unfl\\), \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.653647430918505*^9},ExpressionUUID->"45d00e4a-3db4-4f3a-b196-\
6b87ea042bb4"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "ovfl"}], "MessageName"], ":", 
  " ", "\<\"Overflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/ovfl\\\", ButtonNote -> \
\\\"General::ovfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.65364743102551*^9},ExpressionUUID->"65a07df2-8d69-4580-aa3a-e1ea4a00f178"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "ovfl"}], "MessageName"], ":", 
  " ", "\<\"Overflow occurred in computation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/ovfl\\\", ButtonNote -> \
\\\"General::ovfl\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.638857721086666*^9, 
  3.6536474312555165`*^9},ExpressionUUID->"df29cba4-9d07-4485-b23a-\
2acdc34f0329"],

Cell[BoxData["0.008076972685936573`"], "Output",
 CellChangeTimes->{{3.638857593702981*^9, 3.6388576177184286`*^9}, {
   3.6388576642012367`*^9, 3.6388577213986855`*^9}, 
   3.653647431345519*^9},ExpressionUUID->"48313630-b35d-462e-9509-\
a2abef0f21f2"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"cp", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"50.", ",", " ", "0.", ",", " ", "0.35"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{"50.", ",", " ", "0.", ",", " ", "0.23"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"corr", "=", 
   RowBox[{"-", "0.98"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"intRate", "=", "0.025"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "365.242"}], ",", " ", "1.", ",", " ", "35.", ",", " ",
      "55."}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"strike", "=", "50."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", "1."}], ";", 
  RowBox[{"ts", "=", "1."}], ";", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "5"}], ",", "5"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7328823289109297`*^9, 3.7328824747805157`*^9}, 
   3.7328826024952855`*^9},
 CellLabel->"In[6]:=",ExpressionUUID->"07d694bc-5d9f-4aad-bf2c-6ce7533d7c3c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
   "intRate", ",", 
   RowBox[{"{", 
    RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
   "strike", ",", "t", ",", "ts", ",", 
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732882316901729*^9, 3.7328823169067297`*^9}, {
  3.7328824770007377`*^9, 3.7328825084848857`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"b46c9c00-8117-4a72-99c8-d2441b9ae728"],

Cell[BoxData["2.0587062988056033`"], "Output",
 CellChangeTimes->{3.7328825090229397`*^9, 3.732882609751011*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"ccdfa18b-f016-4c59-b35c-89cd3cc18e54"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
   "intRate", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "/", "2"}], ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], 
   ",", "strike", ",", "t", ",", "ts", ",", 
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732882631450181*^9, 3.7328826503790736`*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"527ceba6-8d7a-49cf-80ad-6cef78b24729"],

Cell[BoxData["2.7648606168718235`"], "Output",
 CellChangeTimes->{{3.7328826391869545`*^9, 3.732882655375573*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"4ad081b0-60b4-4e79-9fc3-03ebb1dc8541"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"doubleKnockOutOutsideBarrierOptionValue", "[", 
  RowBox[{"cp", ",", 
   RowBox[{"{", 
    RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
   RowBox[{"fd", "[", 
    RowBox[{"intRate", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<intRate\>\"", "\[Rule]", " ", "1"}], "|>"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "/", "2"}], ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], 
   ",", "strike", ",", "t", ",", "ts", ",", 
   RowBox[{"{", 
    RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7328827048875237`*^9, 3.732882716756711*^9}, {
  3.7328827665006847`*^9, 3.7328827886278973`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"f612a595-4ee6-41b7-a9d6-aef1ef605207"],

Cell[BoxData[
 TemplateBox[{
  "Merge","list1",
   "\"The argument \\!\\(\\*RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Times\\\", \
\\\"]\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\
\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"CDF\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.3728727728361896`\\\"}], \\\" \\\", \
\\\"BarrierOption`Private`n$4657\\\"}]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\
\"1\\\", \\\"\[Rule]\\\", \\\"#1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \
\\\"&\\\"}], \\\",\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \
\\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\
\\\", \\\"\[RightSkeleton]\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.98`\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\
\"0.7071067811865476`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.6929646455628166`\\\", \\\",\\\", \\\"0.7071067811865476`\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.35`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"2.857142857142857`\\\", \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"2.857142857142857`\\\"}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.34299999999999997`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"4.3478260869565215`\\\", \
\\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\
\"\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"4.3478260869565215`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{\\\"0.8330343813566166`\\\", \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"3.0743773095067284`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\) is not a valid list of Associations or rules or lists of \
rules.\"",2,14,5,25793760559478903617,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.7328833775257807`*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"79fc0761-e57f-4cae-8735-23a431a241d7"],

Cell[BoxData[
 TemplateBox[{
  "Merge","list1",
   "\"The argument \\!\\(\\*RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Times\\\", \
\\\"]\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"-\\\", \\\"1\\\"}], \\\",\\\", \
RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\
\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"-\\\", RowBox[{\\\"CDF\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}]}], \\\",\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.5187145557655952`\\\"}], \\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"2\\\", \\\"\[Rule]\\\", \
\\\"#1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.98`\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"19\\\", \\\"\[RightSkeleton]\\\"}]}], \\\
\"}\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\\\", \
\\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0.98`\\\", \\\",\
\\\", \\\"0.6929646455628166`\\\"}], \\\"}\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{\\\"0.98`\\\", \\\",\\\", \\\"1\\\", \\\",\\\", \\\
\"0.7071067811865476`\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{\\\"0.6929646455628166`\\\", \\\",\\\", \\\"0.7071067811865476`\\\", \
\\\",\\\", \\\"1\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.35`\\\", \\\"\[VeryThinSpace]\\\"}], \\\"+\\\", \
RowBox[{\\\"2.857142857142857`\\\", \\\" \\\", RowBox[{\\\"Plus\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\[Rule]\\\", \
\\\"2.857142857142857`\\\"}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{\\\"0.34299999999999997`\\\", \
\\\"\[VeryThinSpace]\\\"}], \\\"+\\\", RowBox[{\\\"4.3478260869565215`\\\", \
\\\" \\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}]}], \\\",\\\", RowBox[{\\\
\"\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"4.3478260869565215`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{\\\"0.8330343813566166`\\\", \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"-\\\", \\\"3.0743773095067284`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}]}]}], \
\\\"]\\\"}]\\) is not a valid list of Associations or rules or lists of \
rules.\"",2,14,6,25793760559478903617,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.7328833775797863`*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"309d0a76-a5da-425c-8a9c-a55532461f7e"],

Cell[BoxData[
 TemplateBox[{
  "Merge","list1",
   "\"The argument \\!\\(\\*RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Plus\\\", \\\"]\
\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", RowBox[{RowBox[{\\\
\"{\\\", RowBox[{RowBox[{RowBox[{\\\"-\\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]]}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\",\\\", \
RowBox[{SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\
\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"CDF\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"1\\\
\", \\\"\[Rule]\\\", \\\"#1\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"&\\\"}], \
\\\",\\\", RowBox[{RowBox[{\\\"-\\\", SuperscriptBox[\\\"\[ExponentialE]\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}]]}], \\\
\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}]}], \\\",\\\", RowBox[{\\\"Merge\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"propagatefd\\\", \\\"[\\\", \
RowBox[{RowBox[{RowBox[{RowBox[{\\\"Apply\\\", \\\"[\\\", \\\"Times\\\", \
\\\"]\\\"}], \\\"[\\\", RowBox[{\\\"ReplacePart\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"Rule\\\", \\\"[\\\
\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}]}], \\\"]\\\"}], \\\"]\\\"}], \\\"&\\\"}], \\\",\\\", \
RowBox[{\\\"CDF\\\", \\\"[\\\", RowBox[{RowBox[{\\\"MultinormalDistribution\\\
\", \\\"[\\\", RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"0\\\", \\\",\\\", \\\"0\
\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\
\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\\\", \
RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", \\\"2.857142857142857`\\\"}], \
\\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\[Rule]\\\", RowBox[{\\\"-\\\", \
\\\"4.3478260869565215`\\\"}]}], \\\"\[RightAssociation]\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"1.9461112359838753`\\\"}], \\\",\\\", RowBox[{\
\\\"\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \\\"\
\[Rule]\\\", RowBox[{\\\"-\\\", \\\"3.0743773095067284`\\\"}]}], \\\"\
\[RightAssociation]\\\"}]}], \\\"]\\\"}]}], \\\"}\\\"}]}], \\\"]\\\"}], \\\",\
\\\", RowBox[{\\\"-\\\", RowBox[{\\\"CDF\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"MultinormalDistribution\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\
\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"}\\\"}]}], \
\\\"]\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"fd\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\",\\\", RowBox[{\\\"fd\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"}\\\"}]}], \
\\\"]\\\"}]}]}], \\\"]\\\"}], \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"11\\\", \\\"\[RightSkeleton]\\\"}], \\\",\\\", RowBox[{\\\"\
\[LeftAssociation]\\\", RowBox[{\\\"\\\\\\\"intRate\\\\\\\"\\\", \
\\\"\[Rule]\\\", RowBox[{\\\"18.90359168241966`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.5187145557655952`\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"20\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"\[VeryThinSpace]\\\"}], \\\"-\\\", \
RowBox[{RowBox[{\\\"\[LeftSkeleton]\\\", \\\"19\\\", \
\\\"\[RightSkeleton]\\\"}], \\\" \\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"28\\\", \\\"\[RightSkeleton]\\\"}]}]}], \\\")\\\"}]}]], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"0.19062035960864987`\\\", \\\"\
\[VeryThinSpace]\\\"}], \\\"-\\\", RowBox[{\\\"0.9039702474861144`\\\", \\\" \
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"28\\\", \
\\\"\[RightSkeleton]\\\"}]}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\")\
\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"}\\\"}], \\\",\\\", \
\\\"Total\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]\\) is not a valid list of \
Associations or rules or lists of rules.\"",2,14,7,25793760559478903617,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.732883377882817*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"677cd45c-3278-4561-a9a2-edf787bb7f5b"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Merge\\\", \\\"::\\\", \
\\\"list1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,14,8,25793760559478903617,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.73288271785082*^9, 3.7328827895259867`*^9, {3.7328833604970784`*^9, 
   3.7328833780688353`*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"30993af4-870a-4460-9389-010348675ab0"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7328827453245673`*^9, 3.7328827931113453`*^9, {3.732883372245253*^9, 
   3.732883381994228*^9}},
 CellLabel->"Out[14]=",ExpressionUUID->"052b61d9-0115-4d44-b291-22273a84792c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "CDF", "]"}]], "Input",
 CellChangeTimes->{{3.7328831905740876`*^9, 3.732883194505481*^9}},
 CellLabel->"In[26]:=",ExpressionUUID->"1d1c5812-3f89-46f9-a55a-e313cd43fc47"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Protected", ",", "ReadProtected"}], "}"}]], "Output",
 CellChangeTimes->{3.732883196690699*^9},
 CellLabel->"Out[26]=",ExpressionUUID->"9e78b6ca-9f79-4e7e-a95c-edf842a47d3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Attributes", "[", "PDF", "]"}]], "Input",
 CellChangeTimes->{{3.732883230614091*^9, 3.7328832372517548`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"3c788f70-e7aa-4073-a499-2d417fe49afd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Protected", ",", "ReadProtected"}], "}"}]], "Output",
 CellChangeTimes->{3.7328832374647765`*^9},
 CellLabel->"Out[27]=",ExpressionUUID->"925ceb1d-55c8-4664-9952-0be6f8b5e403"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Port to Python", "Chapter",
 CellChangeTimes->{{3.636285090218025*^9, 3.63628509134405*^9}, {
  3.636354549595379*^9, 3.636354550437396*^9}, {3.6378990856151724`*^9, 
  3.6378990886691723`*^9}},ExpressionUUID->"75b4616d-cb2d-4656-87bd-\
17ed2a8e38bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], ",", 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], ",", "1", ",", 
      SqrtBox[
       FractionBox["t1", "t2"]]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}], ",", 
      SqrtBox[
       FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}], " ", "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.653650479289018*^9, 
  3.653650493315421*^9}},ExpressionUUID->"516df623-c1b4-4d39-8e19-\
f21438f0427c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], 
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}]},
     {
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t2", "t"]]}], "1", 
      SqrtBox[
       FractionBox["t1", "t2"]]},
     {
      RowBox[{
       RowBox[{"-", "corr"}], " ", "cp", " ", 
       SqrtBox[
        FractionBox["t1", "t"]]}], 
      SqrtBox[
       FractionBox["t1", "t2"]], "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6536504936784573`*^9},ExpressionUUID->"0acf2943-b76c-48b1-ad84-\
041d41afed55"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"value", "=", 
   RowBox[{
    RowBox[{"barrierOption", "[", 
     RowBox[{"cp", ",", 
      RowBox[{"{", 
       RowBox[{"sUnd", ",", "sYield", ",", "sVol"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"bUnd", ",", "bYield", ",", "bVol"}], "}"}], ",", "corr", ",", 
      "intRate", ",", 
      RowBox[{"{", 
       RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
      "strike", ",", "t", ",", " ", "ts", ",", 
      RowBox[{"{", 
       RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"BarrierOption`Private`n", "  ", "\[Rule]", " ", "n"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6378992254986725`*^9, 3.637899289539672*^9}, {
  3.653649824688565*^9, 3.6536498354616423`*^9}, {3.653650241063198*^9, 
  3.653650246359728*^9}},ExpressionUUID->"370b5de4-7fd2-4358-acdf-\
2b8061d3869b"],

Cell[CellGroupData[{

Cell[BoxData["value"], "Input",
 CellChangeTimes->{{3.653650344671558*^9, 
  3.653650345106601*^9}},ExpressionUUID->"267e35c6-d1f1-4dc3-9af0-\
3edefaa40ee3"],

Cell[BoxData[
 RowBox[{"cp", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "sYield"}], " ", "t"}]], " ", "sUnd", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate", "+", 
             RowBox[{"bVol", " ", "corr", " ", "sVol"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "bUnd"], "]"}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                   "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "-", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate", "+", 
             RowBox[{"bVol", " ", "corr", " ", "sVol"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"cp", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"sVol", " ", 
                  SqrtBox["t"]}], "+", 
                 FractionBox[
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                     " ", "t"}], "+", 
                   FractionBox[
                    RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                    "bVol"], "-", 
                   RowBox[{"Log", "[", 
                    FractionBox["strike", "sUnd"], "]"}]}], 
                  RowBox[{"sVol", " ", 
                   SqrtBox["t"]}]]}], ")"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t2"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t2"}], "-", 
                 RowBox[{"2", " ", 
                  RowBox[{"Log", "[", 
                   FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}], "+", 
                 RowBox[{"2", " ", "n", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t2"]}]]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "corr"}], " ", "sVol", " ", 
                SqrtBox["t1"]}], "+", 
               FractionBox[
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                    "intRate"}], ")"}], " ", "t1"}], "+", 
                 RowBox[{"Log", "[", 
                  FractionBox["bLow", "bUnd"], "]"}]}], 
                RowBox[{"bVol", " ", 
                 SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "intRate"}], " ", "t"}]], " ", "strike", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate"}], ")"}], " ", "n", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Log", "[", 
              FractionBox["bHigh", "bUnd"], "]"}], "+", 
             RowBox[{"Log", "[", 
              FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"2", " ", "corr", " ", "n", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], 
                  "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "-", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              FractionBox[
               SuperscriptBox["bVol", "2"], "2"]}], "-", "bYield", "+", 
             "intRate"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
             RowBox[{"2", " ", "n", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
          SuperscriptBox["bVol", "2"]]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "-", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bHigh", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}], "+", 
          RowBox[{"CDF", "[", 
           RowBox[{
            RowBox[{"MultinormalDistribution", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", 
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t2", "t"]]}], ",", "1", ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "corr"}], " ", "cp", " ", 
                   SqrtBox[
                    FractionBox["t1", "t"]]}], ",", 
                  SqrtBox[
                   FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              FractionBox[
               RowBox[{"cp", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"intRate", "-", 
                    FractionBox[
                    SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}],
                    " ", "t"}], "+", 
                  FractionBox[
                   RowBox[{"corr", " ", "sVol", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}]}], "-", 
                    RowBox[{"2", " ", "n", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                    RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], ")"}]}], 
                   "bVol"], "-", 
                  RowBox[{"Log", "[", 
                   FractionBox["strike", "sUnd"], "]"}]}], ")"}]}], 
               RowBox[{"sVol", " ", 
                SqrtBox["t"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t2"}], "-", 
                RowBox[{"2", " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["bHigh", "bUnd"], "]"}]}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}], "+", 
                RowBox[{"2", " ", "n", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    FractionBox["bHigh", "bUnd"], "]"}], "+", 
                   RowBox[{"Log", "[", 
                    FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t2"]}]], ",", 
              FractionBox[
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   FractionBox[
                    SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
                   "intRate"}], ")"}], " ", "t1"}], "+", 
                RowBox[{"Log", "[", 
                 FractionBox["bLow", "bUnd"], "]"}]}], 
               RowBox[{"bVol", " ", 
                SqrtBox["t1"]}]]}], "}"}]}], "]"}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.65365034579467*^9, 3.65381511499807*^9, 
  3.653815184820739*^9},ExpressionUUID->"792cab9b-1c85-43bc-a00c-\
8d99192d75f2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Junk", "Chapter",
 CellChangeTimes->{{3.636285090218025*^9, 3.63628509134405*^9}, {
  3.636354549595379*^9, 
  3.636354550437396*^9}},ExpressionUUID->"26de32d0-bcfd-4552-ad87-\
d75be2af4510"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gammaMat", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", 
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t2", "t"]]}], ",", 
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t1", "t"]]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t2", "t"]]}], ",", "1", ",", 
       SqrtBox[
        FractionBox["t1", "t2"]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "cp", " ", 
        SqrtBox[
         FractionBox["t1", "t"]]}], ",", 
       SqrtBox[
        FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6538153567792125`*^9, 
  3.653815366336441*^9}},ExpressionUUID->"b93c0c4b-96a2-4cad-bf8b-\
d6baa1268a11"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{"gammaMat", ",", " ", 
   RowBox[{"t1", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6538153675104604`*^9, 
  3.653815374772585*^9}},ExpressionUUID->"d1c06d8d-dc10-4d20-81cb-\
be657eb033be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{
      RowBox[{"-", "corr"}], " ", "cp", " ", 
      SqrtBox[
       FractionBox["t2", "t"]]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "corr"}], " ", "cp", " ", 
      SqrtBox[
       FractionBox["t2", "t"]]}], ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6538153756356*^9},ExpressionUUID->"3fe70b11-e2cc-4cea-8f44-9d8ce6febe87"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", " ", "0", ",", " ", "0"}], "}"}], ",", " ", 
       RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"0.1", ",", "0.2", " ", ",", "x"}], "}"}]}], "]"}], ",", " ", 
   RowBox[{"x", "\[Rule]", "Infinity"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.732881807018746*^9, 3.7328819063146744`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"f0925c1d-18de-419f-aecb-29270505abb0"],

Cell[BoxData["0.3127005161682312`"], "Output",
 CellChangeTimes->{{3.7328818543864822`*^9, 3.732881907518795*^9}},
 CellLabel->"Out[17]=",ExpressionUUID->"548681a1-ed54-42d6-813b-fdecd356d865"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"FullSimplify", "[", 
   RowBox[{"PDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{"-", "corr"}], " ", "cp", " ", 
            SqrtBox[
             FractionBox["t2", "t"]]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "corr"}], " ", "cp", " ", 
            SqrtBox[
             FractionBox["t2", "t"]]}], ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}], "==", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{
             RowBox[{"-", "corr"}], " ", "cp", " ", 
             SqrtBox[
              FractionBox["t2", "t"]]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "corr"}], " ", "cp", " ", 
             SqrtBox[
              FractionBox["t2", "t"]]}], ",", "1"}], "}"}]}], "}"}]}], "]"}], 
      ",", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y"}], "}"}]}], "]"}], " ", 
    RowBox[{"PDF", "[", 
     RowBox[{
      RowBox[{"NormalDistribution", "[", 
       RowBox[{"0", ",", "1"}], "]"}], ",", " ", "z"}], "]"}]}], "]"}], 
  " "}]], "Input",
 CellChangeTimes->{{3.653815502613041*^9, 
  3.6538156026024218`*^9}},ExpressionUUID->"315f94aa-d991-4f93-ae79-\
d4ac1761d557"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.653815523866023*^9, 3.6538155420623274`*^9}, {
  3.6538155848820972`*^9, 
  3.6538156038834624`*^9}},ExpressionUUID->"1dc82ed8-e878-41a7-b541-\
a4873f397e2e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{"CDF", "[", 
   RowBox[{
    RowBox[{"MultinormalDistribution", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t2", "t"]]}], ",", 
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t1", "t"]]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t2", "t"]]}], ",", "1", ",", 
          SqrtBox[
           FractionBox["t1", "t2"]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "corr"}], " ", "cp", " ", 
           SqrtBox[
            FractionBox["t1", "t"]]}], ",", 
          SqrtBox[
           FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"cp", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"sVol", " ", 
          SqrtBox["t"]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"intRate", "-", 
              FractionBox[
               SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ",
             "t"}], "+", 
           FractionBox[
            RowBox[{
            "2", " ", "corr", " ", "BarrierOption`Private`n", " ", "sVol", 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Log", "[", 
                FractionBox["bHigh", "bUnd"], "]"}], "+", 
               RowBox[{"Log", "[", 
                FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], "-", 
           RowBox[{"Log", "[", 
            FractionBox["strike", "sUnd"], "]"}]}], 
          RowBox[{"sVol", " ", 
           SqrtBox["t"]}]]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "sVol", " ", 
        SqrtBox["t2"]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
            "intRate"}], ")"}], " ", "t2"}], "+", 
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "bUnd"], "]"}], "-", 
         RowBox[{"2", " ", "BarrierOption`Private`n", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Log", "[", 
             FractionBox["bHigh", "bUnd"], "]"}], "+", 
            RowBox[{"Log", "[", 
             FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
        RowBox[{"bVol", " ", 
         SqrtBox["t2"]}]]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "corr"}], " ", "sVol", " ", 
        SqrtBox["t1"]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
            "intRate"}], ")"}], " ", "t1"}], "+", 
         RowBox[{"Log", "[", 
          FractionBox["bHigh", "bUnd"], "]"}]}], 
        RowBox[{"bVol", " ", 
         SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.63790018654408*^9, 3.6379001925242233`*^9}, {
  3.6379002905228586`*^9, 
  3.637900298651046*^9}},ExpressionUUID->"0a0ec0da-77d3-45f2-a9dd-\
729c22bcb592"],

Cell[BoxData[
 RowBox[{"CDF", "[", 
  RowBox[{
   RowBox[{"MultinormalDistribution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t2", "t"]]}], ",", 
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t1", "t"]]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t2", "t"]]}], ",", "1", ",", 
         SqrtBox[
          FractionBox["t1", "t2"]]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "corr"}], " ", "cp", " ", 
          SqrtBox[
           FractionBox["t1", "t"]]}], ",", 
         SqrtBox[
          FractionBox["t1", "t2"]], ",", "1"}], "}"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"cp", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sVol", " ", 
         SqrtBox["t"]}], "+", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"intRate", "-", 
             FractionBox[
              SuperscriptBox["sVol", "2"], "2"], "-", "sYield"}], ")"}], " ", 
           "t"}], "+", 
          FractionBox[
           RowBox[{
           "2", " ", "corr", " ", "BarrierOption`Private`n", " ", "sVol", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", 
               FractionBox["bHigh", "bUnd"], "]"}], "+", 
              RowBox[{"Log", "[", 
               FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}], "bVol"], "-", 
          RowBox[{"Log", "[", 
           FractionBox["strike", "sUnd"], "]"}]}], 
         RowBox[{"sVol", " ", 
          SqrtBox["t"]}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "sVol", " ", 
       SqrtBox["t2"]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
           "intRate"}], ")"}], " ", "t2"}], "+", 
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "bUnd"], "]"}], "-", 
        RowBox[{"2", " ", "BarrierOption`Private`n", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", 
            FractionBox["bHigh", "bUnd"], "]"}], "+", 
           RowBox[{"Log", "[", 
            FractionBox["bLow", "bUnd"], "]"}]}], ")"}]}]}], 
       RowBox[{"bVol", " ", 
        SqrtBox["t2"]}]]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "corr"}], " ", "sVol", " ", 
       SqrtBox["t1"]}], "+", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            SuperscriptBox["bVol", "2"], "2"], "+", "bYield", "-", 
           "intRate"}], ")"}], " ", "t1"}], "+", 
        RowBox[{"Log", "[", 
         FractionBox["bHigh", "bUnd"], "]"}]}], 
       RowBox[{"bVol", " ", 
        SqrtBox["t1"]}]]}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.6379001828500037`*^9, 3.6379001937102475`*^9}, 
   3.637900300328086*^9},ExpressionUUID->"666de570-4dcc-4501-9e59-\
0384f74a22b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"subs", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"CDF", "[", 
     RowBox[{
      RowBox[{"MultinormalDistribution", "[", 
       RowBox[{"mean_", ",", " ", "cov_"}], "]"}], ",", " ", "point_"}], 
     "]"}], "\[Rule]", " ", 
    RowBox[{"mvnscdf", "[", 
     RowBox[{"mean", ",", " ", "cov", ",", " ", "point"}], "]"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.6379003029911427`*^9, 3.6379003535834093`*^9}, {
  3.6536499873808327`*^9, 
  3.6536500627113647`*^9}},ExpressionUUID->"a5cb283f-d249-474f-94a7-\
60bf5e8570bd"],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"MultinormalDistribution", "::", "arprm"}], "MessageName"], ":", 
  " ", "\<\"-- Message text not found -- (\[NoBreak]\\!\\(mean_\\)\[NoBreak]) \
(\[NoBreak]\\!\\(1\\)\[NoBreak]) (\[NoBreak]\\!\\(MultinormalDistribution[\\(\
\\(mean_, cov_\\)\\)]\\)\[NoBreak]) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/MultinormalDistribution\\\", ButtonNote -> \
\\\"MultinormalDistribution::arprm\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.653650040586152*^9},ExpressionUUID->"1f40051c-695e-4200-a3e9-\
607e22c8c6bb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"CDF", "[", 
    RowBox[{
     RowBox[{"MultinormalDistribution", "[", 
      RowBox[{"mean_", ",", "cov_"}], "]"}], ",", "point_"}], "]"}], 
   "\[Rule]", 
   RowBox[{"mvnscdf", "[", 
    RowBox[{"mean", ",", "cov", ",", "point"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6536500405891523`*^9},ExpressionUUID->"48350ea4-fbc0-4b46-8cc4-\
d20bf94df952"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"xxx", "=", 
  RowBox[{
   RowBox[{"barrierOption", "[", 
    RowBox[{"1", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "vol"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", "vol"}], "}"}], ",", "corr", ",", "intRate",
      ",", 
     RowBox[{"{", 
      RowBox[{"t1", ",", "t2", ",", "bLow", ",", "bHigh"}], "}"}], ",", 
     "strike", ",", "t", ",", "ts", ",", 
     RowBox[{"{", 
      RowBox[{"nMin", ",", "nMax"}], "}"}]}], "]"}], " ", "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.7325159006834087`*^9, 3.7325159664469843`*^9}, {
  3.732600954468045*^9, 3.732600987646045*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"90a0b17f-f6d5-4ba1-8d91-577b158db02f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", "1.23", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", "0.45", "}"}], "}"}]}], "]"}], "[", 
  RowBox[{"{", "0.56", "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.7329649337175026`*^9, 3.7329649604625025`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"fc92d22e-904a-48eb-a256-6097df77540a"],

Cell[BoxData["0.15895135783295036`"], "Output",
 CellChangeTimes->{{3.732964948440503*^9, 3.7329649607315025`*^9}, 
   3.732965021950503*^9, 3.7329650984815025`*^9},
 CellLabel->"Out[5]=",ExpressionUUID->"7cf48ea1-8dec-42a4-b1c7-5e8f8d99bca2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", "1.23", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", "0.45", "}"}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"fd", "[", 
    RowBox[{"0.56", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.732965030747503*^9, 3.7329650417785025`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"cc736091-7bd2-45b6-b2e6-ce6319cc7b2f"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.15895135783295036`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"x1\"\>", "\[Rule]", "0.3611497947266298`"}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7329650424655027`*^9, 3.7329651001515026`*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"4631502b-c68f-4b87-831f-ea0a96396c0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", "1.23", "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"fd", "[", 
       RowBox[{"0.45", ",", " ", 
        RowBox[{"<|", 
         RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
     "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"fd", "[", 
    RowBox[{"0.56", ",", " ", 
     RowBox[{"<|", 
      RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.732965170315503*^9, 3.7329651815545025`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"3341e86e-58c6-410b-961e-3c19c30d7266"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.15895135783295036`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"vol1\"\>", "\[Rule]", "0.26885595829649106`"}], ",", 
     RowBox[{"\<\"x1\"\>", "\[Rule]", "0.3611497947266298`"}]}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7329651824675026`*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"618fb676-84d6-421d-8fe0-d2c5120c9dcc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1.23", ",", " ", "0.321"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.45", " ", "0.45"}], ",", " ", 
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}], ",", " ", 
        RowBox[{"0.32", " ", "0.32"}]}], "}"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{"0.56", ",", " ", 
    RowBox[{"-", "0.12"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.732965213536503*^9, 3.7329652824364915`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"81f14485-0fdb-4534-a522-31e96fd46f6b"],

Cell[BoxData["0.06308407937920026`"], "Output",
 CellChangeTimes->{3.7329652833305807`*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"464e8ef5-c18e-4b8a-a591-9a1d304bbe57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"phi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1.23", ",", " ", "0.321"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.45", " ", "0.45"}], ",", " ", 
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0.98", " ", "0.45", " ", "0.32"}], ",", " ", 
        RowBox[{"0.32", " ", "0.32"}]}], "}"}]}], "}"}]}], "]"}], "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"fd", "[", 
     RowBox[{"0.56", ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", " ", 
    RowBox[{"fd", "[", 
     RowBox[{
      RowBox[{"-", "0.12"}], ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<x2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7329652907893267`*^9, 3.732965315158763*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"cb2fe641-0ed5-4e03-bc6b-fb334c6b568a"],

Cell[BoxData[
 RowBox[{"CDF", "[", 
  RowBox[{
   RowBox[{"MultinormalDistribution", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1.`", ",", "0.9799999999999999`"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.9799999999999999`", ",", "1.`"}], "}"}]}], "}"}]}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "1.4888888888888887`"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"x1\"\>", "\[Rule]", "2.2222222222222223`"}], 
        "\[RightAssociation]"}]}], "]"}], ",", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "1.378125`"}], ",", 
       RowBox[{"\[LeftAssociation]", 
        RowBox[{"\<\"x2\"\>", "\[Rule]", "3.125`"}], 
        "\[RightAssociation]"}]}], "]"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7329653157968273`*^9},
 CellLabel->"Out[11]=",ExpressionUUID->"97c35a00-6bf4-4ad3-bfdb-0f310c082620"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", "0.1", "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"{", "0.45", "}"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"-", "1.032"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7331214144309044`*^9, 3.7331214382232833`*^9}, {
  3.7331216833087893`*^9, 3.733121701796638*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"843df714-47ca-47f3-acd6-1de5ad2bfbd3"],

Cell[BoxData["0.24079617639196618`"], "Output",
 CellChangeTimes->{
  3.7331214388743486`*^9, 3.7331216164731064`*^9, {3.7331216748599443`*^9, 
   3.7331217022796865`*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"4b2db56f-d6fc-4016-b877-9ec9e37572c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fd", "[", 
     RowBox[{"0.1", ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<m1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], ",", 
   " ", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"fd", "[", 
      RowBox[{"0.45", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], 
    "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"fd", "[", 
     RowBox[{
      RowBox[{"-", "1.032"}], ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7331217164831066`*^9, 3.7331217307495327`*^9}, {
  3.733121828890346*^9, 3.733121853690826*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"58cb1883-86d6-4796-b721-1ecf5f0ac5e6"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.24079617639196618`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"x1\"\>", "\[Rule]", "0.6057361592793461`"}], ",", 
     RowBox[{"\<\"m1\"\>", "\[Rule]", 
      RowBox[{"-", "0.6057361592793461`"}]}], ",", 
     RowBox[{"\<\"vol1\"\>", "\[Rule]", "0.761881480338022`"}]}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.7331217313355913`*^9, 3.733121823221779*^9, 
  3.733121854302887*^9},
 CellLabel->"Out[6]=",ExpressionUUID->"1d7493bd-f5c8-4a61-82aa-08ddacf0aa1b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", " ", 
     RowBox[{"-", "0.3"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.45", " ", "0.45"}], ",", " ", 
       RowBox[{"0.98", " ", "0.45", " ", "0.33"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.98", " ", "0.45", " ", "0.33"}], ",", " ", 
       RowBox[{"0.33", " ", "0.33"}]}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"0.032", ",", " ", 
     RowBox[{"-", "0.0547"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7331222485323057`*^9, 3.7331223467511272`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"6df89177-9545-4bea-b477-c55b3b6c233d"],

Cell[BoxData["0.00021817644223337968`"], "Output",
 CellChangeTimes->{{3.733122291214574*^9, 3.73312234757921*^9}, 
   3.733122715750023*^9},
 CellLabel->"Out[18]=",ExpressionUUID->"a3f45e65-84d4-4fb8-b04f-ae4bfd7af2ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"smallPhi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"0.1", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<mu1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", " ", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "0.3"}], ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<mu2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}], 
   ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"fd", "[", 
         RowBox[{"0.45", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "2"], 
       ",", " ", 
       RowBox[{
        RowBox[{"fd", "[", 
         RowBox[{"0.98", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<rho12\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], " ", 
        RowBox[{"fd", "[", 
         RowBox[{"0.45", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], 
        RowBox[{"fd", "[", " ", 
         RowBox[{"0.33", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}]}], 
      "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"fd", "[", 
         RowBox[{"0.98", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<rho12\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], " ", 
        RowBox[{"fd", "[", 
         RowBox[{"0.45", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], " ", 
        RowBox[{"fd", "[", " ", 
         RowBox[{"0.33", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], ",", 
       SuperscriptBox[
        RowBox[{"fd", "[", " ", 
         RowBox[{"0.33", ",", " ", 
          RowBox[{"<|", 
           RowBox[{"\"\<vol2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "2"]}], 
      "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"fd", "[", 
      RowBox[{"0.032", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<x1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], ",", " ", 
     RowBox[{"fd", "[", 
      RowBox[{
       RowBox[{"-", "0.0547"}], ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<x2\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.733122356623114*^9, 3.733122381744626*^9}, {
  3.733122414145866*^9, 3.7331225230797577`*^9}, {3.7331366085982304`*^9, 
  3.7331366113405046`*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"7fb5d600-557e-4871-9b94-ac1c805b6d3c"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{"0.00021817644223337968`", ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"vol2\"\>", "\[Rule]", "0.011062818681972357`"}], ",", 
     RowBox[{"\<\"vol1\"\>", "\[Rule]", "0.0016273119111074933`"}], ",", 
     RowBox[{"\<\"rho12\"\>", "\[Rule]", 
      RowBox[{"-", "0.10368823414264175`"}]}], ",", 
     RowBox[{"\<\"x2\"\>", "\[Rule]", 
      RowBox[{"-", "0.014882715715657881`"}]}], ",", 
     RowBox[{"\<\"mu2\"\>", "\[Rule]", "0.014882715715657881`"}], ",", 
     RowBox[{"\<\"mu1\"\>", "\[Rule]", 
      RowBox[{"-", "0.010768975882328698`"}]}], ",", 
     RowBox[{"\<\"x1\"\>", "\[Rule]", "0.010768975882328698`"}]}], 
    "\[RightAssociation]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.733122717898238*^9, 3.733123503685809*^9, 
  3.7331239564900846`*^9, 3.7331366118385544`*^9, 3.733138371530506*^9},
 CellLabel->"Out[13]=",ExpressionUUID->"0a7e3a34-292a-4185-a1b1-89179e98f727"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi", "[", 
  RowBox[{
   RowBox[{"{", "0.1", "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"{", "0.45", "}"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"-", "1.032"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.733138406693022*^9, 3.7331384299063425`*^9}, {
  3.7334645726034994`*^9, 3.733464582795519*^9}, {3.733464655036742*^9, 
  3.7334646633175697`*^9}, {3.733464708628101*^9, 3.7334647132005577`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"e1f5569b-5313-4999-9bd7-02f43863c77f"],

Cell[BoxData["0.07693686654295023`"], "Output",
 CellChangeTimes->{
  3.7331384318635387`*^9, 3.7331385027706285`*^9, 3.7334644540576463`*^9, {
   3.733464548725112*^9, 3.7334645831835575`*^9}, {3.7334646496932077`*^9, 
   3.7334646636025987`*^9}, {3.7334647139846363`*^9, 3.733464739052143*^9}, 
   3.7334647747197094`*^9, 3.733465408700101*^9, 3.7334655983390627`*^9},
 CellLabel->"Out[25]=",ExpressionUUID->"14cf20d0-ae04-4eea-96a8-71c81969c57d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.1", ",", " ", 
     RowBox[{"-", "0.2"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.45", " ", "0.45"}], ",", " ", 
       RowBox[{
        RowBox[{"-", "0.98"}], " ", "0.45", " ", "0.3"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.98"}], " ", "0.45", " ", "0.3"}], ",", " ", 
       RowBox[{"0.3", " ", "0.3"}]}], "}"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1.032"}], ",", " ", "0.5"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7334656121204405`*^9, 3.7334656593101597`*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"ccd78427-fbd1-4aa8-acf2-5e89b5f635bb"],

Cell[BoxData["0.0003471508891822327`"], "Output",
 CellChangeTimes->{{3.733465648149043*^9, 3.7334656598282113`*^9}},
 CellLabel->"Out[27]=",ExpressionUUID->"7c30a7fc-cd77-48d7-ba8e-7839782be436"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"phi", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"fd", "[", 
     RowBox[{"0.1", ",", " ", 
      RowBox[{"<|", 
       RowBox[{"\"\<m1\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}], "}"}], ",", 
   " ", 
   RowBox[{"{", 
    RowBox[{"{", "0.45", "}"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"-", "1.032"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7334657847657037`*^9, 3.733465798081035*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"d6baadc3-8503-42ce-8a90-f3f7854e63d6"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"m1\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"2.2222222222222223`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}]\\) has \
evaluated to non-numerical values for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.032`\\\"}]}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",2,28,6,
   25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.733465799438171*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"466dc360-0f1a-4995-a182-09262e07f54a"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"m1\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"2.2222222222222223`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}]\\) has \
evaluated to non-numerical values for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.032`\\\"}]}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",2,28,7,
   25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7334657994451714`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"e6509476-acc6-4a92-bfcd-20fae17e8792"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate","inumr",
   "\"The integrand \\!\\(\\*RowBox[{\\\"fd\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"1.`\\\", \\\" \\\", \
SuperscriptBox[\\\"\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]]}], \\\",\\\", RowBox[{\\\"\[LeftAssociation]\\\", \
RowBox[{\\\"\\\\\\\"m1\\\\\\\"\\\", \\\"\[Rule]\\\", \
RowBox[{\\\"2.2222222222222223`\\\", \\\" \\\", SuperscriptBox[\\\"\
\[ExponentialE]\\\", RowBox[{RowBox[{\\\"-\\\", \
\\\"1.1111111111111112`\\\"}], \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}], \\\"2\\\"]}]], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"0.1`\\\"}], \\\"+\\\", \\\"z35\\\"}], \
\\\")\\\"}]}]}], \\\"\[RightAssociation]\\\"}]}], \\\"]\\\"}]\\) has \
evaluated to non-numerical values for all sampling points in the region with \
boundaries \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"-\\\", \\\"\[Infinity]\\\"}], \\\",\\\", \
RowBox[{\\\"-\\\", \\\"1.032`\\\"}]}], \\\"}\\\"}], \\\"}\\\"}]\\).\"",2,28,8,
   25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7334657994951763`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"b7ca2181-2f26-44c5-a17e-c2f5eab41286"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"NIntegrate\\\", \
\\\"::\\\", \\\"inumr\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,28,9,25797568102423367858,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7334657995471816`*^9},
 CellLabel->
  "During evaluation of \
In[28]:=",ExpressionUUID->"6cc015af-3e9c-48ab-8bb9-946d650a89be"],

Cell[BoxData[
 RowBox[{"NIntegrate", "[", 
  RowBox[{
   RowBox[{"fd", "[", 
    RowBox[{
     RowBox[{"1.`", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "1.1111111111111112`"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "0.1`"}], "+", "z35"}], ")"}], "2"]}]]}], ",", 
     RowBox[{"\[LeftAssociation]", 
      RowBox[{"\<\"m1\"\>", "\[Rule]", 
       RowBox[{"2.2222222222222223`", " ", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "1.1111111111111112`"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "0.1`"}], "+", "z35"}], ")"}], "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "0.1`"}], "+", "z35"}], ")"}]}]}], 
      "\[RightAssociation]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"z35", ",", 
     RowBox[{"-", "\[Infinity]"}], ",", 
     RowBox[{"-", "1.032`"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.733465799597187*^9},
 CellLabel->"Out[28]=",ExpressionUUID->"10136733-d257-4d08-817e-f01be0889219"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Dt", "[", 
   RowBox[{
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"f", "[", 
       RowBox[{"t", ",", "x1", ",", "x2"}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x1", ",", " ", "lb1", ",", " ", "ub1"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x2", ",", " ", "lb2", ",", " ", "ub2"}], "}"}]}], "]"}], ",", 
    " ", "t"}], "]"}], " ", "//", " ", "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.7334852716021924`*^9, 3.733485353804412*^9}, {
  3.7334857253445625`*^9, 
  3.7334857551995473`*^9}},ExpressionUUID->"0b7e0e37-3741-47fb-9eb6-\
3bb5e8d9e4eb"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"ub3", "-", "lb3"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", "lb1", "ub1"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
           RowBox[{
            RowBox[{
             SuperscriptBox["f", 
              TagBox[
               RowBox[{"(", 
                RowBox[{"1", ",", "0", ",", "0"}], ")"}],
               Derivative],
              MultilineFunction->None], "(", 
             RowBox[{"t", ",", "x1", ",", "x2"}], ")"}], 
            RowBox[{"\[DifferentialD]", "x2"}]}]}], "-", 
          RowBox[{
           FractionBox[
            RowBox[{"\[DifferentialD]", "lb2"}], 
            RowBox[{"\[DifferentialD]", "t"}],
            MultilineFunction->None], " ", 
           RowBox[{"f", "(", 
            RowBox[{"t", ",", "x1", ",", "lb2"}], ")"}]}], "+", 
          RowBox[{
           FractionBox[
            RowBox[{"\[DifferentialD]", "ub2"}], 
            RowBox[{"\[DifferentialD]", "t"}],
            MultilineFunction->None], " ", 
           RowBox[{"f", "(", 
            RowBox[{"t", ",", "x1", ",", "ub2"}], ")"}]}]}], ")"}], 
        RowBox[{"\[DifferentialD]", "x1"}]}]}], "-", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", "lb1"}], 
        RowBox[{"\[DifferentialD]", "t"}],
        MultilineFunction->None], " ", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
        RowBox[{
         RowBox[{"f", "(", 
          RowBox[{"t", ",", "lb1", ",", "x2"}], ")"}], 
         RowBox[{"\[DifferentialD]", "x2"}]}]}]}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"\[DifferentialD]", "ub1"}], 
        RowBox[{"\[DifferentialD]", "t"}],
        MultilineFunction->None], " ", 
       RowBox[{
        SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
        RowBox[{
         RowBox[{"f", "(", 
          RowBox[{"t", ",", "ub1", ",", "x2"}], ")"}], 
         RowBox[{"\[DifferentialD]", "x2"}]}]}]}]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"\[DifferentialD]", "ub3"}], 
       RowBox[{"\[DifferentialD]", "t"}],
       MultilineFunction->None], "-", 
      FractionBox[
       RowBox[{"\[DifferentialD]", "lb3"}], 
       RowBox[{"\[DifferentialD]", "t"}],
       MultilineFunction->None]}], ")"}], " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "lb1", "ub1"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "lb2", "ub2"], 
      RowBox[{
       RowBox[{"f", "(", 
        RowBox[{"t", ",", "x1", ",", "x2"}], ")"}], 
       RowBox[{"\[DifferentialD]", "x2"}], 
       RowBox[{"\[DifferentialD]", "x1"}]}]}]}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.7334853074847803`*^9, 3.7334853542234535`*^9}, 
   3.733485731336161*^9},
 CellLabel->
  "Out[34]//TraditionalForm=",ExpressionUUID->"f1aedf49-73bb-4eb1-8b7b-\
5cc4ff5149c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"smallPhi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", ",", " ", "m2"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vol1", " ", "vol1"}], ",", " ", 
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"vol2", " ", "vol2"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7334857891879463`*^9, 3.733485856017628*^9}, 
   3.733486102775302*^9},
 CellLabel->"In[45]:=",ExpressionUUID->"b97a893c-ba69-4668-9aa4-5aa18c5fb6df"],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["\[ExponentialE]", 
   FractionBox[
    RowBox[{
     RowBox[{
      SuperscriptBox["m2", "2"], " ", 
      SuperscriptBox["vol1", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["m1", "2"], " ", 
      SuperscriptBox["vol2", "2"]}], "+", 
     RowBox[{
      SuperscriptBox["vol2", "2"], " ", 
      SuperscriptBox["x1", "2"]}], "-", 
     RowBox[{
     "2", " ", "rho12", " ", "vol1", " ", "vol2", " ", "x1", " ", "x2"}], "+", 
     RowBox[{
      SuperscriptBox["vol1", "2"], " ", 
      SuperscriptBox["x2", "2"]}], "-", 
     RowBox[{"2", " ", "m2", " ", "vol1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m1", " ", "rho12", " ", "vol2"}], "-", 
        RowBox[{"rho12", " ", "vol2", " ", "x1"}], "+", 
        RowBox[{"vol1", " ", "x2"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "m1", " ", "vol2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "vol2"}], " ", "x1"}], "+", 
        RowBox[{"rho12", " ", "vol1", " ", "x2"}]}], ")"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["rho12", "2"]}], ")"}], " ", 
     SuperscriptBox["vol1", "2"], " ", 
     SuperscriptBox["vol2", "2"]}]]], 
  SqrtBox[
   RowBox[{"1", "-", 
    SuperscriptBox["rho12", "2"]}]]]], "Output",
 CellChangeTimes->{{3.733485830645091*^9, 3.7334858573837647`*^9}, 
   3.733486103520376*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"630ce4f0-9a7e-4c52-975e-7ea3df9b74c7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"smallPhi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", ",", " ", "m2"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vol1", " ", "vol1"}], ",", " ", 
        RowBox[{"0", " ", "vol1", " ", "vol2"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"vol2", " ", "vol2"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7334858678508115`*^9, 3.7334858712831545`*^9}, 
   3.7334860971347375`*^9},
 CellLabel->"In[44]:=",ExpressionUUID->"d454b804-1c50-43f3-ba2f-3e6a2e4a4407"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"m1", "-", "x1"}], ")"}], "2"], 
     RowBox[{"2", " ", 
      SuperscriptBox["vol1", "2"]}]]}], "-", 
   FractionBox[
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"m2", "-", "x2"}], ")"}], "2"], 
    RowBox[{"2", " ", 
     SuperscriptBox["vol2", "2"]}]]}]]], "Output",
 CellChangeTimes->{3.733485872367263*^9, 3.7334860977557993`*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"171730ad-8224-47e6-91eb-019b7d034899"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"smallPhi", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"m1", ",", " ", "m2", ",", " ", "m3"}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vol1", " ", "vol1"}], ",", " ", 
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"rho13", " ", "vol1", " ", "vol3"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
        RowBox[{"vol2", " ", "vol2"}], ",", " ", 
        RowBox[{"rho23", " ", "vol2", " ", "vol3"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"rho13", " ", "vol1", " ", "vol3"}], ",", " ", 
        RowBox[{"rho23", " ", "vol2", " ", "vol3"}], ",", " ", 
        RowBox[{"vol3", " ", "vol3"}]}], "}"}]}], "}"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"x1", ",", " ", "x2", ",", " ", "x3"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7334858868837147`*^9, 3.7334859316551914`*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"fc2083dd-39d4-447d-b642-f66699cbe156"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       SuperscriptBox["m3", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["rho12", "2"]}], ")"}], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["m2", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["rho13", "2"]}], ")"}], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol3", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["m1", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["m1", "2"], " ", 
       SuperscriptBox["rho23", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"]}], "+", 
      RowBox[{"2", " ", "m1", " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", "x1"}], "-", 
      RowBox[{"2", " ", "m1", " ", 
       SuperscriptBox["rho23", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", "x1"}], "-", 
      RowBox[{
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x1", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["rho23", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x1", "2"]}], "-", 
      RowBox[{"2", " ", "m1", " ", "rho12", " ", "vol1", " ", "vol2", " ", 
       SuperscriptBox["vol3", "2"], " ", "x2"}], "+", 
      RowBox[{
      "2", " ", "m1", " ", "rho13", " ", "rho23", " ", "vol1", " ", "vol2", 
       " ", 
       SuperscriptBox["vol3", "2"], " ", "x2"}], "+", 
      RowBox[{"2", " ", "rho12", " ", "vol1", " ", "vol2", " ", 
       SuperscriptBox["vol3", "2"], " ", "x1", " ", "x2"}], "-", 
      RowBox[{"2", " ", "rho13", " ", "rho23", " ", "vol1", " ", "vol2", " ", 
       SuperscriptBox["vol3", "2"], " ", "x1", " ", "x2"}], "-", 
      RowBox[{
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x2", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["rho13", "2"], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol3", "2"], " ", 
       SuperscriptBox["x2", "2"]}], "-", 
      RowBox[{"2", " ", "m1", " ", "rho13", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x3"}], "+", 
      RowBox[{"2", " ", "m1", " ", "rho12", " ", "rho23", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x3"}], "+", 
      RowBox[{"2", " ", "rho13", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x1", " ", "x3"}], "-", 
      RowBox[{"2", " ", "rho12", " ", "rho23", " ", "vol1", " ", 
       SuperscriptBox["vol2", "2"], " ", "vol3", " ", "x1", " ", "x3"}], "-", 
      RowBox[{"2", " ", "rho12", " ", "rho13", " ", 
       SuperscriptBox["vol1", "2"], " ", "vol2", " ", "vol3", " ", "x2", " ", 
       "x3"}], "+", 
      RowBox[{"2", " ", "rho23", " ", 
       SuperscriptBox["vol1", "2"], " ", "vol2", " ", "vol3", " ", "x2", " ", 
       "x3"}], "-", 
      RowBox[{
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["x3", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["rho12", "2"], " ", 
       SuperscriptBox["vol1", "2"], " ", 
       SuperscriptBox["vol2", "2"], " ", 
       SuperscriptBox["x3", "2"]}], "-", 
      RowBox[{"2", " ", "m3", " ", "vol1", " ", "vol2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"rho12", " ", "rho13"}], "-", "rho23"}], ")"}], " ", 
          "vol1", " ", "vol3"}], "+", 
         RowBox[{"m1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "rho13"}], "+", 
            RowBox[{"rho12", " ", "rho23"}]}], ")"}], " ", "vol2", " ", 
          "vol3"}], "+", 
         RowBox[{"rho13", " ", "vol2", " ", "vol3", " ", "x1"}], "-", 
         RowBox[{"rho12", " ", "rho23", " ", "vol2", " ", "vol3", " ", "x1"}],
          "-", 
         RowBox[{"rho12", " ", "rho13", " ", "vol1", " ", "vol3", " ", "x2"}],
          "+", 
         RowBox[{"rho23", " ", "vol1", " ", "vol3", " ", "x2"}], "-", 
         RowBox[{"vol1", " ", "vol2", " ", "x3"}], "+", 
         RowBox[{
          SuperscriptBox["rho12", "2"], " ", "vol1", " ", "vol2", " ", 
          "x3"}]}], ")"}]}], "+", 
      RowBox[{"2", " ", "m2", " ", "vol1", " ", "vol3", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"m1", " ", 
          RowBox[{"(", 
           RowBox[{"rho12", "-", 
            RowBox[{"rho13", " ", "rho23"}]}], ")"}], " ", "vol2", " ", 
          "vol3"}], "-", 
         RowBox[{"rho12", " ", "vol2", " ", "vol3", " ", "x1"}], "+", 
         RowBox[{"rho13", " ", "rho23", " ", "vol2", " ", "vol3", " ", "x1"}],
          "+", 
         RowBox[{"vol1", " ", "vol3", " ", "x2"}], "-", 
         RowBox[{
          SuperscriptBox["rho13", "2"], " ", "vol1", " ", "vol3", " ", "x2"}],
          "+", 
         RowBox[{"rho12", " ", "rho13", " ", "vol1", " ", "vol2", " ", "x3"}],
          "-", 
         RowBox[{"rho23", " ", "vol1", " ", "vol2", " ", "x3"}]}], ")"}]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["rho12", "2"], "+", 
        SuperscriptBox["rho13", "2"], "-", 
        RowBox[{"2", " ", "rho12", " ", "rho13", " ", "rho23"}], "+", 
        SuperscriptBox["rho23", "2"]}], ")"}], " ", 
      SuperscriptBox["vol1", "2"], " ", 
      SuperscriptBox["vol2", "2"], " ", 
      SuperscriptBox["vol3", "2"]}]]}]], "/", 
  RowBox[{"(", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["rho12", "2"], "-", 
     SuperscriptBox["rho13", "2"], "+", 
     RowBox[{"2", " ", "rho12", " ", "rho13", " ", "rho23"}], "-", 
     SuperscriptBox["rho23", "2"]}]], ")"}]}]], "Output",
 CellChangeTimes->{{3.733485932697295*^9, 3.733485937964822*^9}},
 CellLabel->"Out[40]=",ExpressionUUID->"f12112a5-07a7-4f68-b953-d59ce15891bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"smallPhi", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"m1", ",", " ", "m2", ",", " ", "m3"}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vol1", " ", "vol1"}], ",", " ", 
          RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
          RowBox[{"rho13", " ", "vol1", " ", "vol3"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rho12", " ", "vol1", " ", "vol2"}], ",", " ", 
          RowBox[{"vol2", " ", "vol2"}], ",", " ", 
          RowBox[{"rho23", " ", "vol2", " ", "vol3"}]}], "}"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"rho13", " ", "vol1", " ", "vol3"}], ",", " ", 
          RowBox[{"rho23", " ", "vol2", " ", "vol3"}], ",", " ", 
          RowBox[{"vol3", " ", "vol3"}]}], "}"}]}], "}"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{"x1", ",", " ", "x2", ",", " ", "x3"}], "}"}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{"rho13", "\[Rule]", "0"}], "}"}]}], ")"}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.733485944207446*^9, 3.733485960471072*^9}, {
  3.733486005290554*^9, 3.733486006112636*^9}, {3.7334860711911435`*^9, 
  3.733486083591383*^9}, {3.7334861188389077`*^9, 3.733486133855409*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"b2c201ad-199e-48f1-8877-7d105bd12927"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.7334860967536993`*^9, 3.7334861254895725`*^9}, 
   3.733486920097342*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"3f00270d-0741-4ca7-b9ad-9a08c52526fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["t", "2"], "+", 
      RowBox[{"\[Pi]", " ", "x"}]}], ")"}], "3"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", 
     RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7334870654122734`*^9, 3.7334870713247113`*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"167e1ad0-1a10-4ceb-b8a5-e821fc8d2857"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   SuperscriptBox["\[Pi]", "2"], " ", 
   SuperscriptBox["t", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["t", "6"]}]}]], "Output",
 CellChangeTimes->{3.733487071745914*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"59178369-5ae0-4424-8c82-9a2c0a85c4d2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["t", "2"], "+", 
      RowBox[{"\[Pi]", " ", "x"}]}], ")"}], "3"], ",", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", " ", 
     RowBox[{"-", "1"}], ",", " ", 
     RowBox[{"fd", "[", 
      RowBox[{"1", ",", " ", 
       RowBox[{"<|", 
        RowBox[{"\"\<ub\>\"", "\[Rule]", "1"}], "|>"}]}], "]"}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7334869227649593`*^9, 3.733486991764201*^9}, {
  3.7334870227928004`*^9, 3.733487048486165*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"cb0b97d7-150a-4ec7-8d5d-00c032fa5793"],

Cell[BoxData[
 RowBox[{"fd", "[", 
  RowBox[{
   RowBox[{"2", " ", 
    SuperscriptBox["t", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[Pi]", "2"], "+", 
      SuperscriptBox["t", "4"]}], ")"}]}], ",", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{"\<\"ub\"\>", "\[Rule]", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"\[Pi]", "+", 
        SuperscriptBox["t", "2"]}], ")"}], "3"]}], "\[RightAssociation]"}]}], 
  "]"}]], "Output",
 CellChangeTimes->{{3.733486961016404*^9, 3.7334869939482155`*^9}, {
  3.7334870262716227`*^9, 3.73348704926617*^9}},
 CellLabel->"Out[52]=",ExpressionUUID->"a2a9d0ca-38fb-419c-b62c-b39fb745a9ff"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1328, 894},
WindowMargins->{{Automatic, 137}, {Automatic, 3}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 195, 3, 28, "Input",ExpressionUUID->"db3d923a-a50b-4ca2-ac5d-4031c2b69046"],
Cell[778, 27, 241, 3, 32, "Output",ExpressionUUID->"08e1268d-ba25-4158-b6a2-88e7f6cdb9bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1056, 35, 161, 3, 67, "Chapter",ExpressionUUID->"3d07e8c0-4533-4f2a-b3f8-d00ad46d4f0d"],
Cell[1220, 40, 306, 6, 44, "Input",ExpressionUUID->"feed91c2-bb35-47cf-9557-9ac97291f62a",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[1563, 51, 181, 3, 67, "Chapter",ExpressionUUID->"dc5cddf8-0489-4ffb-a343-e58ffc557c7f"],
Cell[1747, 56, 481, 14, 28, "Input",ExpressionUUID->"035b278f-cac0-4f64-9adb-5f077b41632c"],
Cell[CellGroupData[{
Cell[2253, 74, 195, 4, 28, "Input",ExpressionUUID->"a86535ee-167b-4928-92c5-f793adbbbda3"],
Cell[2451, 80, 745, 21, 65, "Output",ExpressionUUID->"af2805fe-f00e-4986-aa0d-f8ef5698d98e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3233, 106, 1285, 37, 67, "Input",ExpressionUUID->"b3a9e571-fb93-4361-a83d-86dc50badeb7"],
Cell[4521, 145, 643, 12, 21, "Message",ExpressionUUID->"ba8c336f-05cd-4841-a318-eb66e3b945a9"],
Cell[5167, 159, 217, 4, 32, "Output",ExpressionUUID->"0b2c98cc-21b6-4494-9955-41d0eefeae93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5421, 168, 519, 15, 28, "Input",ExpressionUUID->"bb001e94-8c85-486e-a94c-21616658f875"],
Cell[5943, 185, 186, 3, 32, "Output",ExpressionUUID->"12097ef3-bf6a-4bdf-8b33-6e830097a85f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6166, 193, 1831, 48, 105, "Input",ExpressionUUID->"1a3a2e0d-3560-4f6b-8af8-3461d9672c19"],
Cell[8000, 243, 621, 14, 32, "Output",ExpressionUUID->"bd28a4ac-6833-4f9a-b403-9f606c7181df"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[8670, 263, 150, 3, 56, "Chapter",ExpressionUUID->"e1f4bb0d-9fd1-4add-9558-20da117ce88b"],
Cell[8823, 268, 1228, 34, 105, "Input",ExpressionUUID->"d0647dcf-d0dd-4214-a9d2-d884a60d2829"],
Cell[CellGroupData[{
Cell[10076, 306, 2033, 50, 94, "Input",ExpressionUUID->"be74b322-555d-4be9-886d-8ce7c7e309aa"],
Cell[12112, 358, 485, 10, 21, "Message",ExpressionUUID->"e3add398-73fe-4186-8d66-1edee70cbc61"],
Cell[12600, 370, 485, 10, 21, "Message",ExpressionUUID->"66b5d534-9ffd-47d1-8060-f48c1758360a"],
Cell[13088, 382, 485, 10, 21, "Message",ExpressionUUID->"def54c7c-da30-46d4-b491-3610aacf6403"],
Cell[13576, 394, 599, 12, 21, "Message",ExpressionUUID->"45d00e4a-3db4-4f3a-b196-6b87ea042bb4"],
Cell[14178, 408, 479, 9, 21, "Message",ExpressionUUID->"65a07df2-8d69-4580-aa3a-e1ea4a00f178"],
Cell[14660, 419, 484, 10, 21, "Message",ExpressionUUID->"df29cba4-9d07-4485-b23a-2acdc34f0329"],
Cell[15147, 431, 253, 4, 32, "Output",ExpressionUUID->"48313630-b35d-462e-9509-a2abef0f21f2"]
}, Open  ]],
Cell[15415, 438, 1459, 43, 200, "Input",ExpressionUUID->"07d694bc-5d9f-4aad-bf2c-6ce7533d7c3c"],
Cell[CellGroupData[{
Cell[16899, 485, 692, 15, 28, "Input",ExpressionUUID->"b46c9c00-8117-4a72-99c8-d2441b9ae728"],
Cell[17594, 502, 191, 2, 32, "Output",ExpressionUUID->"ccdfa18b-f016-4c59-b35c-89cd3cc18e54"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17822, 509, 664, 15, 28, "Input",ExpressionUUID->"527ceba6-8d7a-49cf-80ad-6cef78b24729"],
Cell[18489, 526, 193, 2, 32, "Output",ExpressionUUID->"4ad081b0-60b4-4e79-9fc3-03ebb1dc8541"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18719, 533, 853, 19, 48, "Input",ExpressionUUID->"f612a595-4ee6-41b7-a9d6-aef1ef605207"],
Cell[19575, 554, 4698, 71, 89, "Message",ExpressionUUID->"79fc0761-e57f-4cae-8735-23a431a241d7"],
Cell[24276, 627, 4884, 73, 88, "Message",ExpressionUUID->"309d0a76-a5da-425c-8a9c-a55532461f7e"],
Cell[29163, 702, 6885, 101, 116, "Message",ExpressionUUID->"677cd45c-3278-4561-a9a2-edf787bb7f5b"],
Cell[36051, 805, 523, 12, 21, "Message",ExpressionUUID->"30993af4-870a-4460-9389-010348675ab0"],
Cell[36577, 819, 235, 4, 32, "Output",ExpressionUUID->"052b61d9-0115-4d44-b291-22273a84792c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36849, 828, 212, 3, 28, "Input",ExpressionUUID->"1d1c5812-3f89-46f9-a55a-e313cd43fc47"],
Cell[37064, 833, 214, 4, 32, "Output",ExpressionUUID->"9e78b6ca-9f79-4e7e-a95c-edf842a47d3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37315, 842, 212, 3, 28, "Input",ExpressionUUID->"3c788f70-e7aa-4073-a499-2d417fe49afd"],
Cell[37530, 847, 216, 4, 32, "Output",ExpressionUUID->"925ceb1d-55c8-4664-9952-0be6f8b5e403"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[37795, 857, 257, 4, 56, "Chapter",ExpressionUUID->"75b4616d-cb2d-4656-87bd-17ed2a8e38bc"],
Cell[CellGroupData[{
Cell[38077, 865, 957, 33, 55, "Input",ExpressionUUID->"516df623-c1b4-4d39-8e19-f21438f0427c"],
Cell[39037, 900, 1245, 41, 149, "Output",ExpressionUUID->"0acf2943-b76c-48b1-ad84-041d41afed55"]
}, Open  ]],
Cell[40297, 944, 878, 21, 28, "Input",ExpressionUUID->"370b5de4-7fd2-4358-acdf-2b8061d3869b"],
Cell[CellGroupData[{
Cell[41200, 969, 157, 3, 28, "Input",ExpressionUUID->"267e35c6-d1f1-4dc3-9af0-3edefaa40ee3"],
Cell[41360, 974, 68236, 1714, 3455, "Output",ExpressionUUID->"792cab9b-1c85-43bc-a00c-8d99192d75f2"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[109645, 2694, 197, 4, 56, "Chapter",ExpressionUUID->"26de32d0-bcfd-4552-ad87-d75be2af4510"],
Cell[109845, 2700, 997, 34, 55, "Input",ExpressionUUID->"b93c0c4b-96a2-4cad-bf8b-d6baa1268a11"],
Cell[CellGroupData[{
Cell[110867, 2738, 252, 6, 28, "Input",ExpressionUUID->"d1c06d8d-dc10-4d20-81cb-be657eb033be"],
Cell[111122, 2746, 568, 18, 59, "Output",ExpressionUUID->"3fe70b11-e2cc-4cea-8f44-9d8ce6febe87"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111727, 2769, 611, 14, 28, "Input",ExpressionUUID->"f0925c1d-18de-419f-aecb-29270505abb0"],
Cell[112341, 2785, 193, 2, 32, "Output",ExpressionUUID->"548681a1-ed54-42d6-813b-fdecd356d865"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112571, 2792, 1970, 60, 104, "Input",ExpressionUUID->"315f94aa-d991-4f93-ae79-d4ac1761d557"],
Cell[114544, 2854, 212, 4, 32, "Output",ExpressionUUID->"1dc82ed8-e878-41a7-b541-a4873f397e2e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114793, 2863, 3573, 107, 197, "Input",ExpressionUUID->"0a0ec0da-77d3-45f2-a9dd-729c22bcb592"],
Cell[118369, 2972, 3409, 104, 203, "Output",ExpressionUUID->"666de570-4dcc-4501-9e59-0384f74a22b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121815, 3081, 556, 15, 28, "Input",ExpressionUUID->"a5cb283f-d249-474f-94a7-60bf5e8570bd"],
Cell[122374, 3098, 646, 12, 21, "Message",ExpressionUUID->"1f40051c-695e-4200-a3e9-607e22c8c6bb"],
Cell[123023, 3112, 414, 12, 32, "Output",ExpressionUUID->"48350ea4-fbc0-4b46-8cc4-d20bf94df952"]
}, Open  ]],
Cell[123452, 3127, 733, 18, 28, "Input",ExpressionUUID->"90a0b17f-f6d5-4ba1-8d91-577b158db02f"],
Cell[CellGroupData[{
Cell[124210, 3149, 369, 9, 28, "Input",ExpressionUUID->"fc92d22e-904a-48eb-a256-6097df77540a"],
Cell[124582, 3160, 243, 3, 32, "Output",ExpressionUUID->"7cf48ea1-8dec-42a4-b1c7-5e8f8d99bca2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[124862, 3168, 500, 14, 28, "Input",ExpressionUUID->"cc736091-7bd2-45b6-b2e6-ce6319cc7b2f"],
Cell[125365, 3184, 366, 7, 32, "Output",ExpressionUUID->"4631502b-c68f-4b87-831f-ea0a96396c0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125768, 3196, 650, 19, 28, "Input",ExpressionUUID->"3341e86e-58c6-410b-961e-3c19c30d7266"],
Cell[126421, 3217, 430, 9, 32, "Output",ExpressionUUID->"618fb676-84d6-421d-8fe0-d2c5120c9dcc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126888, 3231, 743, 20, 28, "Input",ExpressionUUID->"81f14485-0fdb-4534-a522-31e96fd46f6b"],
Cell[127634, 3253, 170, 2, 32, "Output",ExpressionUUID->"464e8ef5-c18e-4b8a-a591-9a1d304bbe57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[127841, 3260, 1016, 29, 28, "Input",ExpressionUUID->"cb2fe641-0ed5-4e03-bc6b-fb334c6b568a"],
Cell[128860, 3291, 1037, 29, 32, "Output",ExpressionUUID->"97c35a00-6bf4-4ad3-bfdb-0f310c082620"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129934, 3325, 429, 10, 28, "Input",ExpressionUUID->"843df714-47ca-47f3-acd6-1de5ad2bfbd3"],
Cell[130366, 3337, 250, 4, 32, "Output",ExpressionUUID->"4b2db56f-d6fc-4016-b877-9ec9e37572c9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130653, 3346, 849, 25, 28, "Input",ExpressionUUID->"58cb1883-86d6-4796-b721-1ecf5f0ac5e6"],
Cell[131505, 3373, 566, 12, 32, "Output",ExpressionUUID->"1d7493bd-f5c8-4a61-82aa-08ddacf0aa1b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132108, 3390, 748, 20, 28, "Input",ExpressionUUID->"6df89177-9545-4bea-b477-c55b3b6c233d"],
Cell[132859, 3412, 220, 3, 32, "Output",ExpressionUUID->"a3f45e65-84d4-4fb8-b04f-ae4bfd7af2ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133116, 3420, 2654, 75, 75, "Input",ExpressionUUID->"7fb5d600-557e-4871-9b94-ac1c805b6d3c"],
Cell[135773, 3497, 958, 18, 32, "Output",ExpressionUUID->"0a7e3a34-292a-4185-a1b1-89179e98f727"]
}, Open  ]],
Cell[CellGroupData[{
Cell[136768, 3520, 522, 11, 28, "Input",ExpressionUUID->"e1f5569b-5313-4999-9bd7-02f43863c77f"],
Cell[137293, 3533, 449, 6, 32, "Output",ExpressionUUID->"14cf20d0-ae04-4eea-96a8-71c81969c57d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137779, 3544, 784, 22, 28, "Input",ExpressionUUID->"ccd78427-fbd1-4aa8-acf2-5e89b5f635bb"],
Cell[138566, 3568, 196, 2, 32, "Output",ExpressionUUID->"7c30a7fc-cd77-48d7-ba8e-7839782be436"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138799, 3575, 510, 14, 28, "Input",ExpressionUUID->"d6baadc3-8503-42ce-8a90-f3f7854e63d6"],
Cell[139312, 3591, 1481, 26, 36, "Message",ExpressionUUID->"466dc360-0f1a-4995-a182-09262e07f54a"],
Cell[140796, 3619, 1483, 26, 36, "Message",ExpressionUUID->"e6509476-acc6-4a92-bfcd-20fae17e8792"],
Cell[142282, 3647, 1483, 26, 36, "Message",ExpressionUUID->"b7ca2181-2f26-44c5-a17e-c2f5eab41286"],
Cell[143768, 3675, 450, 10, 21, "Message",ExpressionUUID->"6cc015af-3e9c-48ab-8bb9-946d650a89be"],
Cell[144221, 3687, 1149, 32, 45, "Output",ExpressionUUID->"10136733-d257-4d08-817e-f01be0889219"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145407, 3724, 634, 16, 28, "Input",ExpressionUUID->"0b7e0e37-3741-47fb-9eb6-3bb5e8d9e4eb"],
Cell[146044, 3742, 3039, 87, 64, "Output",ExpressionUUID->"f1aedf49-73bb-4eb1-8b7b-5cc4ff5149c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149120, 3834, 772, 21, 28, "Input",ExpressionUUID->"b97a893c-ba69-4668-9aa4-5aa18c5fb6df"],
Cell[149895, 3857, 1516, 43, 86, "Output",ExpressionUUID->"630ce4f0-9a7e-4c52-975e-7ea3df9b74c7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[151448, 3905, 768, 21, 28, "Input",ExpressionUUID->"d454b804-1c50-43f3-ba2f-3e6a2e4a4407"],
Cell[152219, 3928, 574, 17, 49, "Output",ExpressionUUID->"171730ad-8224-47e6-91eb-019b7d034899"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152830, 3950, 1131, 27, 48, "Input",ExpressionUUID->"fc2083dd-39d4-447d-b642-f66699cbe156"],
Cell[153964, 3979, 6313, 150, 98, "Output",ExpressionUUID->"f12112a5-07a7-4f68-b953-d59ce15891bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160314, 4134, 1434, 33, 48, "Input",ExpressionUUID->"b2c201ad-199e-48f1-8877-7d105bd12927"],
Cell[161751, 4169, 210, 3, 32, "Output",ExpressionUUID->"3f00270d-0741-4ca7-b9ad-9a08c52526fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161998, 4177, 464, 12, 33, "Input",ExpressionUUID->"167e1ad0-1a10-4ceb-b8a5-e821fc8d2857"],
Cell[162465, 4191, 306, 8, 32, "Output",ExpressionUUID->"59178369-5ae0-4424-8c82-9a2c0a85c4d2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162808, 4204, 654, 18, 33, "Input",ExpressionUUID->"cb0b97d7-150a-4ec7-8d5d-00c032fa5793"],
Cell[163465, 4224, 665, 18, 37, "Output",ExpressionUUID->"a2a9d0ca-38fb-419c-b62c-b39fb745a9ff"]
}, Open  ]]
}, Open  ]]
}
]
*)

